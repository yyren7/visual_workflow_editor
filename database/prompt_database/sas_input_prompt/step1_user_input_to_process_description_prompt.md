# 机器人流程生成 Prompt - 阶段一：用户输入到详细流程描述

## 目标

本 Prompt 旨在指导您根据用户提供的机器人任务描述（通常为自然语言 Markdown 格式），生成一份详细的流程方案。该方案应包含一个主流程和多个子流程的清晰描述，以及它们各自的流程步骤和核心逻辑的文字说明。目标是产出一份结构化的、易于理解的机器人任务执行蓝图，作为用户审查和后续细化步骤的基础。

## 输入材料

1.  **机器人任务描述 (.md 或文本)**：包含对机器人期望完成的整体任务、子任务以及操作对象的自然语言描述。

## 生成指引与要求

请根据提供的任务描述，遵循以下指引生成详细的流程描述：

### 1. 子程序/函数设计与定义 (逻辑层面)

- **识别核心功能模块**：从任务描述中提取关键操作和逻辑单元，构思子程序的候选。
- **设计子程序名称与缩写**：特别关注子程序名称中的缩写（例如 `BRG`, `PLT`, `CNV`, `RMC`, `LMC`, `BH`, `Crump`），确保其简洁且能反映功能。子程序名称应清晰表达其目的。
- **明确子程序功能**：详细描述每个子程序应执行的具体任务、操作对象以及预期的结果。例如：获取、放置、轴承、托盘、传送带、加工单元、夹具操作等。
- **明确动作类型**：在子程序描述中清晰区分 `Get` (获取/拾取) 和 `Put` (放置/放下) 等常见动作。
- **设计成对操作**：注意设计逻辑上成对出现的子程序，如 `Open_..._Clamp` 和 `Close_..._Clamp`，并阐明其功能。

### 2. 子程序模块化与复用策略规划 (逻辑层面)

- **规划标准操作序列的复用**：识别并描述可在多个子程序中复用的标准操作序列的逻辑。例如：
  - 物料抓取/放置流程：描述"接近目标 -> 精确定位 -> 执行动作（如夹取/释放）-> 离开目标 -> 返回安全位置"的通用逻辑。
  - 夹具操作的封装：描述夹具控制逻辑如何被封装并在不同物料操作中调用。
- **模块化设计**：规划夹具控制、运动控制等是否应被描述为独立的、可复用的逻辑模块。
- **参数化与配置考虑**：在描述中提及是否需要通过变量或参数（如速度、力度）来调整子程序行为，以增加灵活性。
- **嵌套调用关系**：规划并描述子程序之间的逻辑调用关系，以合理分解和组合任务。
- **对称/对应操作**：设计功能上相互补充或对应的子程序对的逻辑。

### 3. 主程序核心逻辑构建 (逻辑层面)

- **规划主程序的初始化步骤**：描述主程序开始时通常执行的初始化逻辑（例如：选择机器人型号、启动电机、初始化关键变量等）。
- **设计主程序的控制流**：描述主程序的宏观控制流程，如是否存在主循环、条件判断等。
- **编排主程序调用子程序的顺序**：规划并描述主程序是如何通过顺序调用子程序来完成整体任务的，清晰说明各子程序调用的时机和目的。
- **考虑状态转换与同步逻辑**：描述程序如何通过等待特定条件（如传感器信号、外部 IO）或发出信号与外部环境或其他设备进行同步和交互的逻辑。
- **考虑安全与过渡逻辑**：注意描述机器人在不同任务阶段之间是否需要移动到特定的安全点或过渡点。
- **考虑错误处理与可选路径逻辑**：思考并描述是否需要备用路径或错误处理机制。对于暂时不启用但未来可能需要的功能，可以描述其逻辑并标记为可选。
- **定义结束与返回逻辑**：明确主程序及各子程序结束的方式和条件。

总结来说，您需要将用户的自然语言任务描述，转化为一份详细的、结构化的文案，清晰定义主流程和各子程序的职责、核心步骤逻辑、以及它们之间的协作关系。这份描述将作为可视化方案，供用户确认和修改。

## 示例 fewshot

### 示例任务输入 (原始用户描述)

[机器人任务描述：该自动化流程旨在协同完成一个涉及轴承（BRG）、轴承座（BH）和托盘（PLT）的装配与搬运任务。机器人首先从物料架或初始位置获取一个轴承和一个轴承座。随后，将这两个部件依次放置到右侧加工中心（RMC），推测在此处进行压装或组装操作。完成组装后，机器人从 RMC 取走已组装好的部件，并将其转移到左侧加工中心（LMC）进行暂存或后续处理。接着，机器人会去获取一个空托盘，并将此托盘放置到传送带（CNV）的指定工位。最后，机器人从 LMC 取回之前暂存的已组装部件，并将其精确地放置到传送带上的托盘中，完成整个循环作业。]

### 示例输出 (详细流程描述方案)

#### 一、子程序及其功能描述

1.  **`BRG_Get_BRG` (获取轴承)**:

    - 功能：机器人从指定位置（如物料架）获取一个轴承。
    - 核心逻辑：移动到轴承预备点 -> 移动到轴承上方 -> 打开轴承夹具 -> 下降到轴承精确抓取点 -> 关闭轴承夹具 -> 抬升 -> 移动到离开点 -> 返回安全/初始点。
    - 涉及夹具：`BRG&PLT_Crump` (操作轴承和托盘的夹具)。

2.  **`CNV_Get_BH` (从传送带获取轴承座)**:

    - 功能：机器人从传送带的指定位置获取一个轴承座。
    - 核心逻辑：移动到传送带旁轴承座预备点 -> 移动到轴承座上方 -> 打开轴承座夹具 -> 下降到轴承座精确抓取点 -> 关闭轴承座夹具 -> 抬升 -> 返回安全/初始点。
    - 涉及夹具：`BH_Crump` (操作轴承座的夹具)。

3.  **`RMC_Put_BH&BRG` (将轴承座和轴承放置到右侧加工中心)**:

    - 功能：机器人将先前获取的轴承座和轴承依次放置到右侧加工中心（RMC）的指定工位。
    - 核心逻辑：
      - 移动到 RMC 预备点。
      - 放置轴承座：移动到 RMC 轴承座放置点上方 -> 精确移动到放置点 -> 打开轴承座夹具 -> 抬升。
      - 放置轴承：移动到 RMC 轴承放置点上方 -> 精确移动到放置点 -> 打开轴承夹具 -> 抬升。
      - 移动到 RMC 离开点。
    - 涉及夹具：`BH_Crump`, `BRG&PLT_Crump`。
    - 注意：放置时可能需要降低速度以确保精度。

4.  **`RMC_Get_BH` (从右侧加工中心获取已组装部件)**:

    - 功能：机器人从右侧加工中心（RMC）获取已组装（或处理完毕）的轴承座（此时可能已与轴承组装）。
    - 核心逻辑：移动到 RMC 预备点 -> 移动到已组装部件上方 -> 打开轴承座夹具（若之前是打开的，则此步为准备抓取） -> 下降到精确抓取点 -> 关闭轴承座夹具 -> 抬升 -> 移动到离开点。
    - 涉及夹具：`BH_Crump`。

5.  **`LMC_Put_BH` (将部件放置到左侧加工中心)**:

    - 功能：机器人将从 RMC 取回的部件放置到左侧加工中心（LMC）进行暂存或后续处理。
    - 核心逻辑：移动到 LMC 预备点 -> 移动到 LMC 放置点上方 -> 精确移动到放置点 -> 打开轴承座夹具 -> 抬升 -> 返回安全/初始点。
    - 涉及夹具：`BH_Crump`。

6.  **`CNV_Get_PLT` (从传送带获取托盘)**:

    - 功能：机器人从指定位置（可能是传送带的另一区域）获取一个空托盘。
    - 核心逻辑：移动到托盘预备点 -> 移动到托盘上方 -> （可能需要低速）精确移动到抓取点 -> 关闭托盘夹具 -> 抬升 -> 返回安全/初始点。
    - 涉及夹具：`BRG&PLT_Crump`。

7.  **`CNV_Put_PLT` (将托盘放置到传送带)**:

    - 功能：机器人将获取到的空托盘放置到传送带的指定工位。
    - 核心逻辑：移动到传送带托盘放置点上方 -> 精确移动到放置点 -> 打开托盘夹具 -> 抬升 -> 返回安全/初始点。
    - 涉及夹具：`BRG&PLT_Crump`。

8.  **`LMC_Get_BH` (从左侧加工中心获取部件)**:

    - 功能：机器人从左侧加工中心（LMC）取回之前暂存的部件。
    - 核心逻辑：移动到 LMC 预备点 -> 移动到部件上方 -> 精确移动到抓取点 -> 关闭轴承座夹具 -> 抬升 -> 返回安全/初始点。
    - 涉及夹具：`BH_Crump`。

9.  **`CNV_Put_BH` (将部件放置到传送带的托盘上)**:

    - 功能：机器人将从 LMC 取回的部件精确放置到传送带上预先放置好的托盘中。
    - 核心逻辑：移动到传送带托盘上方（已装载部件） -> 精确移动到托盘内指定放置点 -> 打开轴承座夹具 -> 抬升 -> 返回安全/初始点。
    - 涉及夹具：`BH_Crump`。

10. **`Open_BH_Crump` (打开轴承座夹具)**:

    - 功能：控制机器人末端执行器打开用于夹持轴承座的夹具。
    - 核心逻辑：发送打开信号，等待夹具到位反馈。

11. **`Close_BH_Crump` (关闭轴承座夹具)**:

    - 功能：控制机器人末端执行器关闭用于夹持轴承座的夹具。
    - 核心逻辑：发送关闭信号，等待夹具到位反馈。

12. **`Open_BRG&PLT_Crump` (打开轴承/托盘夹具)**:

    - 功能：控制机器人末端执行器打开用于夹持轴承或托盘的夹具。
    - 核心逻辑：发送打开信号，等待夹具到位反馈。

13. **`Close_BRG&PLT_Crump` (关闭轴承/托盘夹具)**:
    - 功能：控制机器人末端执行器关闭用于夹持轴承或托盘的夹具。
    - 核心逻辑：发送关闭信号，等待夹具到位反馈。

#### 二、主程序流程描述

选择机器人型号 (例如 "dobot*mg400")。
启动机器人电机。
初始化必要的流程控制变量 (例如 `N5 = 2`，用于示例中的条件判断)。
主循环开始
循环条件：可能基于特定条件或无限循环 (本例中基于 `N5 == 2` 执行一次核心流程)。
机器人移动到**初始/安全点位 (例如 "P1")**。
*(可选/禁用逻辑)_ 等待外部启动信号 (例如外部 IO 输入)。
调用子程序 `BRG_Get_BRG` (获取轴承)。
_(可选/禁用逻辑)_ 等待物料到位或工位清空信号。
调用子程序 `CNV_Get_BH` (从传送带获取轴承座)。
机器人移动到**初始/安全点位 (例如 "P1")**。
等待加工中心（RMC）准备就绪的信号。
调用子程序 `RMC_Put_BH&BRG` (将轴承座和轴承放置到 RMC)。
等待 RMC 加工完成信号。
发出信号通知 RMC 部件已取走或准备取走。
等待 RMC 确认信号。
调用子程序 `RMC_Get_BH` (从 RMC 获取已组装部件)。
机器人移动到**初始/安全点位 (例如 "P1")**。
调用子程序 `LMC_Put_BH` (将部件放置到 LMC)。
机器人移动到**初始/安全点位 (例如 "P1")**。
调用子程序 `CNV_Get_PLT` (从传送带获取托盘)。
调用子程序 `CNV_Put_PLT` (将托盘放置到传送带)。
机器人移动到**初始/安全点位 (例如 "P1")**。
调用子程序 `LMC_Get_BH` (从 LMC 获取部件)。
机器人移动到**初始/安全点位 (例如 "P1")**。
调用子程序 `CNV_Put_BH` (将部件放置到传送带的托盘上)。
_(可选/禁用逻辑)\_ 发送任务完成信号给外部系统。
主循环结束

#### 三、模块化与复用说明

- **夹具操作**：`Open/Close_BH_Crump` 和 `Open/Close_BRG&PLT_Crump` 为标准夹具控制子程序，会在各个物料拾取和放置子程序中被调用。
- **移动序列**：大部分拾取/放置子程序遵循"预备点 -> 接近点 -> 精确点 -> (执行动作) -> 抬升点 -> 离开点 -> 安全点"的移动逻辑。
- **速度控制**：在 `RMC_Put_BH&BRG`, `CNV_Get_PLT` 等精确操作中，应在描述中提及需规划低速移动阶段。
- **外部交互**：主流程中规划了多处与外部设备（RMC, LMC, 传送带传感器）的信号交互点，用于流程同步。部分不确定或调试期间可禁用的交互被标记为可选/禁用。
