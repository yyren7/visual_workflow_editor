2025-03-26 02:11:11,074 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:11:11,074 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:11:11,155 - backend.app.main - INFO - 导入database成功
2025-03-26 02:11:11,158 - backend.app.main - INFO - 导入models成功
2025-03-26 02:11:11,158 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:11:11,159 - backend.app.main - INFO - 导入config成功
2025-03-26 02:11:11,580 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:11:11,586 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:11:11,586 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:11:11,586 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:11:11,586 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:11:11,587 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:11:11,587 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:11:11,587 - backend.app.main - INFO - 注册路由...
2025-03-26 02:11:11,592 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:11:11,597 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:11:11,598 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:11:11,598 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:11:11,599 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:11:11,601 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:11:11,602 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:11:11,603 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:11:11,603 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:11:11,604 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:11:11,604 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:11:11,604 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:11:11,604 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:11:11,604 - backend.app.services.deepseek_client_service - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:11:11,604 - backend.app.services.deepseek_client_service - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:11:11,636 - backend.app.services.deepseek_client_service - INFO - DeepSeek客户端初始化成功
2025-03-26 02:11:11,636 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:11:11,636 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:11:11,636 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:11:11,636 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:11:11,636 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:11:21,995 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:11:21,995 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:11:22,074 - backend.app.main - INFO - 导入database成功
2025-03-26 02:11:22,076 - backend.app.main - INFO - 导入models成功
2025-03-26 02:11:22,077 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:11:22,077 - backend.app.main - INFO - 导入config成功
2025-03-26 02:11:22,486 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:11:22,492 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:11:22,493 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:11:22,493 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:11:22,493 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:11:22,493 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:11:22,493 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:11:22,494 - backend.app.main - INFO - 注册路由...
2025-03-26 02:11:22,498 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:11:22,502 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:11:22,503 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:11:22,503 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:11:22,504 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:11:22,506 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:11:22,506 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:11:22,508 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:11:22,508 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:11:22,509 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:11:22,509 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:11:22,509 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:11:22,509 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:11:22,509 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:11:22,509 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:11:22,540 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:11:22,540 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:11:22,540 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:11:22,540 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:11:22,540 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:11:22,540 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:11:32,989 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:11:32,989 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:11:33,071 - backend.app.main - INFO - 导入database成功
2025-03-26 02:11:33,074 - backend.app.main - INFO - 导入models成功
2025-03-26 02:11:33,075 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:11:33,075 - backend.app.main - INFO - 导入config成功
2025-03-26 02:11:33,490 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:11:33,497 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:11:33,497 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:11:33,497 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:11:33,497 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:11:33,498 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:11:33,498 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:11:33,498 - backend.app.main - INFO - 注册路由...
2025-03-26 02:11:33,503 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:11:33,506 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:11:33,507 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:11:33,508 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:11:33,509 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:11:33,511 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:11:33,511 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:11:33,512 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:11:33,512 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:11:33,514 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:11:33,514 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:11:33,514 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:11:33,514 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:11:33,514 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:11:33,514 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:11:33,545 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:11:33,545 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:11:33,545 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:11:33,545 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:11:33,545 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:11:33,545 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:12:07,703 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:12:07,704 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:12:07,782 - backend.app.main - INFO - 导入database成功
2025-03-26 02:12:07,785 - backend.app.main - INFO - 导入models成功
2025-03-26 02:12:07,786 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:12:07,786 - backend.app.main - INFO - 导入config成功
2025-03-26 02:12:08,193 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:12:08,198 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:12:08,198 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:12:08,198 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:12:08,198 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:12:08,199 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:12:08,199 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:12:08,199 - backend.app.main - INFO - 注册路由...
2025-03-26 02:12:08,204 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:12:08,207 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:12:08,208 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:12:08,209 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:12:08,210 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:12:08,212 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:12:08,212 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:12:08,213 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:12:08,214 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:12:08,215 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:12:08,215 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:12:08,215 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:12:08,215 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:12:08,215 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:12:08,215 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:12:08,246 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:12:08,246 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:12:08,246 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:12:08,246 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:12:08,246 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:12:08,246 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:12:31,210 - backend.app.services.prompt_embedding_service - INFO - 创建PromptEmbeddingService单例实例
2025-03-26 02:12:31,210 - backend.app.embeddings.service - INFO - 创建EmbeddingService单例实例
2025-03-26 02:12:31,210 - backend.app.embeddings.service - INFO - 初始化EmbeddingService，使用关键词匹配方法而非嵌入模型
2025-03-26 02:12:31,210 - backend.app.embeddings.service - INFO - 从节点模板服务加载节点定义
2025-03-26 02:12:31,211 - backend.app.embeddings.service - INFO - 成功从模板服务加载 6 个节点定义
2025-03-26 02:12:31,211 - backend.app.services.prompt_embedding_service - INFO - EmbeddingService单例实例已初始化并缓存
2025-03-26 02:12:31,222 - backend.workflow - INFO - 开始处理用户输入: 创建一个movel节点给我
2025-03-26 02:12:31,222 - backend.workflow - ERROR - 处理用户输入时出错: 'WorkflowPromptService' object has no attribute '_conversation_history'
2025-03-26 02:12:31,223 - backend.workflow - ERROR - 错误详情: Traceback (most recent call last):
  File "/workspace/backend/app/services/workflow_prompt_service.py", line 221, in process_user_input
    if self._conversation_history:
AttributeError: 'WorkflowPromptService' object has no attribute '_conversation_history'

2025-03-26 02:14:07,071 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:14:07,071 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:14:07,151 - backend.app.main - INFO - 导入database成功
2025-03-26 02:14:07,154 - backend.app.main - INFO - 导入models成功
2025-03-26 02:14:07,155 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:14:07,155 - backend.app.main - INFO - 导入config成功
2025-03-26 02:14:07,582 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:14:07,589 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:14:07,590 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:14:07,590 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:14:07,590 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:14:07,590 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:14:07,591 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:14:07,591 - backend.app.main - INFO - 注册路由...
2025-03-26 02:14:07,596 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:14:07,599 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:14:07,600 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:14:07,601 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:14:07,601 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:14:07,604 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:14:07,604 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:14:07,605 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:14:07,605 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:14:07,606 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:14:07,606 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:14:07,607 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:14:07,607 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:14:07,607 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:14:07,607 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:14:07,637 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:14:07,638 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:14:07,638 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:14:07,638 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:14:07,638 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:14:07,638 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:14:26,869 - backend.app.services.prompt_embedding_service - INFO - 创建PromptEmbeddingService单例实例
2025-03-26 02:14:26,869 - backend.app.embeddings.service - INFO - 创建EmbeddingService单例实例
2025-03-26 02:14:26,869 - backend.app.embeddings.service - INFO - 初始化EmbeddingService，使用关键词匹配方法而非嵌入模型
2025-03-26 02:14:26,869 - backend.app.embeddings.service - INFO - 从节点模板服务加载节点定义
2025-03-26 02:14:26,869 - backend.app.embeddings.service - INFO - 成功从模板服务加载 6 个节点定义
2025-03-26 02:14:26,869 - backend.app.services.prompt_embedding_service - INFO - EmbeddingService单例实例已初始化并缓存
2025-03-26 02:14:26,881 - backend.workflow - INFO - 开始处理用户输入: 创建一个movel节点给我
2025-03-26 02:14:26,881 - backend.workflow - ERROR - 处理用户输入时出错: PromptExpansionService.expand_prompt() takes 2 positional arguments but 3 were given
2025-03-26 02:14:26,881 - backend.workflow - ERROR - 错误详情: Traceback (most recent call last):
  File "/workspace/backend/app/services/workflow_prompt_service.py", line 231, in process_user_input
    expanded_input = await self.expansion_service.expand_prompt(user_input, context)
TypeError: PromptExpansionService.expand_prompt() takes 2 positional arguments but 3 were given

2025-03-26 02:14:35,124 - backend.workflow - INFO - 开始处理用户输入: 创建一个movel节点给我
2025-03-26 02:14:35,124 - backend.workflow - ERROR - 处理用户输入时出错: PromptExpansionService.expand_prompt() takes 2 positional arguments but 3 were given
2025-03-26 02:14:35,125 - backend.workflow - ERROR - 错误详情: Traceback (most recent call last):
  File "/workspace/backend/app/services/workflow_prompt_service.py", line 231, in process_user_input
    expanded_input = await self.expansion_service.expand_prompt(user_input, context)
TypeError: PromptExpansionService.expand_prompt() takes 2 positional arguments but 3 were given

2025-03-26 02:15:22,055 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:15:22,056 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:15:22,136 - backend.app.main - INFO - 导入database成功
2025-03-26 02:15:22,139 - backend.app.main - INFO - 导入models成功
2025-03-26 02:15:22,140 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:15:22,140 - backend.app.main - INFO - 导入config成功
2025-03-26 02:15:22,565 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:15:22,570 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:15:22,570 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:15:22,570 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:15:22,570 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:15:22,571 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:15:22,571 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:15:22,571 - backend.app.main - INFO - 注册路由...
2025-03-26 02:15:22,576 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:15:22,580 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:15:22,581 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:15:22,582 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:15:22,582 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:15:22,584 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:15:22,585 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:15:22,586 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:15:22,586 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:15:22,587 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:15:22,587 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:15:22,587 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:15:22,587 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:15:22,587 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:15:22,587 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:15:22,618 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:15:22,618 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:15:22,618 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:15:22,618 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:15:22,618 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:15:22,619 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:17:06,411 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:17:06,411 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:17:06,494 - backend.app.main - INFO - 导入database成功
2025-03-26 02:17:06,497 - backend.app.main - INFO - 导入models成功
2025-03-26 02:17:06,498 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:17:06,498 - backend.app.main - INFO - 导入config成功
2025-03-26 02:17:06,923 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:17:06,930 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:17:06,931 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:17:06,931 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:17:06,931 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:17:06,931 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:17:06,931 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:17:06,932 - backend.app.main - INFO - 注册路由...
2025-03-26 02:17:06,936 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:17:06,940 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:17:06,941 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:17:06,941 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:17:06,942 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:17:06,944 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:17:06,944 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:17:06,946 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:17:06,946 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:17:06,947 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:17:06,947 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:17:06,947 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:17:06,947 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:17:06,947 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:17:06,947 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:17:06,978 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:17:06,978 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:17:06,978 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:17:06,978 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:17:06,978 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:17:06,978 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:17:34,700 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:17:34,700 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:17:34,782 - backend.app.main - INFO - 导入database成功
2025-03-26 02:17:34,785 - backend.app.main - INFO - 导入models成功
2025-03-26 02:17:34,786 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:17:34,786 - backend.app.main - INFO - 导入config成功
2025-03-26 02:17:35,219 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:17:35,226 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:17:35,226 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:17:35,226 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:17:35,226 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:17:35,227 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:17:35,227 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:17:35,228 - backend.app.main - INFO - 注册路由...
2025-03-26 02:17:35,233 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:17:35,236 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:17:35,237 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:17:35,238 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:17:35,238 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:17:35,240 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:17:35,241 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:17:35,242 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:17:35,242 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:17:35,243 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:17:35,244 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:17:35,244 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:17:35,244 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:17:35,244 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:17:35,244 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:17:35,275 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:17:35,275 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:17:35,276 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:17:35,276 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:17:35,276 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:17:35,276 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:18:16,564 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:18:16,564 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:18:16,642 - backend.app.main - INFO - 导入database成功
2025-03-26 02:18:16,645 - backend.app.main - INFO - 导入models成功
2025-03-26 02:18:16,646 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:18:16,646 - backend.app.main - INFO - 导入config成功
2025-03-26 02:18:17,065 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:18:17,071 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:18:17,071 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:18:17,072 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:18:17,072 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:18:17,072 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:18:17,072 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:18:17,073 - backend.app.main - INFO - 注册路由...
2025-03-26 02:18:17,077 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:18:17,080 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:18:17,082 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:18:17,082 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:18:17,083 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:18:17,085 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:18:17,085 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:18:17,087 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:18:17,087 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:18:17,088 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:18:17,088 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:18:17,088 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:18:17,088 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:18:17,088 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:18:17,088 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:18:17,119 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:18:17,119 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:18:17,119 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:18:17,119 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:18:17,119 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:18:17,119 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:29:25,821 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:29:25,821 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:29:25,907 - backend.app.main - INFO - 导入database成功
2025-03-26 02:29:25,910 - backend.app.main - INFO - 导入models成功
2025-03-26 02:29:25,911 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:29:25,911 - backend.app.main - INFO - 导入config成功
2025-03-26 02:29:26,329 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:29:26,337 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:29:26,338 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:29:26,338 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:29:26,338 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:29:26,338 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:29:26,338 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:29:26,339 - backend.app.main - INFO - 注册路由...
2025-03-26 02:29:26,343 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:29:26,347 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:29:26,348 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:29:26,348 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:29:26,349 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:29:26,351 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:29:26,351 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:29:26,353 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:29:26,353 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:29:26,354 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:29:26,354 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:29:26,354 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:29:26,354 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:29:26,354 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:29:26,354 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:29:26,385 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:29:26,385 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:29:26,385 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:29:26,385 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:29:26,385 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:29:26,385 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:29:46,159 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:29:46,159 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:29:46,242 - backend.app.main - INFO - 导入database成功
2025-03-26 02:29:46,245 - backend.app.main - INFO - 导入models成功
2025-03-26 02:29:46,246 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:29:46,246 - backend.app.main - INFO - 导入config成功
2025-03-26 02:29:46,664 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:29:46,671 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:29:46,671 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:29:46,671 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:29:46,671 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:29:46,672 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:29:46,672 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:29:46,673 - backend.app.main - INFO - 注册路由...
2025-03-26 02:29:46,677 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:29:46,681 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:29:46,682 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:29:46,683 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:29:46,683 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:29:46,685 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:29:46,686 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:29:46,687 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:29:46,687 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:29:46,688 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:29:46,688 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:29:46,688 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:29:46,688 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:29:46,688 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:29:46,688 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:29:46,720 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:29:46,720 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:29:46,720 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:29:46,720 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:29:46,720 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:29:46,720 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:30:02,995 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:30:02,995 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:30:03,082 - backend.app.main - INFO - 导入database成功
2025-03-26 02:30:03,085 - backend.app.main - INFO - 导入models成功
2025-03-26 02:30:03,087 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:30:03,087 - backend.app.main - INFO - 导入config成功
2025-03-26 02:30:03,545 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:30:03,552 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:30:03,552 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:30:03,552 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:30:03,552 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:30:03,553 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:30:03,553 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:30:03,553 - backend.app.main - INFO - 注册路由...
2025-03-26 02:30:03,558 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:30:03,561 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:30:03,562 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:30:03,563 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:30:03,563 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:30:03,565 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:30:03,566 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:30:03,567 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:30:03,567 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:30:03,568 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:30:03,568 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:30:03,568 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:30:03,568 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:30:03,568 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:30:03,568 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:30:03,599 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:30:03,599 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:30:03,599 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:30:03,599 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:30:03,599 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:30:03,599 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:30:17,906 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:30:17,906 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:30:17,985 - backend.app.main - INFO - 导入database成功
2025-03-26 02:30:17,988 - backend.app.main - INFO - 导入models成功
2025-03-26 02:30:17,989 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:30:17,989 - backend.app.main - INFO - 导入config成功
2025-03-26 02:30:18,400 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:30:18,408 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:30:18,409 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:30:18,409 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:30:18,409 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:30:18,409 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:30:18,410 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:30:18,410 - backend.app.main - INFO - 注册路由...
2025-03-26 02:30:18,415 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:30:18,418 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:30:18,419 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:30:18,420 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:30:18,420 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:30:18,422 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:30:18,423 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:30:18,425 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:30:18,425 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:30:18,426 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:30:18,426 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:30:18,426 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:30:18,426 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:30:18,426 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:30:18,426 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:30:18,457 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:30:18,457 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:30:18,457 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:30:18,457 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:30:18,457 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:30:18,457 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:30:36,187 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:30:36,188 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:30:36,270 - backend.app.main - INFO - 导入database成功
2025-03-26 02:30:36,273 - backend.app.main - INFO - 导入models成功
2025-03-26 02:30:36,274 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:30:36,274 - backend.app.main - INFO - 导入config成功
2025-03-26 02:30:36,712 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:30:36,720 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:30:36,720 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:30:36,720 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:30:36,720 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:30:36,721 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:30:36,721 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:30:36,721 - backend.app.main - INFO - 注册路由...
2025-03-26 02:30:36,726 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:30:36,729 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:30:36,731 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:30:36,731 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:30:36,732 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:30:36,734 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:30:36,734 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:30:36,736 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:30:36,736 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:30:36,737 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:30:36,737 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:30:36,737 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:30:36,737 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:30:36,737 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:30:36,737 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:30:36,767 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:30:36,768 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:30:36,768 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:30:36,768 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:30:36,768 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:30:36,768 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:30:49,683 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:30:49,683 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:30:49,781 - backend.app.main - INFO - 导入database成功
2025-03-26 02:30:49,784 - backend.app.main - INFO - 导入models成功
2025-03-26 02:30:49,785 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:30:49,785 - backend.app.main - INFO - 导入config成功
2025-03-26 02:30:50,285 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:30:50,294 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:30:50,294 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:30:50,294 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:30:50,294 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:30:50,295 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:30:50,295 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:30:50,295 - backend.app.main - INFO - 注册路由...
2025-03-26 02:30:50,300 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:30:50,304 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:30:50,305 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:30:50,306 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:30:50,307 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:30:50,309 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:30:50,309 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:30:50,311 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:30:50,311 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:30:50,312 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:30:50,312 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:30:50,312 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:30:50,312 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:30:50,312 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:30:50,312 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:30:50,343 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:30:50,344 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:30:50,344 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:30:50,344 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:30:50,344 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:30:50,344 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:31:11,548 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:31:11,548 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:31:11,629 - backend.app.main - INFO - 导入database成功
2025-03-26 02:31:11,632 - backend.app.main - INFO - 导入models成功
2025-03-26 02:31:11,633 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:31:11,633 - backend.app.main - INFO - 导入config成功
2025-03-26 02:31:12,052 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:31:12,060 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:31:12,060 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:31:12,060 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:31:12,060 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:31:12,060 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:31:12,060 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:31:12,061 - backend.app.main - INFO - 注册路由...
2025-03-26 02:31:12,065 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:31:12,069 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:31:12,070 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:31:12,071 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:31:12,071 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:31:12,073 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:31:12,074 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:31:12,075 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:31:12,075 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:31:12,076 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:31:12,076 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:31:12,076 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:31:12,076 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:31:12,076 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:31:12,076 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:31:12,108 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:31:12,108 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:31:12,108 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:31:12,108 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:31:12,108 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:31:12,108 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:33:07,275 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:33:07,276 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:33:07,356 - backend.app.main - INFO - 导入database成功
2025-03-26 02:33:07,359 - backend.app.main - INFO - 导入models成功
2025-03-26 02:33:07,360 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:33:07,360 - backend.app.main - INFO - 导入config成功
2025-03-26 02:33:07,759 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:33:07,764 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:33:07,764 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:33:07,764 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:33:07,764 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:33:07,765 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:33:07,765 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:33:07,765 - backend.app.main - INFO - 注册路由...
2025-03-26 02:33:07,769 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:33:07,773 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:33:07,774 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:33:07,775 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:33:07,775 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:33:07,777 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:33:07,778 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:33:07,779 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:33:07,779 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:33:07,780 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:33:07,780 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:33:07,780 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:33:07,780 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:33:07,780 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:33:07,780 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:33:07,811 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:33:07,811 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:33:07,812 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:33:07,812 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:33:07,812 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:33:07,812 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:33:25,128 - backend.app.services.prompt_embedding_service - INFO - 创建PromptEmbeddingService单例实例
2025-03-26 02:33:25,128 - backend.app.embeddings.service - INFO - 创建EmbeddingService单例实例
2025-03-26 02:33:25,129 - backend.app.embeddings.service - INFO - 初始化EmbeddingService，使用关键词匹配方法而非嵌入模型
2025-03-26 02:33:25,129 - backend.app.embeddings.service - INFO - 从节点模板服务加载节点定义
2025-03-26 02:33:25,129 - backend.app.embeddings.service - INFO - 成功从模板服务加载 6 个节点定义
2025-03-26 02:33:25,129 - backend.app.services.prompt_embedding_service - INFO - EmbeddingService单例实例已初始化并缓存
2025-03-26 02:33:25,136 - backend.workflow - INFO - 开始处理用户输入: 创建movel节点给我
2025-03-26 02:33:25,136 - backend.workflow - INFO - 收集所有上下文信息用于DeepSeek交互
2025-03-26 02:33:25,136 - backend.workflow - ERROR - 获取当前流程图信息时出错: No module named 'backend.app.services.flow_service'
2025-03-26 02:33:25,136 - backend.workflow - ERROR - 错误详情: Traceback (most recent call last):
  File "/workspace/backend/app/services/workflow_prompt_service.py", line 957, in _get_current_flow_info
    from backend.app.services.flow_service import FlowService
ModuleNotFoundError: No module named 'backend.app.services.flow_service'

2025-03-26 02:33:25,136 - backend.workflow - ERROR - 获取当前用户信息时出错: No module named 'backend.app.services.flow_service'
2025-03-26 02:33:25,137 - backend.workflow - ERROR - 错误详情: Traceback (most recent call last):
  File "/workspace/backend/app/services/workflow_prompt_service.py", line 1116, in _get_current_user_info
    from backend.app.services.flow_service import FlowService
ModuleNotFoundError: No module named 'backend.app.services.flow_service'

2025-03-26 02:33:25,137 - backend.workflow - INFO - 全局变量文件不存在: global_variables.json
2025-03-26 02:33:25,137 - backend.workflow - INFO - 成功获取系统信息
2025-03-26 02:33:25,137 - backend.workflow - INFO - 成功收集所有上下文信息
2025-03-26 02:33:25,137 - backend.workflow - INFO - 添加上下文信息到用户输入
2025-03-26 02:33:25,137 - backend.app.services.prompt_expansion_service - INFO - 调用DeepSeek API，模型: deepseek-chat, API基础URL: https://api.deepseek.com
2025-03-26 02:33:25,137 - backend.app.services.prompt_expansion_service - INFO - 准备向DeepSeek API发送请求，消息长度: 640
2025-03-26 02:33:25,137 - backend.app.services.prompt_expansion_service - INFO - API密钥前4位: sk-f
2025-03-26 02:33:25,416 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-03-26 02:33:37,434 - backend.app.services.prompt_expansion_service - INFO - DeepSeek API响应成功
2025-03-26 02:33:37,435 - backend.workflow - INFO - 扩展后的提示: 步骤1: 确定节点类型为处理节点(process)
步骤2: 设置节点名称为"movel"
步骤3: 确认节点属性(如需要添加特定属性，请提供详细信息)
步骤4: 将movel节点连接到流程图中的适当位置(如需要连接其他节点，请提供目标节点信息)

缺少信息: 
- movel节点的具体功能或操作内容
- 是否需要连接其他节点(如开始节点或结束节点)
- 需要设置的节点属性(如果有)
2025-03-26 02:33:37,435 - backend.workflow - ERROR - 处理用户输入时出错: 'PromptExpansionService' object has no attribute 'check_direct_tool_request'
2025-03-26 02:33:37,438 - backend.workflow - ERROR - 错误详情: Traceback (most recent call last):
  File "/workspace/backend/app/services/workflow_prompt_service.py", line 246, in process_user_input
    is_tool_request, tool_name, tool_params = self.expansion_service.check_direct_tool_request(user_input)
AttributeError: 'PromptExpansionService' object has no attribute 'check_direct_tool_request'

2025-03-26 02:42:25,113 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:42:25,113 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:42:25,193 - backend.app.main - INFO - 导入database成功
2025-03-26 02:42:25,196 - backend.app.main - INFO - 导入models成功
2025-03-26 02:42:25,197 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:42:25,197 - backend.app.main - INFO - 导入config成功
2025-03-26 02:42:25,612 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:42:25,617 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:42:25,617 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:42:25,617 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:42:25,617 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:42:25,618 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:42:25,618 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:42:25,618 - backend.app.main - INFO - 注册路由...
2025-03-26 02:42:25,623 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:42:25,626 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:42:25,627 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:42:25,628 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:42:25,628 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:42:25,630 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:42:25,631 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:42:25,632 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:42:25,632 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:42:25,633 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:42:25,633 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:42:25,633 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:42:25,634 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:42:25,634 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:42:25,634 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:42:25,665 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:42:25,665 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:42:25,665 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:42:25,665 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:42:25,665 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:42:25,665 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:42:44,335 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:42:44,335 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:42:44,416 - backend.app.main - INFO - 导入database成功
2025-03-26 02:42:44,418 - backend.app.main - INFO - 导入models成功
2025-03-26 02:42:44,419 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:42:44,419 - backend.app.main - INFO - 导入config成功
2025-03-26 02:42:44,834 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:42:44,838 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:42:44,838 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:42:44,838 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:42:44,838 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:42:44,839 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:42:44,839 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:42:44,839 - backend.app.main - INFO - 注册路由...
2025-03-26 02:42:44,844 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:42:44,848 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:42:44,849 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:42:44,849 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:42:44,850 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:42:44,852 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:42:44,852 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:42:44,854 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:42:44,854 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:42:44,855 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:42:44,855 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:42:44,855 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:42:44,855 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:42:44,855 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:42:44,855 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:42:44,886 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:42:44,886 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:42:44,886 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:42:44,886 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:42:44,886 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:42:44,886 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:43:34,156 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:43:34,156 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:43:34,234 - backend.app.main - INFO - 导入database成功
2025-03-26 02:43:34,237 - backend.app.main - INFO - 导入models成功
2025-03-26 02:43:34,238 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:43:34,238 - backend.app.main - INFO - 导入config成功
2025-03-26 02:43:34,641 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:43:34,645 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:43:34,645 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:43:34,645 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:43:34,646 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:43:34,646 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:43:34,646 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:43:34,647 - backend.app.main - INFO - 注册路由...
2025-03-26 02:43:34,651 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:43:34,655 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:43:34,656 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:43:34,657 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:43:34,657 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:43:34,659 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:43:34,660 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:43:34,661 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:43:34,661 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:43:34,662 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:43:34,662 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:43:34,662 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:43:34,662 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:43:34,662 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:43:34,662 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:43:34,693 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:43:34,693 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:43:34,693 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:43:34,693 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:43:34,693 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:43:34,693 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:44:25,610 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:44:25,610 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:44:25,690 - backend.app.main - INFO - 导入database成功
2025-03-26 02:44:25,693 - backend.app.main - INFO - 导入models成功
2025-03-26 02:44:25,694 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:44:25,694 - backend.app.main - INFO - 导入config成功
2025-03-26 02:44:26,109 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:44:26,114 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:44:26,114 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:44:26,114 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:44:26,114 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:44:26,115 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:44:26,115 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:44:26,115 - backend.app.main - INFO - 注册路由...
2025-03-26 02:44:26,120 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:44:26,123 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:44:26,124 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:44:26,125 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:44:26,125 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:44:26,127 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:44:26,128 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:44:26,129 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:44:26,129 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:44:26,130 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:44:26,130 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:44:26,130 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:44:26,130 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:44:26,130 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:44:26,130 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:44:26,161 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:44:26,161 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:44:26,161 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:44:26,161 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:44:26,161 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:44:26,161 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:45:14,577 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:45:14,577 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:45:14,660 - backend.app.main - INFO - 导入database成功
2025-03-26 02:45:14,663 - backend.app.main - INFO - 导入models成功
2025-03-26 02:45:14,664 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:45:14,664 - backend.app.main - INFO - 导入config成功
2025-03-26 02:45:15,089 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:45:15,094 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:45:15,094 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:45:15,094 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:45:15,094 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:45:15,095 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:45:15,095 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:45:15,095 - backend.app.main - INFO - 注册路由...
2025-03-26 02:45:15,101 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:45:15,104 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:45:15,106 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:45:15,106 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:45:15,107 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:45:15,109 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:45:15,109 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:45:15,111 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:45:15,111 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:45:15,112 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:45:15,112 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:45:15,112 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:45:15,112 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:45:15,112 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:45:15,112 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:45:15,144 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:45:15,145 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:45:15,145 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:45:15,145 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:45:15,145 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:45:15,145 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:45:58,706 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:45:58,706 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:45:58,786 - backend.app.main - INFO - 导入database成功
2025-03-26 02:45:58,788 - backend.app.main - INFO - 导入models成功
2025-03-26 02:45:58,789 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:45:58,789 - backend.app.main - INFO - 导入config成功
2025-03-26 02:45:59,192 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:45:59,196 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:45:59,197 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:45:59,197 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:45:59,197 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:45:59,197 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:45:59,198 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:45:59,198 - backend.app.main - INFO - 注册路由...
2025-03-26 02:45:59,203 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:45:59,206 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:45:59,207 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:45:59,208 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:45:59,208 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:45:59,210 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:45:59,211 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:45:59,212 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:45:59,212 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:45:59,213 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:45:59,213 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:45:59,213 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:45:59,213 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:45:59,213 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:45:59,213 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:45:59,244 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:45:59,244 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:45:59,244 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:45:59,244 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:45:59,244 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:45:59,244 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:47:13,145 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:47:13,145 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:47:13,229 - backend.app.main - INFO - 导入database成功
2025-03-26 02:47:13,232 - backend.app.main - INFO - 导入models成功
2025-03-26 02:47:13,233 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:47:13,233 - backend.app.main - INFO - 导入config成功
2025-03-26 02:47:13,669 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:47:13,674 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:47:13,674 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:47:13,674 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:47:13,674 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:47:13,675 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:47:13,675 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:47:13,675 - backend.app.main - INFO - 注册路由...
2025-03-26 02:47:13,680 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:47:13,683 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:47:13,684 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:47:13,685 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:47:13,685 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:47:13,688 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:47:13,688 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:47:13,690 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:47:13,690 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:47:13,691 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:47:13,691 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:47:13,691 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:47:13,691 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:47:13,691 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:47:13,691 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:47:13,722 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:47:13,722 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:47:13,722 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:47:13,722 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:47:13,722 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:47:13,722 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:48:05,414 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:48:05,414 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:48:05,498 - backend.app.main - INFO - 导入database成功
2025-03-26 02:48:05,501 - backend.app.main - INFO - 导入models成功
2025-03-26 02:48:05,502 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:48:05,502 - backend.app.main - INFO - 导入config成功
2025-03-26 02:48:05,932 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:48:05,937 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:48:05,937 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:48:05,937 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:48:05,937 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:48:05,938 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:48:05,938 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:48:05,938 - backend.app.main - INFO - 注册路由...
2025-03-26 02:48:05,943 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:48:05,946 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:48:05,947 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:48:05,948 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:48:05,948 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:48:05,951 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:48:05,951 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:48:05,952 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:48:05,952 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:48:05,953 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:48:05,953 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:48:05,953 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:48:05,953 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:48:05,954 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:48:05,954 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:48:05,985 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:48:05,985 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:48:05,985 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:48:05,985 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:48:05,985 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:48:05,985 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:48:54,378 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:48:54,379 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:48:54,462 - backend.app.main - INFO - 导入database成功
2025-03-26 02:48:54,465 - backend.app.main - INFO - 导入models成功
2025-03-26 02:48:54,466 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:48:54,466 - backend.app.main - INFO - 导入config成功
2025-03-26 02:48:54,890 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:48:54,894 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:48:54,894 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:48:54,894 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:48:54,894 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:48:54,895 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:48:54,895 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:48:54,895 - backend.app.main - INFO - 注册路由...
2025-03-26 02:48:54,900 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:48:54,904 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:48:54,905 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:48:54,906 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:48:54,906 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:48:54,908 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:48:54,908 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:48:54,910 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:48:54,910 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:48:54,911 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:48:54,912 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:48:54,912 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:48:54,912 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:48:54,912 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:48:54,912 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:48:54,943 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:48:54,943 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:48:54,943 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:48:54,943 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:48:54,943 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:48:54,943 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:49:36,709 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:49:36,709 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:49:36,793 - backend.app.main - INFO - 导入database成功
2025-03-26 02:49:36,796 - backend.app.main - INFO - 导入models成功
2025-03-26 02:49:36,797 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:49:36,797 - backend.app.main - INFO - 导入config成功
2025-03-26 02:49:37,215 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:49:37,219 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:49:37,220 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:49:37,220 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:49:37,220 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:49:37,220 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:49:37,220 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:49:37,221 - backend.app.main - INFO - 注册路由...
2025-03-26 02:49:37,225 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:49:37,229 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:49:37,230 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:49:37,231 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:49:37,231 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:49:37,233 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:49:37,234 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:49:37,235 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:49:37,235 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:49:37,236 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:49:37,236 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:49:37,236 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:49:37,236 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:49:37,236 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:49:37,236 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:49:37,267 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:49:37,267 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:49:37,267 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:49:37,267 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:49:37,267 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:49:37,267 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:49:49,235 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:49:49,235 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:49:49,319 - backend.app.main - INFO - 导入database成功
2025-03-26 02:49:49,322 - backend.app.main - INFO - 导入models成功
2025-03-26 02:49:49,323 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:49:49,323 - backend.app.main - INFO - 导入config成功
2025-03-26 02:49:49,758 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:49:49,762 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:49:49,762 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:49:49,762 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:49:49,762 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:49:49,763 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:49:49,763 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:49:49,763 - backend.app.main - INFO - 注册路由...
2025-03-26 02:49:49,768 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:49:49,771 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:49:49,773 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:49:49,773 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:49:49,774 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:49:49,776 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:49:49,776 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:49:49,777 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:49:49,777 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:49:49,779 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:49:49,779 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:49:49,779 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:49:49,779 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:49:49,779 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:49:49,779 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:49:49,810 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:49:49,810 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:49:49,810 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:49:49,810 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:49:49,810 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:49:49,810 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:49:59,266 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:49:59,266 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:49:59,348 - backend.app.main - INFO - 导入database成功
2025-03-26 02:49:59,351 - backend.app.main - INFO - 导入models成功
2025-03-26 02:49:59,352 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:49:59,352 - backend.app.main - INFO - 导入config成功
2025-03-26 02:49:59,778 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:49:59,784 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:49:59,784 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:49:59,784 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:49:59,784 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:49:59,785 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:49:59,785 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:49:59,785 - backend.app.main - INFO - 注册路由...
2025-03-26 02:49:59,790 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:49:59,793 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:49:59,794 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:49:59,795 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:49:59,796 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:49:59,798 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:49:59,798 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:49:59,799 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:49:59,799 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:49:59,801 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:49:59,801 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:49:59,801 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:49:59,801 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:49:59,801 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:49:59,801 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:49:59,833 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:49:59,834 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:49:59,834 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:49:59,834 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:49:59,834 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:49:59,834 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:50:07,193 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:50:07,193 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:50:07,275 - backend.app.main - INFO - 导入database成功
2025-03-26 02:50:07,277 - backend.app.main - INFO - 导入models成功
2025-03-26 02:50:07,278 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:50:07,278 - backend.app.main - INFO - 导入config成功
2025-03-26 02:50:07,702 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:50:07,707 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:50:07,707 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:50:07,707 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:50:07,707 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:50:07,708 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:50:07,708 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:50:07,708 - backend.app.main - INFO - 注册路由...
2025-03-26 02:50:07,713 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:50:07,716 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:50:07,718 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:50:07,718 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:50:07,719 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:50:07,721 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:50:07,721 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:50:07,723 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:50:07,723 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:50:07,724 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:50:07,724 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:50:07,724 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:50:07,724 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:50:07,724 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:50:07,724 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:50:07,755 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:50:07,755 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:50:07,755 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:50:07,755 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:50:07,755 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:50:07,755 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:50:14,912 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:50:14,912 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:50:14,994 - backend.app.main - INFO - 导入database成功
2025-03-26 02:50:14,997 - backend.app.main - INFO - 导入models成功
2025-03-26 02:50:14,998 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:50:14,998 - backend.app.main - INFO - 导入config成功
2025-03-26 02:50:15,420 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:50:15,424 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:50:15,425 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:50:15,425 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:50:15,425 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:50:15,425 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:50:15,425 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:50:15,426 - backend.app.main - INFO - 注册路由...
2025-03-26 02:50:15,430 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:50:15,434 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:50:15,435 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:50:15,435 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:50:15,436 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:50:15,438 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:50:15,438 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:50:15,440 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:50:15,440 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:50:15,441 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:50:15,441 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:50:15,441 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:50:15,441 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:50:15,441 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:50:15,441 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:50:15,472 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:50:15,472 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:50:15,473 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:50:15,473 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:50:15,473 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:50:15,473 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:50:22,630 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:50:22,630 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:50:22,711 - backend.app.main - INFO - 导入database成功
2025-03-26 02:50:22,714 - backend.app.main - INFO - 导入models成功
2025-03-26 02:50:22,715 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:50:22,715 - backend.app.main - INFO - 导入config成功
2025-03-26 02:50:23,139 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:50:23,144 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:50:23,144 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:50:23,144 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:50:23,144 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:50:23,145 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:50:23,145 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:50:23,145 - backend.app.main - INFO - 注册路由...
2025-03-26 02:50:23,150 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:50:23,153 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:50:23,154 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:50:23,155 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:50:23,156 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:50:23,158 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:50:23,159 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:50:23,160 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:50:23,160 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:50:23,161 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:50:23,161 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:50:23,161 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:50:23,161 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:50:23,161 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:50:23,162 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:50:23,192 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:50:23,193 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:50:23,193 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:50:23,193 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:50:23,193 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:50:23,193 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:50:32,647 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:50:32,647 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:50:32,728 - backend.app.main - INFO - 导入database成功
2025-03-26 02:50:32,731 - backend.app.main - INFO - 导入models成功
2025-03-26 02:50:32,732 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:50:32,732 - backend.app.main - INFO - 导入config成功
2025-03-26 02:50:33,151 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:50:33,156 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:50:33,156 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:50:33,156 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:50:33,156 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:50:33,157 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:50:33,157 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:50:33,157 - backend.app.main - INFO - 注册路由...
2025-03-26 02:50:33,163 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:50:33,166 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:50:33,168 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:50:33,168 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:50:33,169 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:50:33,171 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:50:33,171 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:50:33,173 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:50:33,173 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:50:33,174 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:50:33,174 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:50:33,174 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:50:33,174 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:50:33,174 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:50:33,174 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:50:33,205 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:50:33,205 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:50:33,205 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:50:33,205 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:50:33,205 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:50:33,205 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:50:41,090 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:50:41,090 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:50:41,170 - backend.app.main - INFO - 导入database成功
2025-03-26 02:50:41,173 - backend.app.main - INFO - 导入models成功
2025-03-26 02:50:41,174 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:50:41,174 - backend.app.main - INFO - 导入config成功
2025-03-26 02:50:41,592 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:50:41,597 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:50:41,597 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:50:41,597 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:50:41,597 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:50:41,598 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:50:41,598 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:50:41,598 - backend.app.main - INFO - 注册路由...
2025-03-26 02:50:41,603 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:50:41,607 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:50:41,608 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:50:41,609 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:50:41,609 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:50:41,611 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:50:41,612 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:50:41,613 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:50:41,613 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:50:41,614 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:50:41,614 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:50:41,614 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:50:41,614 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:50:41,614 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:50:41,614 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:50:41,645 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:50:41,646 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:50:41,646 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:50:41,646 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:50:41,646 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:50:41,646 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:50:48,191 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:50:48,191 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:50:48,274 - backend.app.main - INFO - 导入database成功
2025-03-26 02:50:48,276 - backend.app.main - INFO - 导入models成功
2025-03-26 02:50:48,277 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:50:48,277 - backend.app.main - INFO - 导入config成功
2025-03-26 02:50:48,706 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:50:48,710 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:50:48,711 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:50:48,711 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:50:48,711 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:50:48,711 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:50:48,711 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:50:48,712 - backend.app.main - INFO - 注册路由...
2025-03-26 02:50:48,716 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:50:48,720 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:50:48,721 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:50:48,722 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:50:48,722 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:50:48,724 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:50:48,725 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:50:48,726 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:50:48,726 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:50:48,727 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:50:48,727 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:50:48,727 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:50:48,727 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:50:48,727 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:50:48,727 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:50:48,758 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:50:48,759 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:50:48,759 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:50:48,759 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:50:48,759 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:50:48,759 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:50:55,897 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:50:55,897 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:50:55,979 - backend.app.main - INFO - 导入database成功
2025-03-26 02:50:55,982 - backend.app.main - INFO - 导入models成功
2025-03-26 02:50:55,983 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:50:55,983 - backend.app.main - INFO - 导入config成功
2025-03-26 02:50:56,412 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:50:56,417 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:50:56,417 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:50:56,417 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:50:56,417 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:50:56,418 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:50:56,418 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:50:56,418 - backend.app.main - INFO - 注册路由...
2025-03-26 02:50:56,423 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:50:56,426 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:50:56,428 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:50:56,428 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:50:56,429 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:50:56,431 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:50:56,431 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:50:56,432 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:50:56,432 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:50:56,433 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:50:56,434 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:50:56,434 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:50:56,434 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:50:56,434 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:50:56,434 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:50:56,467 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:50:56,467 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:50:56,467 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:50:56,467 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:50:56,467 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:50:56,467 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:51:08,113 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:51:08,113 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:51:08,195 - backend.app.main - INFO - 导入database成功
2025-03-26 02:51:08,198 - backend.app.main - INFO - 导入models成功
2025-03-26 02:51:08,198 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:51:08,199 - backend.app.main - INFO - 导入config成功
2025-03-26 02:51:08,664 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:51:08,668 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:51:08,668 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:51:08,668 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:51:08,668 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:51:08,669 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:51:08,669 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:51:08,670 - backend.app.main - INFO - 注册路由...
2025-03-26 02:51:08,674 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:51:08,678 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:51:08,679 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:51:08,680 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:51:08,680 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:51:08,682 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:51:08,683 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:51:08,684 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:51:08,684 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:51:08,685 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:51:08,685 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:51:08,686 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:51:08,686 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:51:08,686 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:51:08,686 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:51:08,717 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:51:08,717 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:51:08,717 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:51:08,717 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:51:08,717 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:51:08,717 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:51:37,237 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:51:37,237 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:51:37,317 - backend.app.main - INFO - 导入database成功
2025-03-26 02:51:37,320 - backend.app.main - INFO - 导入models成功
2025-03-26 02:51:37,321 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:51:37,321 - backend.app.main - INFO - 导入config成功
2025-03-26 02:51:37,731 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:51:37,736 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:51:37,736 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:51:37,736 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:51:37,736 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:51:37,737 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:51:37,737 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:51:37,737 - backend.app.main - INFO - 注册路由...
2025-03-26 02:51:37,742 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:51:37,745 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:51:37,746 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:51:37,747 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:51:37,748 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:51:37,750 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:51:37,750 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:51:37,751 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:51:37,751 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:51:37,753 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:51:37,753 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:51:37,753 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:51:37,753 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:51:37,753 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:51:37,753 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:51:37,786 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:51:37,787 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:51:37,787 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:51:37,787 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:51:37,787 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:51:37,787 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:51:59,977 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:51:59,977 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:52:00,060 - backend.app.main - INFO - 导入database成功
2025-03-26 02:52:00,063 - backend.app.main - INFO - 导入models成功
2025-03-26 02:52:00,064 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:52:00,064 - backend.app.main - INFO - 导入config成功
2025-03-26 02:52:00,496 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:52:00,501 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:52:00,501 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:52:00,501 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:52:00,501 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:52:00,502 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:52:00,502 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:52:00,502 - backend.app.main - INFO - 注册路由...
2025-03-26 02:52:00,507 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:52:00,511 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:52:00,512 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:52:00,512 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:52:00,513 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:52:00,515 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:52:00,515 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:52:00,517 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:52:00,517 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:52:00,518 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:52:00,518 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:52:00,518 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:52:00,518 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:52:00,518 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:52:00,518 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:52:00,549 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:52:00,549 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:52:00,549 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:52:00,549 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:52:00,549 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:52:00,549 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:52:50,951 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:52:50,951 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:52:51,031 - backend.app.main - INFO - 导入database成功
2025-03-26 02:52:51,033 - backend.app.main - INFO - 导入models成功
2025-03-26 02:52:51,034 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:52:51,034 - backend.app.main - INFO - 导入config成功
2025-03-26 02:52:51,460 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:52:51,464 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:52:51,464 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:52:51,464 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:52:51,464 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:52:51,465 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:52:51,465 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:52:51,465 - backend.app.main - INFO - 注册路由...
2025-03-26 02:52:51,471 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:52:51,474 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:52:51,475 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:52:51,476 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:52:51,476 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:52:51,479 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:52:51,479 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:52:51,480 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:52:51,480 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:52:51,481 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:52:51,481 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:52:51,482 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:52:51,482 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:52:51,482 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:52:51,482 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:52:51,513 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:52:51,513 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:52:51,513 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:52:51,513 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:52:51,513 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:52:51,513 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:53:40,106 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:53:40,106 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:53:40,189 - backend.app.main - INFO - 导入database成功
2025-03-26 02:53:40,191 - backend.app.main - INFO - 导入models成功
2025-03-26 02:53:40,192 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:53:40,192 - backend.app.main - INFO - 导入config成功
2025-03-26 02:53:40,603 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:53:40,609 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:53:40,609 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:53:40,609 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:53:40,609 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:53:40,610 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:53:40,610 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:53:40,610 - backend.app.main - INFO - 注册路由...
2025-03-26 02:53:40,615 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:53:40,619 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:53:40,620 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:53:40,621 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:53:40,621 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:53:40,624 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:53:40,624 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:53:40,626 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:53:40,626 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:53:40,628 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:53:40,628 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:53:40,628 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:53:40,628 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:53:40,628 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:53:40,628 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:53:40,659 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:53:40,659 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:53:40,660 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:53:40,660 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:53:40,660 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:53:40,660 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:54:48,191 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:54:48,191 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:54:48,272 - backend.app.main - INFO - 导入database成功
2025-03-26 02:54:48,275 - backend.app.main - INFO - 导入models成功
2025-03-26 02:54:48,275 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:54:48,276 - backend.app.main - INFO - 导入config成功
2025-03-26 02:54:48,697 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:54:48,702 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:54:48,702 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:54:48,702 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:54:48,702 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:54:48,703 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:54:48,703 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:54:48,703 - backend.app.main - INFO - 注册路由...
2025-03-26 02:54:48,708 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:54:48,711 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:54:48,712 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:54:48,713 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:54:48,713 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:54:48,715 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:54:48,716 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:54:48,717 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:54:48,717 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:54:48,718 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:54:48,718 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:54:48,718 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:54:48,718 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:54:48,718 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:54:48,718 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:54:48,749 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:54:48,750 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:54:48,750 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:54:48,750 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:54:48,750 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:54:48,750 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:55:30,620 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:55:30,620 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:55:30,700 - backend.app.main - INFO - 导入database成功
2025-03-26 02:55:30,703 - backend.app.main - INFO - 导入models成功
2025-03-26 02:55:30,703 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:55:30,704 - backend.app.main - INFO - 导入config成功
2025-03-26 02:55:31,124 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:55:31,129 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:55:31,129 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:55:31,129 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:55:31,129 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:55:31,130 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:55:31,130 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:55:31,130 - backend.app.main - INFO - 注册路由...
2025-03-26 02:55:31,135 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:55:31,138 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:55:31,140 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:55:31,140 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:55:31,141 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:55:31,143 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:55:31,143 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:55:31,144 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:55:31,144 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:55:31,146 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:55:31,146 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:55:31,146 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:55:31,146 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:55:31,146 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:55:31,146 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:55:31,177 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:55:31,177 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:55:31,177 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:55:31,177 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:55:31,177 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:55:31,177 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 02:55:42,634 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 02:55:42,634 - backend.app.main - INFO - 开始导入模块...
2025-03-26 02:55:42,716 - backend.app.main - INFO - 导入database成功
2025-03-26 02:55:42,719 - backend.app.main - INFO - 导入models成功
2025-03-26 02:55:42,720 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 02:55:42,720 - backend.app.main - INFO - 导入config成功
2025-03-26 02:55:43,150 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 02:55:43,155 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 02:55:43,155 - backend.app.main - INFO - 导入utils成功
2025-03-26 02:55:43,155 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 02:55:43,155 - backend.app.main - INFO - 创建数据库表...
2025-03-26 02:55:43,156 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 02:55:43,156 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 02:55:43,156 - backend.app.main - INFO - 注册路由...
2025-03-26 02:55:43,161 - backend.app.main - INFO - 注册user路由成功
2025-03-26 02:55:43,165 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 02:55:43,166 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 02:55:43,167 - backend.app.main - INFO - 注册email路由成功
2025-03-26 02:55:43,167 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 02:55:43,170 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 02:55:43,170 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 02:55:43,171 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 02:55:43,171 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 02:55:43,173 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 02:55:43,173 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 02:55:43,173 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 02:55:43,173 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 02:55:43,173 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 02:55:43,173 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 02:55:43,204 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 02:55:43,204 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 02:55:43,204 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 02:55:43,205 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 02:55:43,205 - backend.app.startup - INFO - API前缀: /api
2025-03-26 02:55:43,205 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 03:11:15,013 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 03:11:15,013 - backend.app.main - INFO - 开始导入模块...
2025-03-26 03:11:15,093 - backend.app.main - INFO - 导入database成功
2025-03-26 03:11:15,096 - backend.app.main - INFO - 导入models成功
2025-03-26 03:11:15,096 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 03:11:15,096 - backend.app.main - INFO - 导入config成功
2025-03-26 03:11:15,511 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 03:11:15,516 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 03:11:15,516 - backend.app.main - INFO - 导入utils成功
2025-03-26 03:11:15,516 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 03:11:15,516 - backend.app.main - INFO - 创建数据库表...
2025-03-26 03:11:15,517 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 03:11:15,517 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 03:11:15,517 - backend.app.main - INFO - 注册路由...
2025-03-26 03:11:15,522 - backend.app.main - INFO - 注册user路由成功
2025-03-26 03:11:15,525 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 03:11:15,526 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 03:11:15,527 - backend.app.main - INFO - 注册email路由成功
2025-03-26 03:11:15,528 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 03:11:15,530 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 03:11:15,530 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 03:11:15,531 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 03:11:15,531 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 03:11:15,532 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 03:11:15,532 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 03:11:15,532 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 03:11:15,533 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 03:11:15,533 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 03:11:15,533 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 03:11:15,563 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 03:11:15,563 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 03:11:15,563 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 03:11:15,563 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 03:11:15,563 - backend.app.startup - INFO - API前缀: /api
2025-03-26 03:11:15,563 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 03:11:37,540 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 03:11:37,540 - backend.app.main - INFO - 开始导入模块...
2025-03-26 03:11:37,619 - backend.app.main - INFO - 导入database成功
2025-03-26 03:11:37,622 - backend.app.main - INFO - 导入models成功
2025-03-26 03:11:37,623 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 03:11:37,623 - backend.app.main - INFO - 导入config成功
2025-03-26 03:11:38,040 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 03:11:38,045 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 03:11:38,045 - backend.app.main - INFO - 导入utils成功
2025-03-26 03:11:38,045 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 03:11:38,045 - backend.app.main - INFO - 创建数据库表...
2025-03-26 03:11:38,046 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 03:11:38,046 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 03:11:38,046 - backend.app.main - INFO - 注册路由...
2025-03-26 03:11:38,051 - backend.app.main - INFO - 注册user路由成功
2025-03-26 03:11:38,054 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 03:11:38,055 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 03:11:38,056 - backend.app.main - INFO - 注册email路由成功
2025-03-26 03:11:38,056 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 03:11:38,059 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 03:11:38,059 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 03:11:38,060 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 03:11:38,060 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 03:11:38,062 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 03:11:38,062 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 03:11:38,062 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 03:11:38,062 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 03:11:38,062 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 03:11:38,062 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 03:11:38,093 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 03:11:38,093 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 03:11:38,093 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 03:11:38,093 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 03:11:38,093 - backend.app.startup - INFO - API前缀: /api
2025-03-26 03:11:38,093 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 03:12:00,975 - backend.app.services.prompt_embedding_service - INFO - 创建PromptEmbeddingService单例实例
2025-03-26 03:12:00,975 - backend.app.embeddings.service - INFO - 创建EmbeddingService单例实例
2025-03-26 03:12:00,975 - backend.app.embeddings.service - INFO - 初始化EmbeddingService，使用关键词匹配方法而非嵌入模型
2025-03-26 03:12:00,975 - backend.app.embeddings.service - INFO - 从节点模板服务加载节点定义
2025-03-26 03:12:00,975 - backend.app.embeddings.service - INFO - 成功从模板服务加载 6 个节点定义
2025-03-26 03:12:00,975 - backend.app.services.prompt_embedding_service - INFO - EmbeddingService单例实例已初始化并缓存
2025-03-26 03:12:00,982 - backend.workflow - INFO - 开始处理用户输入: 创建一个movel节点到页面上
2025-03-26 03:12:00,982 - backend.workflow - INFO - 收集所有上下文信息用于DeepSeek交互
2025-03-26 03:12:00,982 - backend.workflow - ERROR - 获取当前流程图信息时出错: No module named 'backend.app.services.flow_service'
2025-03-26 03:12:00,983 - backend.workflow - ERROR - 错误详情: Traceback (most recent call last):
  File "/workspace/backend/app/services/workflow_prompt_service.py", line 957, in _get_current_flow_info
    from backend.app.services.flow_service import FlowService
ModuleNotFoundError: No module named 'backend.app.services.flow_service'

2025-03-26 03:12:00,983 - backend.workflow - ERROR - 获取当前用户信息时出错: No module named 'backend.app.services.flow_service'
2025-03-26 03:12:00,983 - backend.workflow - ERROR - 错误详情: Traceback (most recent call last):
  File "/workspace/backend/app/services/workflow_prompt_service.py", line 1116, in _get_current_user_info
    from backend.app.services.flow_service import FlowService
ModuleNotFoundError: No module named 'backend.app.services.flow_service'

2025-03-26 03:12:00,983 - backend.workflow - INFO - 全局变量文件不存在: global_variables.json
2025-03-26 03:12:00,983 - backend.workflow - INFO - 成功获取系统信息
2025-03-26 03:12:00,983 - backend.workflow - INFO - 成功收集所有上下文信息
2025-03-26 03:12:00,983 - backend.workflow - INFO - 添加上下文信息到用户输入
2025-03-26 03:12:00,983 - backend.app.services.prompt_expansion_service - INFO - 调用DeepSeek API，模型: deepseek-chat, API基础URL: https://api.deepseek.com
2025-03-26 03:12:00,983 - backend.app.services.prompt_expansion_service - INFO - 准备向DeepSeek API发送请求，消息长度: 644
2025-03-26 03:12:00,983 - backend.app.services.prompt_expansion_service - INFO - API密钥前4位: sk-f
2025-03-26 03:12:01,259 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-03-26 03:12:08,420 - backend.app.services.prompt_expansion_service - INFO - DeepSeek API响应成功
2025-03-26 03:12:08,421 - backend.workflow - INFO - 扩展后的提示: 步骤1: 确认节点类型为"movel"节点（假设为处理节点/process）
步骤2: 设置节点名称为"movel"（或由用户指定）
步骤3: 设置节点属性为空（或由用户指定）
步骤4: 在流程图编辑界面添加该节点到画布
步骤5: 连接该节点到流程中的适当位置（如需要）
2025-03-26 03:12:08,422 - backend.workflow - ERROR - 处理用户输入时出错: 'PromptExpansionService' object has no attribute 'check_direct_tool_request'
2025-03-26 03:12:08,425 - backend.workflow - ERROR - 错误详情: Traceback (most recent call last):
  File "/workspace/backend/app/services/workflow_prompt_service.py", line 246, in process_user_input
    is_tool_request, tool_name, tool_params = self.expansion_service.check_direct_tool_request(user_input)
AttributeError: 'PromptExpansionService' object has no attribute 'check_direct_tool_request'

2025-03-26 03:27:55,919 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 03:27:55,919 - backend.app.main - INFO - 开始导入模块...
2025-03-26 03:27:56,000 - backend.app.main - INFO - 导入database成功
2025-03-26 03:27:56,003 - backend.app.main - INFO - 导入models成功
2025-03-26 03:27:56,004 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 03:27:56,004 - backend.app.main - INFO - 导入config成功
2025-03-26 03:27:56,436 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 03:27:56,441 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 03:27:56,441 - backend.app.main - INFO - 导入utils成功
2025-03-26 03:27:56,441 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 03:27:56,441 - backend.app.main - INFO - 创建数据库表...
2025-03-26 03:27:56,442 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 03:27:56,442 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 03:27:56,443 - backend.app.main - INFO - 注册路由...
2025-03-26 03:27:56,448 - backend.app.main - INFO - 注册user路由成功
2025-03-26 03:27:56,451 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 03:27:56,452 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 03:27:56,453 - backend.app.main - INFO - 注册email路由成功
2025-03-26 03:27:56,453 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 03:27:56,455 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 03:27:56,456 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 03:27:56,457 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 03:27:56,457 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 03:27:56,458 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 03:27:56,459 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 03:27:56,459 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 03:27:56,459 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 03:27:56,459 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 03:27:56,459 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 03:27:56,490 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 03:27:56,490 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 03:27:56,490 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 03:27:56,490 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 03:27:56,490 - backend.app.startup - INFO - API前缀: /api
2025-03-26 03:27:56,490 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 03:28:09,606 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 03:28:09,606 - backend.app.main - INFO - 开始导入模块...
2025-03-26 03:28:09,694 - backend.app.main - INFO - 导入database成功
2025-03-26 03:28:09,697 - backend.app.main - INFO - 导入models成功
2025-03-26 03:28:09,698 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 03:28:09,698 - backend.app.main - INFO - 导入config成功
2025-03-26 03:28:10,134 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 03:28:10,139 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 03:28:10,139 - backend.app.main - INFO - 导入utils成功
2025-03-26 03:28:10,139 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 03:28:10,139 - backend.app.main - INFO - 创建数据库表...
2025-03-26 03:28:10,140 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 03:28:10,140 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 03:28:10,140 - backend.app.main - INFO - 注册路由...
2025-03-26 03:28:10,145 - backend.app.main - INFO - 注册user路由成功
2025-03-26 03:28:10,149 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 03:28:10,150 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 03:28:10,151 - backend.app.main - INFO - 注册email路由成功
2025-03-26 03:28:10,152 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 03:28:10,154 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 03:28:10,154 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 03:28:10,156 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 03:28:10,156 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 03:28:10,157 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 03:28:10,157 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 03:28:10,157 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 03:28:10,157 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 03:28:10,157 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 03:28:10,157 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 03:28:10,189 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 03:28:10,189 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 03:28:10,189 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 03:28:10,189 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 03:28:10,189 - backend.app.startup - INFO - API前缀: /api
2025-03-26 03:28:10,189 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 03:28:22,160 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 03:28:22,160 - backend.app.main - INFO - 开始导入模块...
2025-03-26 03:28:22,243 - backend.app.main - INFO - 导入database成功
2025-03-26 03:28:22,246 - backend.app.main - INFO - 导入models成功
2025-03-26 03:28:22,247 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 03:28:22,247 - backend.app.main - INFO - 导入config成功
2025-03-26 03:28:22,692 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 03:28:22,697 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 03:28:22,697 - backend.app.main - INFO - 导入utils成功
2025-03-26 03:28:22,697 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 03:28:22,697 - backend.app.main - INFO - 创建数据库表...
2025-03-26 03:28:22,698 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 03:28:22,698 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 03:28:22,698 - backend.app.main - INFO - 注册路由...
2025-03-26 03:28:22,703 - backend.app.main - INFO - 注册user路由成功
2025-03-26 03:28:22,707 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 03:28:22,708 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 03:28:22,709 - backend.app.main - INFO - 注册email路由成功
2025-03-26 03:28:22,709 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 03:28:22,712 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 03:28:22,712 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 03:28:22,713 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 03:28:22,713 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 03:28:22,715 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 03:28:22,715 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 03:28:22,715 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 03:28:22,715 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 03:28:22,715 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 03:28:22,715 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 03:28:22,746 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 03:28:22,746 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 03:28:22,746 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 03:28:22,746 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 03:28:22,746 - backend.app.startup - INFO - API前缀: /api
2025-03-26 03:28:22,746 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 03:28:54,389 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 03:28:54,389 - backend.app.main - INFO - 开始导入模块...
2025-03-26 03:28:54,480 - backend.app.main - INFO - 导入database成功
2025-03-26 03:28:54,483 - backend.app.main - INFO - 导入models成功
2025-03-26 03:28:54,484 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 03:28:54,484 - backend.app.main - INFO - 导入config成功
2025-03-26 03:28:54,930 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 03:28:54,937 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 03:28:54,937 - backend.app.main - INFO - 导入utils成功
2025-03-26 03:28:54,937 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 03:28:54,937 - backend.app.main - INFO - 创建数据库表...
2025-03-26 03:28:54,938 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 03:28:54,938 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 03:28:54,939 - backend.app.main - INFO - 注册路由...
2025-03-26 03:28:54,945 - backend.app.main - INFO - 注册user路由成功
2025-03-26 03:28:54,949 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 03:28:54,950 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 03:28:54,951 - backend.app.main - INFO - 注册email路由成功
2025-03-26 03:28:54,952 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 03:28:54,954 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 03:28:54,954 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 03:28:54,956 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 03:28:54,956 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 03:28:54,957 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 03:28:54,957 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 03:28:54,957 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 03:28:54,957 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 03:28:54,957 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 03:28:54,957 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 03:28:54,989 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 03:28:54,989 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 03:28:54,989 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 03:28:54,989 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 03:28:54,989 - backend.app.startup - INFO - API前缀: /api
2025-03-26 03:28:54,989 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 03:45:24,782 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 03:45:24,783 - backend.app.main - INFO - 开始导入模块...
2025-03-26 03:45:24,860 - backend.app.main - INFO - 导入database成功
2025-03-26 03:45:24,863 - backend.app.main - INFO - 导入models成功
2025-03-26 03:45:24,864 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 03:45:24,864 - backend.app.main - INFO - 导入config成功
2025-03-26 03:45:25,262 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 03:45:25,267 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 03:45:25,267 - backend.app.main - INFO - 导入utils成功
2025-03-26 03:45:25,267 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 03:45:25,267 - backend.app.main - INFO - 创建数据库表...
2025-03-26 03:45:25,268 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 03:45:25,268 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 03:45:25,268 - backend.app.main - INFO - 注册路由...
2025-03-26 03:45:25,273 - backend.app.main - INFO - 注册user路由成功
2025-03-26 03:45:25,276 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 03:45:25,277 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 03:45:25,278 - backend.app.main - INFO - 注册email路由成功
2025-03-26 03:45:25,279 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 03:45:25,281 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 03:45:25,281 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 03:45:25,282 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 03:45:25,282 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 03:45:25,284 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 03:45:25,284 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 03:45:25,284 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 03:45:25,284 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 03:45:25,284 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 03:45:25,284 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 03:45:25,315 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 03:45:25,315 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 03:45:25,315 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 03:45:25,315 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 03:45:25,315 - backend.app.startup - INFO - API前缀: /api
2025-03-26 03:45:25,315 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 03:47:27,551 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 03:47:27,551 - backend.app.main - INFO - 开始导入模块...
2025-03-26 03:47:27,632 - backend.app.main - INFO - 导入database成功
2025-03-26 03:47:27,634 - backend.app.main - INFO - 导入models成功
2025-03-26 03:47:27,635 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 03:47:27,635 - backend.app.main - INFO - 导入config成功
2025-03-26 03:47:28,054 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 03:47:28,059 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 03:47:28,059 - backend.app.main - INFO - 导入utils成功
2025-03-26 03:47:28,059 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 03:47:28,059 - backend.app.main - INFO - 创建数据库表...
2025-03-26 03:47:28,060 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 03:47:28,060 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 03:47:28,060 - backend.app.main - INFO - 注册路由...
2025-03-26 03:47:28,065 - backend.app.main - INFO - 注册user路由成功
2025-03-26 03:47:28,069 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 03:47:28,070 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 03:47:28,071 - backend.app.main - INFO - 注册email路由成功
2025-03-26 03:47:28,071 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 03:47:28,073 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 03:47:28,074 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 03:47:28,075 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 03:47:28,075 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 03:47:28,076 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 03:47:28,076 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 03:47:28,076 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 03:47:28,076 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 03:47:28,076 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 03:47:28,076 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 03:47:28,110 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 03:47:28,110 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 03:47:28,110 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 03:47:28,110 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 03:47:28,110 - backend.app.startup - INFO - API前缀: /api
2025-03-26 03:47:28,110 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 03:49:06,043 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 03:49:06,044 - backend.app.main - INFO - 开始导入模块...
2025-03-26 03:49:06,126 - backend.app.main - INFO - 导入database成功
2025-03-26 03:49:06,129 - backend.app.main - INFO - 导入models成功
2025-03-26 03:49:06,130 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 03:49:06,130 - backend.app.main - INFO - 导入config成功
2025-03-26 03:49:06,579 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 03:49:06,584 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 03:49:06,584 - backend.app.main - INFO - 导入utils成功
2025-03-26 03:49:06,584 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 03:49:06,584 - backend.app.main - INFO - 创建数据库表...
2025-03-26 03:49:06,585 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 03:49:06,585 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 03:49:06,585 - backend.app.main - INFO - 注册路由...
2025-03-26 03:49:06,590 - backend.app.main - INFO - 注册user路由成功
2025-03-26 03:49:06,594 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 03:49:06,596 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 03:49:06,597 - backend.app.main - INFO - 注册email路由成功
2025-03-26 03:49:06,598 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 03:49:06,600 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 03:49:06,601 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 03:49:06,602 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 03:49:06,602 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 03:49:06,603 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 03:49:06,603 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 03:49:06,603 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 03:49:06,603 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 03:49:06,603 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 03:49:06,603 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 03:49:06,643 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 03:49:06,643 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 03:49:06,643 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 03:49:06,643 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 03:49:06,643 - backend.app.startup - INFO - API前缀: /api
2025-03-26 03:49:06,643 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 03:50:28,648 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 03:50:28,648 - backend.app.main - INFO - 开始导入模块...
2025-03-26 03:50:28,733 - backend.app.main - INFO - 导入database成功
2025-03-26 03:50:28,736 - backend.app.main - INFO - 导入models成功
2025-03-26 03:50:28,737 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 03:50:28,737 - backend.app.main - INFO - 导入config成功
2025-03-26 03:50:29,186 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 03:50:29,191 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 03:50:29,191 - backend.app.main - INFO - 导入utils成功
2025-03-26 03:50:29,191 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 03:50:29,191 - backend.app.main - INFO - 创建数据库表...
2025-03-26 03:50:29,192 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 03:50:29,192 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 03:50:29,192 - backend.app.main - INFO - 注册路由...
2025-03-26 03:50:29,197 - backend.app.main - INFO - 注册user路由成功
2025-03-26 03:50:29,201 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 03:50:29,203 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 03:50:29,203 - backend.app.main - INFO - 注册email路由成功
2025-03-26 03:50:29,204 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 03:50:29,206 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 03:50:29,206 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 03:50:29,208 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 03:50:29,208 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 03:50:29,209 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 03:50:29,209 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 03:50:29,209 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 03:50:29,209 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 03:50:29,209 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 03:50:29,209 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 03:50:29,240 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 03:50:29,240 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 03:50:29,240 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 03:50:29,240 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 03:50:29,240 - backend.app.startup - INFO - API前缀: /api
2025-03-26 03:50:29,240 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-03-26 03:50:46,726 - backend.app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-03-26 03:50:46,726 - backend.app.main - INFO - 开始导入模块...
2025-03-26 03:50:46,809 - backend.app.main - INFO - 导入database成功
2025-03-26 03:50:46,812 - backend.app.main - INFO - 导入models成功
2025-03-26 03:50:46,813 - backend.app.main - INFO - 导入embedding模型成功
2025-03-26 03:50:46,813 - backend.app.main - INFO - 导入config成功
2025-03-26 03:50:47,230 - backend.app.main - INFO - 导入基本路由成功
2025-03-26 03:50:47,234 - backend.app.main - INFO - 导入workflow_router成功
2025-03-26 03:50:47,234 - backend.app.main - INFO - 导入utils成功
2025-03-26 03:50:47,234 - backend.app.main - INFO - 导入dependencies成功
2025-03-26 03:50:47,234 - backend.app.main - INFO - 创建数据库表...
2025-03-26 03:50:47,235 - backend.app.main - INFO - 数据库表创建成功
2025-03-26 03:50:47,235 - backend.app.main - INFO - 初始化FastAPI应用...
2025-03-26 03:50:47,235 - backend.app.main - INFO - 注册路由...
2025-03-26 03:50:47,240 - backend.app.main - INFO - 注册user路由成功
2025-03-26 03:50:47,244 - backend.app.main - INFO - 注册flow路由成功
2025-03-26 03:50:47,245 - backend.app.main - INFO - 注册llm路由成功
2025-03-26 03:50:47,245 - backend.app.main - INFO - 注册email路由成功
2025-03-26 03:50:47,246 - backend.app.main - INFO - 注册auth路由成功
2025-03-26 03:50:47,248 - backend.app.main - INFO - 注册embedding路由成功
2025-03-26 03:50:47,248 - backend.app.main - INFO - 注册node_templates路由成功
2025-03-26 03:50:47,250 - backend.app.main - INFO - 注册workflow路由成功
2025-03-26 03:50:47,250 - backend.app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-03-26 03:50:47,251 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-03-26 03:50:47,251 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-03-26 03:50:47,251 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-03-26 03:50:47,251 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-03-26 03:50:47,251 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com, API密钥: sk-f***
2025-03-26 03:50:47,251 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com
2025-03-26 03:50:47,282 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-03-26 03:50:47,282 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-03-26 03:50:47,282 - backend.app.startup - INFO - 数据库URL: sqlite:///./flow_editor.db
2025-03-26 03:50:47,282 - backend.app.startup - INFO - ✓ 调试模式已禁用
2025-03-26 03:50:47,282 - backend.app.startup - INFO - API前缀: /api
2025-03-26 03:50:47,282 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-04 08:55:34,422 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-04 08:55:34,430 - app.main - INFO - 开始导入模块...
2025-04-04 08:55:34,430 - app.main - INFO - 导入database成功
2025-04-04 08:55:34,430 - app.main - INFO - 导入models成功
2025-04-04 08:55:34,430 - app.main - ERROR - 导入模块时出错: No module named 'backend.app.embeddings'
2025-04-04 08:55:55,897 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-04 08:55:55,898 - app.main - INFO - 开始导入模块...
2025-04-04 08:55:55,898 - app.main - INFO - 导入database成功
2025-04-04 08:55:55,898 - app.main - INFO - 导入models成功
2025-04-04 08:55:55,898 - app.main - ERROR - 导入模块时出错: No module named 'backend.app.embeddings'
2025-04-04 08:56:18,603 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-04 08:56:18,603 - app.main - INFO - 开始导入模块...
2025-04-04 08:56:18,603 - app.main - INFO - 导入database成功
2025-04-04 08:56:18,603 - app.main - INFO - 导入models成功
2025-04-04 08:56:18,603 - app.main - INFO - 导入config成功
2025-04-04 08:56:18,701 - app.main - ERROR - 导入模块时出错: cannot import name 'llm' from 'backend.app.routers' (/workspace/backend/app/routers/__init__.py)
2025-04-04 08:56:32,480 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-04 08:56:32,480 - app.main - INFO - 开始导入模块...
2025-04-04 08:56:32,480 - app.main - INFO - 导入database成功
2025-04-04 08:56:32,480 - app.main - INFO - 导入models成功
2025-04-04 08:56:32,480 - app.main - INFO - 导入config成功
2025-04-04 08:56:32,558 - app.main - ERROR - 导入模块时出错: cannot import name 'llm' from 'backend.app.routers' (/workspace/backend/app/routers/__init__.py)
2025-04-04 08:56:47,988 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-04 08:56:47,988 - app.main - INFO - 开始导入模块...
2025-04-04 08:56:47,988 - app.main - INFO - 导入database成功
2025-04-04 08:56:47,988 - app.main - INFO - 导入models成功
2025-04-04 08:56:47,988 - app.main - INFO - 导入config成功
2025-04-04 08:56:48,065 - app.main - ERROR - 导入模块时出错: cannot import name 'llm' from 'backend.app.routers' (/workspace/backend/app/routers/__init__.py)
2025-04-04 08:57:07,735 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-04 08:57:07,735 - app.main - INFO - 开始导入模块...
2025-04-04 08:57:07,735 - app.main - INFO - 导入database成功
2025-04-04 08:57:07,735 - app.main - INFO - 导入models成功
2025-04-04 08:57:07,735 - app.main - INFO - 导入config成功
2025-04-04 08:57:07,813 - app.main - ERROR - 导入模块时出错: cannot import name 'flow_router' from 'backend.app.routers' (/workspace/backend/app/routers/__init__.py)
2025-04-04 08:57:19,051 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-04 08:57:19,051 - app.main - INFO - 开始导入模块...
2025-04-04 08:57:19,051 - app.main - INFO - 导入database成功
2025-04-04 08:57:19,051 - app.main - INFO - 导入models成功
2025-04-04 08:57:19,051 - app.main - INFO - 导入config成功
2025-04-04 08:57:19,134 - app.main - ERROR - 导入模块时出错: cannot import name 'flow_router' from 'backend.app.routers' (/workspace/backend/app/routers/__init__.py)
2025-04-04 08:57:34,448 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-04 08:57:34,448 - app.main - INFO - 开始导入模块...
2025-04-04 08:57:34,448 - app.main - INFO - 导入database成功
2025-04-04 08:57:34,448 - app.main - INFO - 导入models成功
2025-04-04 08:57:34,448 - app.main - INFO - 导入config成功
2025-04-04 08:57:34,528 - app.main - ERROR - 导入模块时出错: cannot import name 'flow_router' from 'backend.app.routers' (/workspace/backend/app/routers/__init__.py)
2025-04-04 08:57:51,042 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-04 08:57:51,042 - app.main - INFO - 开始导入模块...
2025-04-04 08:57:51,042 - app.main - INFO - 导入database成功
2025-04-04 08:57:51,042 - app.main - INFO - 导入models成功
2025-04-04 08:57:51,042 - app.main - INFO - 导入config成功
2025-04-04 08:57:51,126 - app.main - INFO - 导入基本路由成功
2025-04-04 08:57:51,612 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-04 08:57:51,612 - langchain_chat - INFO - LangChain模块配置: DeepSeek模型=deepseek-chat
2025-04-04 08:57:51,612 - langchain_chat - INFO - 向量存储设置: 类型=chroma, 路径=backend/langchainchat/vector_store
2025-04-04 08:57:51,612 - langchain_chat - INFO - 记忆设置: 最大历史长度=10
2025-04-04 08:57:51,617 - langchainchat.utils.translator - INFO - 初始化DeepSeek翻译器
2025-04-04 08:57:51,617 - langchain_chat - INFO - 初始化聊天模型: deepseek-chat
2025-04-04 08:57:51,617 - langchain_chat - INFO - 使用DeepSeek模型
2025-04-04 08:57:51,618 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_API_KEY
2025-04-04 08:57:51,619 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_BASE_URL
2025-04-04 08:57:51,619 - langchain_chat - INFO - API配置验证通过: 
2025-04-04 08:57:51,619 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-04 08:57:51,619 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-04 08:57:51,619 - langchain_chat - INFO - API配置验证通过: 
2025-04-04 08:57:51,619 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-04 08:57:51,619 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-04 08:57:51,650 - langchain_chat - INFO - 已创建API客户端: 基础URL=https://api.deepseek.com/v1
2025-04-04 08:57:51,651 - langchainchat.utils.translator - INFO - 成功初始化DeepSeek翻译器
2025-04-04 08:57:51,656 - app.main - INFO - 导入workflow_router成功
2025-04-04 08:57:51,656 - app.main - INFO - 导入utils成功
2025-04-04 08:57:51,656 - app.main - INFO - 导入dependencies成功
2025-04-04 08:57:51,656 - app.main - INFO - 创建数据库表...
2025-04-04 08:57:51,656 - app.main - INFO - 数据库表创建成功
2025-04-04 08:57:51,656 - app.main - INFO - 初始化FastAPI应用...
2025-04-04 08:57:51,664 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 08:57:51,664 - app.main - INFO - 注册路由...
2025-04-04 08:57:51,669 - app.main - INFO - 注册user路由成功
2025-04-04 08:57:51,673 - app.main - INFO - 注册flow路由成功
2025-04-04 08:57:51,674 - app.main - INFO - 注册email路由成功
2025-04-04 08:57:51,675 - app.main - INFO - 注册auth路由成功
2025-04-04 08:57:51,675 - app.main - INFO - 注册node_templates路由成功
2025-04-04 08:57:51,678 - app.main - INFO - 注册workflow路由成功
2025-04-04 08:57:51,687 - app.main - INFO - 注册flow_variables路由成功
2025-04-04 08:57:51,687 - app.main - INFO - 注册chat路由成功
2025-04-04 08:57:51,687 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-04 08:57:51,728 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-04 08:57:51,728 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-04 08:57:51,728 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-04 08:57:51,728 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-04 08:57:51,728 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-04 08:57:51,728 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-04 08:57:51,728 - backend.deepseek - WARNING - 检测到基础URL已包含/v1路径: https://api.deepseek.com/v1，将使用此路径
2025-04-04 08:57:51,738 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com/v1, API密钥: sk-f***
2025-04-04 08:57:51,738 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
2025-04-04 08:57:51,777 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-04-04 08:57:51,777 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-04 08:57:51,777 - backend.app.startup - INFO - 数据库URL: sqlite:///database/flow_editor.db
2025-04-04 08:57:51,777 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-04 08:57:51,777 - backend.app.startup - INFO - API前缀: /api
2025-04-04 08:57:51,777 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-04 08:58:02,819 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-04 08:58:02,819 - app.main - INFO - 开始导入模块...
2025-04-04 08:58:02,819 - app.main - INFO - 导入database成功
2025-04-04 08:58:02,819 - app.main - INFO - 导入models成功
2025-04-04 08:58:02,819 - app.main - INFO - 导入config成功
2025-04-04 08:58:02,899 - app.main - INFO - 导入基本路由成功
2025-04-04 08:58:03,379 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-04 08:58:03,380 - langchain_chat - INFO - LangChain模块配置: DeepSeek模型=deepseek-chat
2025-04-04 08:58:03,380 - langchain_chat - INFO - 向量存储设置: 类型=chroma, 路径=backend/langchainchat/vector_store
2025-04-04 08:58:03,380 - langchain_chat - INFO - 记忆设置: 最大历史长度=10
2025-04-04 08:58:03,386 - langchainchat.utils.translator - INFO - 初始化DeepSeek翻译器
2025-04-04 08:58:03,386 - langchain_chat - INFO - 初始化聊天模型: deepseek-chat
2025-04-04 08:58:03,386 - langchain_chat - INFO - 使用DeepSeek模型
2025-04-04 08:58:03,388 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_API_KEY
2025-04-04 08:58:03,388 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_BASE_URL
2025-04-04 08:58:03,388 - langchain_chat - INFO - API配置验证通过: 
2025-04-04 08:58:03,388 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-04 08:58:03,388 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-04 08:58:03,388 - langchain_chat - INFO - API配置验证通过: 
2025-04-04 08:58:03,388 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-04 08:58:03,388 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-04 08:58:03,419 - langchain_chat - INFO - 已创建API客户端: 基础URL=https://api.deepseek.com/v1
2025-04-04 08:58:03,419 - langchainchat.utils.translator - INFO - 成功初始化DeepSeek翻译器
2025-04-04 08:58:03,424 - app.main - INFO - 导入workflow_router成功
2025-04-04 08:58:03,424 - app.main - INFO - 导入utils成功
2025-04-04 08:58:03,424 - app.main - INFO - 导入dependencies成功
2025-04-04 08:58:03,424 - app.main - INFO - 创建数据库表...
2025-04-04 08:58:03,425 - app.main - INFO - 数据库表创建成功
2025-04-04 08:58:03,425 - app.main - INFO - 初始化FastAPI应用...
2025-04-04 08:58:03,432 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 08:58:03,432 - app.main - INFO - 注册路由...
2025-04-04 08:58:03,437 - app.main - INFO - 注册user路由成功
2025-04-04 08:58:03,442 - app.main - INFO - 注册flow路由成功
2025-04-04 08:58:03,442 - app.main - INFO - 注册email路由成功
2025-04-04 08:58:03,443 - app.main - INFO - 注册auth路由成功
2025-04-04 08:58:03,443 - app.main - INFO - 注册node_templates路由成功
2025-04-04 08:58:03,445 - app.main - INFO - 注册workflow路由成功
2025-04-04 08:58:03,455 - app.main - INFO - 注册flow_variables路由成功
2025-04-04 08:58:03,455 - app.main - INFO - 注册chat路由成功
2025-04-04 08:58:03,455 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-04 08:58:03,494 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-04 08:58:03,494 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-04 08:58:03,494 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-04 08:58:03,494 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-04 08:58:03,494 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-04 08:58:03,494 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-04 08:58:03,494 - backend.deepseek - WARNING - 检测到基础URL已包含/v1路径: https://api.deepseek.com/v1，将使用此路径
2025-04-04 08:58:03,494 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com/v1, API密钥: sk-f***
2025-04-04 08:58:03,494 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
2025-04-04 08:58:03,525 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-04-04 08:58:03,525 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-04 08:58:03,526 - backend.app.startup - INFO - 数据库URL: sqlite:///database/flow_editor.db
2025-04-04 08:58:03,526 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-04 08:58:03,526 - backend.app.startup - INFO - API前缀: /api
2025-04-04 08:58:03,526 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-04 08:58:10,712 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 08:58:18,558 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 08:58:25,063 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 08:58:46,064 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 08:59:00,338 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 08:59:49,398 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 08:59:49,399 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 08:59:50,782 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-04 08:59:50,792 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-04 08:59:50,832 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 08:59:50,834 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 08:59:50,851 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-04 08:59:50,855 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-04 09:00:01,313 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 09:00:01,315 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 09:00:01,369 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 09:00:01,375 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 09:00:02,546 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-04 09:00:02,551 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-04 09:00:02,587 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 09:00:02,589 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-04 09:00:02,602 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-04 09:00:02,604 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-07 02:35:38,719 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 02:35:38,720 - app.main - INFO - 开始导入模块...
2025-04-07 02:35:38,720 - app.main - INFO - 导入database成功
2025-04-07 02:35:38,720 - app.main - INFO - 导入models成功
2025-04-07 02:35:38,720 - app.main - INFO - 导入config成功
2025-04-07 02:35:38,796 - app.main - INFO - 导入基本路由成功
2025-04-07 02:35:39,253 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-07 02:35:39,253 - langchain_chat - INFO - LangChain模块配置: DeepSeek模型=deepseek-chat
2025-04-07 02:35:39,253 - langchain_chat - INFO - 向量存储设置: 类型=chroma, 路径=backend/langchainchat/vector_store
2025-04-07 02:35:39,253 - langchain_chat - INFO - 记忆设置: 最大历史长度=10
2025-04-07 02:35:39,257 - langchainchat.utils.translator - INFO - 初始化DeepSeek翻译器
2025-04-07 02:35:39,257 - langchain_chat - INFO - 初始化聊天模型: deepseek-chat
2025-04-07 02:35:39,258 - langchain_chat - INFO - 使用DeepSeek模型
2025-04-07 02:35:39,259 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_API_KEY
2025-04-07 02:35:39,259 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_BASE_URL
2025-04-07 02:35:39,259 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 02:35:39,259 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 02:35:39,259 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 02:35:39,259 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 02:35:39,259 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 02:35:39,259 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 02:35:39,290 - langchain_chat - INFO - 已创建API客户端: 基础URL=https://api.deepseek.com/v1
2025-04-07 02:35:39,290 - langchainchat.utils.translator - INFO - 成功初始化DeepSeek翻译器
2025-04-07 02:35:39,295 - app.main - INFO - 导入workflow_router成功
2025-04-07 02:35:39,295 - app.main - INFO - 导入utils成功
2025-04-07 02:35:39,295 - app.main - INFO - 导入dependencies成功
2025-04-07 02:35:39,295 - app.main - INFO - 创建数据库表...
2025-04-07 02:35:39,296 - app.main - INFO - 数据库表创建成功
2025-04-07 02:35:39,296 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 02:35:39,302 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 02:35:39,303 - app.main - INFO - 注册路由...
2025-04-07 02:35:39,309 - app.main - INFO - 注册user路由成功
2025-04-07 02:35:39,313 - app.main - INFO - 注册flow路由成功
2025-04-07 02:35:39,314 - app.main - INFO - 注册email路由成功
2025-04-07 02:35:39,315 - app.main - INFO - 注册auth路由成功
2025-04-07 02:35:39,315 - app.main - INFO - 注册node_templates路由成功
2025-04-07 02:35:39,317 - app.main - INFO - 注册workflow路由成功
2025-04-07 02:35:39,327 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 02:35:39,328 - app.main - INFO - 注册chat路由成功
2025-04-07 02:35:39,328 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 02:35:39,368 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 02:35:39,368 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 02:35:39,368 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 02:35:39,368 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 02:35:39,368 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 02:35:39,368 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 02:35:39,368 - backend.deepseek - WARNING - 检测到基础URL已包含/v1路径: https://api.deepseek.com/v1，将使用此路径
2025-04-07 02:35:39,368 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com/v1, API密钥: sk-f***
2025-04-07 02:35:39,368 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
2025-04-07 02:35:39,404 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-04-07 02:35:39,405 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 02:35:39,405 - backend.app.startup - INFO - 数据库URL: sqlite:///database/flow_editor.db
2025-04-07 02:35:39,405 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 02:35:39,405 - backend.app.startup - INFO - API前缀: /api
2025-04-07 02:35:39,405 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 02:35:47,769 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 02:35:47,772 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 02:35:49,172 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-07 02:35:49,176 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-07 02:35:49,201 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 02:35:49,203 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 02:35:49,214 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-07 02:35:49,217 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-07 02:37:05,210 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 02:37:05,211 - app.main - INFO - 开始导入模块...
2025-04-07 02:37:05,211 - app.main - INFO - 导入database成功
2025-04-07 02:37:05,211 - app.main - INFO - 导入models成功
2025-04-07 02:37:05,211 - app.main - INFO - 导入config成功
2025-04-07 02:37:05,293 - app.main - INFO - 导入基本路由成功
2025-04-07 02:37:05,771 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-07 02:37:05,771 - langchain_chat - INFO - LangChain模块配置: DeepSeek模型=deepseek-chat
2025-04-07 02:37:05,771 - langchain_chat - INFO - 向量存储设置: 类型=chroma, 路径=backend/langchainchat/vector_store
2025-04-07 02:37:05,771 - langchain_chat - INFO - 记忆设置: 最大历史长度=10
2025-04-07 02:37:05,776 - langchainchat.utils.translator - INFO - 初始化DeepSeek翻译器
2025-04-07 02:37:05,776 - langchain_chat - INFO - 初始化聊天模型: deepseek-chat
2025-04-07 02:37:05,776 - langchain_chat - INFO - 使用DeepSeek模型
2025-04-07 02:37:05,778 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_API_KEY
2025-04-07 02:37:05,778 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_BASE_URL
2025-04-07 02:37:05,778 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 02:37:05,778 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 02:37:05,778 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 02:37:05,778 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 02:37:05,778 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 02:37:05,778 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 02:37:05,809 - langchain_chat - INFO - 已创建API客户端: 基础URL=https://api.deepseek.com/v1
2025-04-07 02:37:05,809 - langchainchat.utils.translator - INFO - 成功初始化DeepSeek翻译器
2025-04-07 02:37:05,814 - app.main - INFO - 导入workflow_router成功
2025-04-07 02:37:05,814 - app.main - INFO - 导入utils成功
2025-04-07 02:37:05,814 - app.main - INFO - 导入dependencies成功
2025-04-07 02:37:05,814 - app.main - INFO - 创建数据库表...
2025-04-07 02:37:05,815 - app.main - INFO - 数据库表创建成功
2025-04-07 02:37:05,815 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 02:37:05,821 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 02:37:05,821 - app.main - INFO - 注册路由...
2025-04-07 02:37:05,825 - app.main - INFO - 注册user路由成功
2025-04-07 02:37:05,830 - app.main - INFO - 注册flow路由成功
2025-04-07 02:37:05,830 - app.main - INFO - 注册email路由成功
2025-04-07 02:37:05,831 - app.main - INFO - 注册auth路由成功
2025-04-07 02:37:05,831 - app.main - INFO - 注册node_templates路由成功
2025-04-07 02:37:05,833 - app.main - INFO - 注册workflow路由成功
2025-04-07 02:37:05,842 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 02:37:05,842 - app.main - INFO - 注册chat路由成功
2025-04-07 02:37:05,842 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 02:37:05,877 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 02:37:05,877 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 02:37:05,877 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 02:37:05,877 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 02:37:05,877 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 02:37:05,877 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 02:37:05,877 - backend.deepseek - WARNING - 检测到基础URL已包含/v1路径: https://api.deepseek.com/v1，将使用此路径
2025-04-07 02:37:05,878 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com/v1, API密钥: sk-f***
2025-04-07 02:37:05,878 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
2025-04-07 02:37:05,908 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-04-07 02:37:05,908 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 02:37:05,908 - backend.app.startup - INFO - 数据库URL: sqlite:///database/flow_editor.db
2025-04-07 02:37:05,908 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 02:37:05,909 - backend.app.startup - INFO - API前缀: /api
2025-04-07 02:37:05,909 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 02:37:20,810 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-07 02:37:20,812 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-07 02:37:20,835 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 02:37:20,841 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 02:37:20,853 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-07 02:37:20,855 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-07 04:35:50,573 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-07 04:35:53,621 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-07 04:35:53,624 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-07 04:35:53,647 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 04:35:53,649 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 04:35:53,660 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-07 04:35:53,664 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-07 04:53:44,141 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 04:53:44,141 - app.main - INFO - 开始导入模块...
2025-04-07 04:53:44,141 - app.main - INFO - 导入database成功
2025-04-07 04:53:44,141 - app.main - INFO - 导入models成功
2025-04-07 04:53:44,141 - app.main - INFO - 导入config成功
2025-04-07 04:53:44,219 - app.main - INFO - 导入基本路由成功
2025-04-07 04:53:44,687 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-07 04:53:44,687 - langchain_chat - INFO - LangChain模块配置: DeepSeek模型=deepseek-chat
2025-04-07 04:53:44,688 - langchain_chat - INFO - 向量存储设置: 类型=chroma, 路径=backend/langchainchat/vector_store
2025-04-07 04:53:44,688 - langchain_chat - INFO - 记忆设置: 最大历史长度=10
2025-04-07 04:53:44,692 - langchainchat.utils.translator - INFO - 初始化DeepSeek翻译器
2025-04-07 04:53:44,692 - langchain_chat - INFO - 初始化聊天模型: deepseek-chat
2025-04-07 04:53:44,693 - langchain_chat - INFO - 使用DeepSeek模型
2025-04-07 04:53:44,694 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_API_KEY
2025-04-07 04:53:44,694 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_BASE_URL
2025-04-07 04:53:44,694 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 04:53:44,694 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 04:53:44,694 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 04:53:44,694 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 04:53:44,694 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 04:53:44,694 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 04:53:44,726 - langchain_chat - INFO - 已创建API客户端: 基础URL=https://api.deepseek.com/v1
2025-04-07 04:53:44,726 - langchainchat.utils.translator - INFO - 成功初始化DeepSeek翻译器
2025-04-07 04:53:44,730 - app.main - INFO - 导入workflow_router成功
2025-04-07 04:53:44,731 - app.main - INFO - 导入utils成功
2025-04-07 04:53:44,731 - app.main - INFO - 导入dependencies成功
2025-04-07 04:53:44,731 - app.main - INFO - 创建数据库表...
2025-04-07 04:53:44,731 - app.main - INFO - 数据库表创建成功
2025-04-07 04:53:44,731 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 04:53:44,739 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 04:53:44,739 - app.main - INFO - 注册路由...
2025-04-07 04:53:44,744 - app.main - INFO - 注册user路由成功
2025-04-07 04:53:44,749 - app.main - INFO - 注册flow路由成功
2025-04-07 04:53:44,750 - app.main - INFO - 注册email路由成功
2025-04-07 04:53:44,751 - app.main - INFO - 注册auth路由成功
2025-04-07 04:53:44,751 - app.main - INFO - 注册node_templates路由成功
2025-04-07 04:53:44,754 - app.main - INFO - 注册workflow路由成功
2025-04-07 04:53:44,763 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 04:53:44,763 - app.main - INFO - 注册chat路由成功
2025-04-07 04:53:44,763 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 04:53:44,764 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 04:53:44,764 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 04:53:44,765 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 04:53:44,765 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 04:53:44,765 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 04:53:44,765 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 04:53:44,765 - backend.deepseek - WARNING - 检测到基础URL已包含/v1路径: https://api.deepseek.com/v1，将使用此路径
2025-04-07 04:53:44,765 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com/v1, API密钥: sk-f***
2025-04-07 04:53:44,765 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
2025-04-07 04:53:44,796 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-04-07 04:53:44,796 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 04:53:44,796 - backend.app.startup - INFO - 数据库URL: sqlite:///database/flow_editor.db
2025-04-07 04:53:44,796 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 04:53:44,796 - backend.app.startup - INFO - API前缀: /api
2025-04-07 04:53:44,796 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 04:54:46,449 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 04:54:46,449 - app.main - INFO - 开始导入模块...
2025-04-07 04:54:46,449 - app.main - INFO - 导入database成功
2025-04-07 04:54:46,449 - app.main - INFO - 导入models成功
2025-04-07 04:54:46,449 - app.main - INFO - 导入config成功
2025-04-07 04:54:46,528 - app.main - INFO - 导入基本路由成功
2025-04-07 04:54:47,000 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-07 04:54:47,001 - langchain_chat - INFO - LangChain模块配置: DeepSeek模型=deepseek-chat
2025-04-07 04:54:47,001 - langchain_chat - INFO - 向量存储设置: 类型=chroma, 路径=backend/langchainchat/vector_store
2025-04-07 04:54:47,001 - langchain_chat - INFO - 记忆设置: 最大历史长度=10
2025-04-07 04:54:47,006 - langchainchat.utils.translator - INFO - 初始化DeepSeek翻译器
2025-04-07 04:54:47,006 - langchain_chat - INFO - 初始化聊天模型: deepseek-chat
2025-04-07 04:54:47,006 - langchain_chat - INFO - 使用DeepSeek模型
2025-04-07 04:54:47,007 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_API_KEY
2025-04-07 04:54:47,007 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_BASE_URL
2025-04-07 04:54:47,007 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 04:54:47,007 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 04:54:47,007 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 04:54:47,008 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 04:54:47,008 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 04:54:47,008 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 04:54:47,038 - langchain_chat - INFO - 已创建API客户端: 基础URL=https://api.deepseek.com/v1
2025-04-07 04:54:47,039 - langchainchat.utils.translator - INFO - 成功初始化DeepSeek翻译器
2025-04-07 04:54:47,043 - app.main - INFO - 导入workflow_router成功
2025-04-07 04:54:47,043 - app.main - INFO - 导入utils成功
2025-04-07 04:54:47,043 - app.main - INFO - 导入dependencies成功
2025-04-07 04:54:47,043 - app.main - INFO - 创建数据库表...
2025-04-07 04:54:47,044 - app.main - INFO - 数据库表创建成功
2025-04-07 04:54:47,044 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 04:54:47,050 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 04:54:47,051 - app.main - INFO - 注册路由...
2025-04-07 04:54:47,055 - app.main - INFO - 注册user路由成功
2025-04-07 04:54:47,060 - app.main - INFO - 注册flow路由成功
2025-04-07 04:54:47,060 - app.main - INFO - 注册email路由成功
2025-04-07 04:54:47,061 - app.main - INFO - 注册auth路由成功
2025-04-07 04:54:47,061 - app.main - INFO - 注册node_templates路由成功
2025-04-07 04:54:47,063 - app.main - INFO - 注册workflow路由成功
2025-04-07 04:54:47,072 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 04:54:47,072 - app.main - INFO - 注册chat路由成功
2025-04-07 04:54:47,072 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 04:54:47,073 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 04:54:47,073 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 04:54:47,073 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 04:54:47,073 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 04:54:47,073 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 04:54:47,073 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 04:54:47,074 - backend.deepseek - WARNING - 检测到基础URL已包含/v1路径: https://api.deepseek.com/v1，将使用此路径
2025-04-07 04:54:47,074 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com/v1, API密钥: sk-f***
2025-04-07 04:54:47,074 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
2025-04-07 04:54:47,105 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-04-07 04:54:47,105 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 04:54:47,105 - backend.app.startup - INFO - 数据库URL: sqlite:///database/flow_editor.db
2025-04-07 04:54:47,105 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 04:54:47,105 - backend.app.startup - INFO - API前缀: /api
2025-04-07 04:54:47,105 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 04:55:03,113 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 04:55:03,114 - app.main - INFO - 开始导入模块...
2025-04-07 04:55:03,114 - app.main - INFO - 导入database成功
2025-04-07 04:55:03,114 - app.main - INFO - 导入models成功
2025-04-07 04:55:03,114 - app.main - INFO - 导入config成功
2025-04-07 04:55:03,193 - app.main - INFO - 导入基本路由成功
2025-04-07 04:55:03,661 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-07 04:55:03,661 - langchain_chat - INFO - LangChain模块配置: DeepSeek模型=deepseek-chat
2025-04-07 04:55:03,661 - langchain_chat - INFO - 向量存储设置: 类型=chroma, 路径=backend/langchainchat/vector_store
2025-04-07 04:55:03,661 - langchain_chat - INFO - 记忆设置: 最大历史长度=10
2025-04-07 04:55:03,666 - langchainchat.utils.translator - INFO - 初始化DeepSeek翻译器
2025-04-07 04:55:03,666 - langchain_chat - INFO - 初始化聊天模型: deepseek-chat
2025-04-07 04:55:03,666 - langchain_chat - INFO - 使用DeepSeek模型
2025-04-07 04:55:03,667 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_API_KEY
2025-04-07 04:55:03,667 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_BASE_URL
2025-04-07 04:55:03,667 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 04:55:03,668 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 04:55:03,668 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 04:55:03,668 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 04:55:03,668 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 04:55:03,668 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 04:55:03,699 - langchain_chat - INFO - 已创建API客户端: 基础URL=https://api.deepseek.com/v1
2025-04-07 04:55:03,699 - langchainchat.utils.translator - INFO - 成功初始化DeepSeek翻译器
2025-04-07 04:55:03,704 - app.main - INFO - 导入workflow_router成功
2025-04-07 04:55:03,704 - app.main - INFO - 导入utils成功
2025-04-07 04:55:03,704 - app.main - INFO - 导入dependencies成功
2025-04-07 04:55:03,704 - app.main - INFO - 创建数据库表...
2025-04-07 04:55:03,704 - app.main - INFO - 数据库表创建成功
2025-04-07 04:55:03,705 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 04:55:03,711 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 04:55:03,712 - app.main - INFO - 注册路由...
2025-04-07 04:55:03,716 - app.main - INFO - 注册user路由成功
2025-04-07 04:55:03,721 - app.main - INFO - 注册flow路由成功
2025-04-07 04:55:03,721 - app.main - INFO - 注册email路由成功
2025-04-07 04:55:03,722 - app.main - INFO - 注册auth路由成功
2025-04-07 04:55:03,723 - app.main - INFO - 注册node_templates路由成功
2025-04-07 04:55:03,725 - app.main - INFO - 注册workflow路由成功
2025-04-07 04:55:03,734 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 04:55:03,734 - app.main - INFO - 注册chat路由成功
2025-04-07 04:55:03,734 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 04:55:03,735 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 04:55:03,735 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 04:55:03,735 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 04:55:03,735 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 04:55:03,735 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 04:55:03,735 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 04:55:03,735 - backend.deepseek - WARNING - 检测到基础URL已包含/v1路径: https://api.deepseek.com/v1，将使用此路径
2025-04-07 04:55:03,735 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com/v1, API密钥: sk-f***
2025-04-07 04:55:03,735 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
2025-04-07 04:55:03,766 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-04-07 04:55:03,767 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 04:55:03,767 - backend.app.startup - INFO - 数据库URL: sqlite:///database/flow_editor.db
2025-04-07 04:55:03,767 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 04:55:03,767 - backend.app.startup - INFO - API前缀: /api
2025-04-07 04:55:03,767 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 05:05:52,375 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 05:05:52,375 - app.main - INFO - 开始导入模块...
2025-04-07 05:05:52,375 - app.main - INFO - 导入database成功
2025-04-07 05:05:52,375 - app.main - INFO - 导入models成功
2025-04-07 05:05:52,375 - app.main - INFO - 导入config成功
2025-04-07 05:05:52,463 - app.main - INFO - 导入基本路由成功
2025-04-07 05:05:52,979 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-07 05:05:52,979 - langchain_chat - INFO - LangChain模块配置: DeepSeek模型=deepseek-chat
2025-04-07 05:05:52,979 - langchain_chat - INFO - 向量存储设置: 类型=chroma, 路径=backend/langchainchat/vector_store
2025-04-07 05:05:52,979 - langchain_chat - INFO - 记忆设置: 最大历史长度=10
2025-04-07 05:05:52,985 - langchainchat.utils.translator - INFO - 初始化DeepSeek翻译器
2025-04-07 05:05:52,985 - langchain_chat - INFO - 初始化聊天模型: deepseek-chat
2025-04-07 05:05:52,985 - langchain_chat - INFO - 使用DeepSeek模型
2025-04-07 05:05:52,987 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_API_KEY
2025-04-07 05:05:52,987 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_BASE_URL
2025-04-07 05:05:52,987 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 05:05:52,987 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 05:05:52,987 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 05:05:52,987 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 05:05:52,987 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 05:05:52,987 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 05:05:53,020 - langchain_chat - INFO - 已创建API客户端: 基础URL=https://api.deepseek.com/v1
2025-04-07 05:05:53,020 - langchainchat.utils.translator - INFO - 成功初始化DeepSeek翻译器
2025-04-07 05:05:53,026 - app.main - INFO - 导入workflow_router成功
2025-04-07 05:05:53,026 - app.main - INFO - 导入utils成功
2025-04-07 05:05:53,026 - app.main - INFO - 导入dependencies成功
2025-04-07 05:05:53,027 - app.main - INFO - 创建数据库表...
2025-04-07 05:05:53,027 - app.main - INFO - 数据库表创建成功
2025-04-07 05:05:53,027 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 05:05:53,036 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 05:05:53,037 - app.main - INFO - 注册路由...
2025-04-07 05:05:53,041 - app.main - INFO - 注册user路由成功
2025-04-07 05:05:53,046 - app.main - INFO - 注册flow路由成功
2025-04-07 05:05:53,046 - app.main - INFO - 注册email路由成功
2025-04-07 05:05:53,047 - app.main - INFO - 注册auth路由成功
2025-04-07 05:05:53,047 - app.main - INFO - 注册node_templates路由成功
2025-04-07 05:05:53,050 - app.main - INFO - 注册workflow路由成功
2025-04-07 05:05:53,060 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 05:05:53,060 - app.main - INFO - 注册chat路由成功
2025-04-07 05:05:53,060 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 05:05:53,061 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 05:05:53,061 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 05:05:53,061 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 05:05:53,061 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 05:05:53,061 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 05:05:53,061 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 05:05:53,061 - backend.deepseek - WARNING - 检测到基础URL已包含/v1路径: https://api.deepseek.com/v1，将使用此路径
2025-04-07 05:05:53,061 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com/v1, API密钥: sk-f***
2025-04-07 05:05:53,061 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
2025-04-07 05:05:53,093 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-04-07 05:05:53,093 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 05:05:53,093 - backend.app.startup - INFO - 数据库URL: sqlite:///database/flow_editor.db
2025-04-07 05:05:53,093 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 05:05:53,093 - backend.app.startup - INFO - API前缀: /api
2025-04-07 05:05:53,093 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 05:06:06,856 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 05:06:06,857 - app.main - INFO - 开始导入模块...
2025-04-07 05:06:06,857 - app.main - INFO - 导入database成功
2025-04-07 05:06:06,857 - app.main - INFO - 导入models成功
2025-04-07 05:06:06,857 - app.main - INFO - 导入config成功
2025-04-07 05:06:06,941 - app.main - INFO - 导入基本路由成功
2025-04-07 05:06:07,441 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-07 05:06:07,442 - langchain_chat - INFO - LangChain模块配置: DeepSeek模型=deepseek-chat
2025-04-07 05:06:07,442 - langchain_chat - INFO - 向量存储设置: 类型=chroma, 路径=backend/langchainchat/vector_store
2025-04-07 05:06:07,442 - langchain_chat - INFO - 记忆设置: 最大历史长度=10
2025-04-07 05:06:07,447 - langchainchat.utils.translator - INFO - 初始化DeepSeek翻译器
2025-04-07 05:06:07,447 - langchain_chat - INFO - 初始化聊天模型: deepseek-chat
2025-04-07 05:06:07,447 - langchain_chat - INFO - 使用DeepSeek模型
2025-04-07 05:06:07,449 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_API_KEY
2025-04-07 05:06:07,449 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_BASE_URL
2025-04-07 05:06:07,449 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 05:06:07,449 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:07,449 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 05:06:07,449 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 05:06:07,449 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:07,449 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 05:06:07,480 - langchain_chat - INFO - 已创建API客户端: 基础URL=https://api.deepseek.com/v1
2025-04-07 05:06:07,481 - langchainchat.utils.translator - INFO - 成功初始化DeepSeek翻译器
2025-04-07 05:06:07,485 - app.main - INFO - 导入workflow_router成功
2025-04-07 05:06:07,485 - app.main - INFO - 导入utils成功
2025-04-07 05:06:07,485 - app.main - INFO - 导入dependencies成功
2025-04-07 05:06:07,486 - app.main - INFO - 创建数据库表...
2025-04-07 05:06:07,486 - app.main - INFO - 数据库表创建成功
2025-04-07 05:06:07,486 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 05:06:07,493 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 05:06:07,493 - app.main - INFO - 注册路由...
2025-04-07 05:06:07,498 - app.main - INFO - 注册user路由成功
2025-04-07 05:06:07,502 - app.main - INFO - 注册flow路由成功
2025-04-07 05:06:07,503 - app.main - INFO - 注册email路由成功
2025-04-07 05:06:07,503 - app.main - INFO - 注册auth路由成功
2025-04-07 05:06:07,504 - app.main - INFO - 注册node_templates路由成功
2025-04-07 05:06:07,506 - app.main - INFO - 注册workflow路由成功
2025-04-07 05:06:07,515 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 05:06:07,515 - app.main - INFO - 注册chat路由成功
2025-04-07 05:06:07,515 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 05:06:07,516 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 05:06:07,516 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 05:06:07,516 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:07,516 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 05:06:07,516 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 05:06:07,516 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 05:06:07,517 - backend.deepseek - WARNING - 检测到基础URL已包含/v1路径: https://api.deepseek.com/v1，将使用此路径
2025-04-07 05:06:07,517 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com/v1, API密钥: sk-f***
2025-04-07 05:06:07,517 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
2025-04-07 05:06:07,549 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-04-07 05:06:07,549 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 05:06:07,549 - backend.app.startup - INFO - 数据库URL: sqlite:///database/flow_editor.db
2025-04-07 05:06:07,549 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 05:06:07,549 - backend.app.startup - INFO - API前缀: /api
2025-04-07 05:06:07,549 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 05:06:09,241 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 05:06:09,241 - app.main - INFO - 开始导入模块...
2025-04-07 05:06:09,241 - app.main - INFO - 导入database成功
2025-04-07 05:06:09,241 - app.main - INFO - 导入models成功
2025-04-07 05:06:09,241 - app.main - INFO - 导入config成功
2025-04-07 05:06:09,322 - app.main - INFO - 导入基本路由成功
2025-04-07 05:06:09,797 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-07 05:06:09,797 - langchain_chat - INFO - LangChain模块配置: DeepSeek模型=deepseek-chat
2025-04-07 05:06:09,797 - langchain_chat - INFO - 向量存储设置: 类型=chroma, 路径=backend/langchainchat/vector_store
2025-04-07 05:06:09,797 - langchain_chat - INFO - 记忆设置: 最大历史长度=10
2025-04-07 05:06:09,802 - langchainchat.utils.translator - INFO - 初始化DeepSeek翻译器
2025-04-07 05:06:09,802 - langchain_chat - INFO - 初始化聊天模型: deepseek-chat
2025-04-07 05:06:09,802 - langchain_chat - INFO - 使用DeepSeek模型
2025-04-07 05:06:09,804 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_API_KEY
2025-04-07 05:06:09,804 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_BASE_URL
2025-04-07 05:06:09,804 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 05:06:09,804 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:09,804 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 05:06:09,804 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 05:06:09,804 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:09,804 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 05:06:09,836 - langchain_chat - INFO - 已创建API客户端: 基础URL=https://api.deepseek.com/v1
2025-04-07 05:06:09,836 - langchainchat.utils.translator - INFO - 成功初始化DeepSeek翻译器
2025-04-07 05:06:09,840 - app.main - INFO - 导入workflow_router成功
2025-04-07 05:06:09,840 - app.main - INFO - 导入utils成功
2025-04-07 05:06:09,840 - app.main - INFO - 导入dependencies成功
2025-04-07 05:06:09,840 - app.main - INFO - 创建数据库表...
2025-04-07 05:06:09,841 - app.main - INFO - 数据库表创建成功
2025-04-07 05:06:09,841 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 05:06:09,848 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 05:06:09,848 - app.main - INFO - 注册路由...
2025-04-07 05:06:09,853 - app.main - INFO - 注册user路由成功
2025-04-07 05:06:09,857 - app.main - INFO - 注册flow路由成功
2025-04-07 05:06:09,858 - app.main - INFO - 注册email路由成功
2025-04-07 05:06:09,858 - app.main - INFO - 注册auth路由成功
2025-04-07 05:06:09,859 - app.main - INFO - 注册node_templates路由成功
2025-04-07 05:06:09,861 - app.main - INFO - 注册workflow路由成功
2025-04-07 05:06:09,870 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 05:06:09,870 - app.main - INFO - 注册chat路由成功
2025-04-07 05:06:09,870 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 05:06:09,872 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 05:06:09,872 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 05:06:09,872 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:09,872 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 05:06:09,872 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 05:06:09,872 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 05:06:09,872 - backend.deepseek - WARNING - 检测到基础URL已包含/v1路径: https://api.deepseek.com/v1，将使用此路径
2025-04-07 05:06:09,872 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com/v1, API密钥: sk-f***
2025-04-07 05:06:09,872 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
2025-04-07 05:06:09,903 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-04-07 05:06:09,904 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 05:06:09,904 - backend.app.startup - INFO - 数据库URL: sqlite:///database/flow_editor.db
2025-04-07 05:06:09,904 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 05:06:09,904 - backend.app.startup - INFO - API前缀: /api
2025-04-07 05:06:09,904 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 05:06:21,619 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 05:06:21,619 - app.main - INFO - 开始导入模块...
2025-04-07 05:06:21,619 - app.main - INFO - 导入database成功
2025-04-07 05:06:21,619 - app.main - INFO - 导入models成功
2025-04-07 05:06:21,619 - app.main - INFO - 导入config成功
2025-04-07 05:06:21,697 - app.main - INFO - 导入基本路由成功
2025-04-07 05:06:22,167 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-07 05:06:22,167 - langchain_chat - INFO - LangChain模块配置: DeepSeek模型=deepseek-chat
2025-04-07 05:06:22,167 - langchain_chat - INFO - 向量存储设置: 类型=chroma, 路径=backend/langchainchat/vector_store
2025-04-07 05:06:22,167 - langchain_chat - INFO - 记忆设置: 最大历史长度=10
2025-04-07 05:06:22,172 - langchainchat.utils.translator - INFO - 初始化DeepSeek翻译器
2025-04-07 05:06:22,172 - langchain_chat - INFO - 初始化聊天模型: deepseek-chat
2025-04-07 05:06:22,172 - langchain_chat - INFO - 使用DeepSeek模型
2025-04-07 05:06:22,174 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_API_KEY
2025-04-07 05:06:22,174 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_BASE_URL
2025-04-07 05:06:22,174 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 05:06:22,174 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:22,174 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 05:06:22,174 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 05:06:22,174 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:22,174 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 05:06:22,205 - langchain_chat - INFO - 已创建API客户端: 基础URL=https://api.deepseek.com/v1
2025-04-07 05:06:22,206 - langchainchat.utils.translator - INFO - 成功初始化DeepSeek翻译器
2025-04-07 05:06:22,210 - app.main - INFO - 导入workflow_router成功
2025-04-07 05:06:22,210 - app.main - INFO - 导入utils成功
2025-04-07 05:06:22,210 - app.main - INFO - 导入dependencies成功
2025-04-07 05:06:22,210 - app.main - INFO - 创建数据库表...
2025-04-07 05:06:22,211 - app.main - INFO - 数据库表创建成功
2025-04-07 05:06:22,211 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 05:06:22,218 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 05:06:22,218 - app.main - INFO - 注册路由...
2025-04-07 05:06:22,222 - app.main - INFO - 注册user路由成功
2025-04-07 05:06:22,227 - app.main - INFO - 注册flow路由成功
2025-04-07 05:06:22,227 - app.main - INFO - 注册email路由成功
2025-04-07 05:06:22,228 - app.main - INFO - 注册auth路由成功
2025-04-07 05:06:22,228 - app.main - INFO - 注册node_templates路由成功
2025-04-07 05:06:22,230 - app.main - INFO - 注册workflow路由成功
2025-04-07 05:06:22,239 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 05:06:22,239 - app.main - INFO - 注册chat路由成功
2025-04-07 05:06:22,239 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 05:06:22,240 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 05:06:22,240 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 05:06:22,240 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:22,240 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 05:06:22,240 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 05:06:22,240 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 05:06:22,241 - backend.deepseek - WARNING - 检测到基础URL已包含/v1路径: https://api.deepseek.com/v1，将使用此路径
2025-04-07 05:06:22,241 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com/v1, API密钥: sk-f***
2025-04-07 05:06:22,241 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
2025-04-07 05:06:22,272 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-04-07 05:06:22,272 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 05:06:22,273 - backend.app.startup - INFO - 数据库URL: sqlite:///database/flow_editor.db
2025-04-07 05:06:22,273 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 05:06:22,273 - backend.app.startup - INFO - API前缀: /api
2025-04-07 05:06:22,273 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 05:06:30,158 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 05:06:30,158 - app.main - INFO - 开始导入模块...
2025-04-07 05:06:30,158 - app.main - INFO - 导入database成功
2025-04-07 05:06:30,158 - app.main - INFO - 导入models成功
2025-04-07 05:06:30,158 - app.main - INFO - 导入config成功
2025-04-07 05:06:30,235 - app.main - INFO - 导入基本路由成功
2025-04-07 05:06:30,703 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-07 05:06:30,703 - langchain_chat - INFO - LangChain模块配置: DeepSeek模型=deepseek-chat
2025-04-07 05:06:30,703 - langchain_chat - INFO - 向量存储设置: 类型=chroma, 路径=backend/langchainchat/vector_store
2025-04-07 05:06:30,703 - langchain_chat - INFO - 记忆设置: 最大历史长度=10
2025-04-07 05:06:30,710 - langchainchat.utils.translator - INFO - 初始化DeepSeek翻译器
2025-04-07 05:06:30,710 - langchain_chat - INFO - 初始化聊天模型: deepseek-chat
2025-04-07 05:06:30,710 - langchain_chat - INFO - 使用DeepSeek模型
2025-04-07 05:06:30,711 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_API_KEY
2025-04-07 05:06:30,711 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_BASE_URL
2025-04-07 05:06:30,711 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 05:06:30,712 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:30,712 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 05:06:30,712 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 05:06:30,712 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:30,712 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 05:06:30,744 - langchain_chat - INFO - 已创建API客户端: 基础URL=https://api.deepseek.com/v1
2025-04-07 05:06:30,744 - langchainchat.utils.translator - INFO - 成功初始化DeepSeek翻译器
2025-04-07 05:06:30,749 - app.main - INFO - 导入workflow_router成功
2025-04-07 05:06:30,749 - app.main - INFO - 导入utils成功
2025-04-07 05:06:30,749 - app.main - INFO - 导入dependencies成功
2025-04-07 05:06:30,749 - app.main - INFO - 创建数据库表...
2025-04-07 05:06:30,749 - app.main - INFO - 数据库表创建成功
2025-04-07 05:06:30,749 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 05:06:30,756 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 05:06:30,757 - app.main - INFO - 注册路由...
2025-04-07 05:06:30,762 - app.main - INFO - 注册user路由成功
2025-04-07 05:06:30,766 - app.main - INFO - 注册flow路由成功
2025-04-07 05:06:30,767 - app.main - INFO - 注册email路由成功
2025-04-07 05:06:30,767 - app.main - INFO - 注册auth路由成功
2025-04-07 05:06:30,767 - app.main - INFO - 注册node_templates路由成功
2025-04-07 05:06:30,770 - app.main - INFO - 注册workflow路由成功
2025-04-07 05:06:30,779 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 05:06:30,779 - app.main - INFO - 注册chat路由成功
2025-04-07 05:06:30,780 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 05:06:30,781 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 05:06:30,781 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 05:06:30,781 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:30,781 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 05:06:30,781 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 05:06:30,781 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 05:06:30,781 - backend.deepseek - WARNING - 检测到基础URL已包含/v1路径: https://api.deepseek.com/v1，将使用此路径
2025-04-07 05:06:30,781 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com/v1, API密钥: sk-f***
2025-04-07 05:06:30,781 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
2025-04-07 05:06:30,813 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-04-07 05:06:30,813 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 05:06:30,813 - backend.app.startup - INFO - 数据库URL: sqlite:///database/flow_editor.db
2025-04-07 05:06:30,813 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 05:06:30,813 - backend.app.startup - INFO - API前缀: /api
2025-04-07 05:06:30,813 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 05:06:45,285 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 05:06:45,285 - app.main - INFO - 开始导入模块...
2025-04-07 05:06:45,285 - app.main - INFO - 导入database成功
2025-04-07 05:06:45,285 - app.main - INFO - 导入models成功
2025-04-07 05:06:45,285 - app.main - INFO - 导入config成功
2025-04-07 05:06:45,364 - app.main - INFO - 导入基本路由成功
2025-04-07 05:06:45,842 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-07 05:06:45,842 - langchain_chat - INFO - LangChain模块配置: DeepSeek模型=deepseek-chat
2025-04-07 05:06:45,842 - langchain_chat - INFO - 向量存储设置: 类型=chroma, 路径=backend/langchainchat/vector_store
2025-04-07 05:06:45,842 - langchain_chat - INFO - 记忆设置: 最大历史长度=10
2025-04-07 05:06:45,847 - langchainchat.utils.translator - INFO - 初始化DeepSeek翻译器
2025-04-07 05:06:45,847 - langchain_chat - INFO - 初始化聊天模型: deepseek-chat
2025-04-07 05:06:45,847 - langchain_chat - INFO - 使用DeepSeek模型
2025-04-07 05:06:45,849 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_API_KEY
2025-04-07 05:06:45,849 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_BASE_URL
2025-04-07 05:06:45,849 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 05:06:45,849 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:45,849 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 05:06:45,849 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 05:06:45,849 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:45,849 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 05:06:45,880 - langchain_chat - INFO - 已创建API客户端: 基础URL=https://api.deepseek.com/v1
2025-04-07 05:06:45,880 - langchainchat.utils.translator - INFO - 成功初始化DeepSeek翻译器
2025-04-07 05:06:45,885 - app.main - INFO - 导入workflow_router成功
2025-04-07 05:06:45,885 - app.main - INFO - 导入utils成功
2025-04-07 05:06:45,885 - app.main - INFO - 导入dependencies成功
2025-04-07 05:06:45,885 - app.main - INFO - 创建数据库表...
2025-04-07 05:06:45,885 - app.main - INFO - 数据库表创建成功
2025-04-07 05:06:45,885 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 05:06:45,892 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 05:06:45,892 - app.main - INFO - 注册路由...
2025-04-07 05:06:45,897 - app.main - INFO - 注册user路由成功
2025-04-07 05:06:45,901 - app.main - INFO - 注册flow路由成功
2025-04-07 05:06:45,902 - app.main - INFO - 注册email路由成功
2025-04-07 05:06:45,902 - app.main - INFO - 注册auth路由成功
2025-04-07 05:06:45,903 - app.main - INFO - 注册node_templates路由成功
2025-04-07 05:06:45,905 - app.main - INFO - 注册workflow路由成功
2025-04-07 05:06:45,913 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 05:06:45,913 - app.main - INFO - 注册chat路由成功
2025-04-07 05:06:45,913 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 05:06:45,914 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 05:06:45,914 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 05:06:45,914 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 05:06:45,915 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 05:06:45,915 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 05:06:45,915 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 05:06:45,915 - backend.deepseek - WARNING - 检测到基础URL已包含/v1路径: https://api.deepseek.com/v1，将使用此路径
2025-04-07 05:06:45,915 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com/v1, API密钥: sk-f***
2025-04-07 05:06:45,915 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
2025-04-07 05:06:45,946 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-04-07 05:06:45,946 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 05:06:45,946 - backend.app.startup - INFO - 数据库URL: sqlite:///database/flow_editor.db
2025-04-07 05:06:45,946 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 05:06:45,946 - backend.app.startup - INFO - API前缀: /api
2025-04-07 05:06:45,946 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 05:07:00,260 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 05:07:00,261 - app.main - INFO - 开始导入模块...
2025-04-07 05:07:00,261 - app.main - INFO - 导入database成功
2025-04-07 05:07:00,261 - app.main - INFO - 导入models成功
2025-04-07 05:07:00,261 - app.main - INFO - 导入config成功
2025-04-07 05:07:00,342 - app.main - INFO - 导入基本路由成功
2025-04-07 05:07:00,828 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-07 05:07:00,828 - langchain_chat - INFO - LangChain模块配置: DeepSeek模型=deepseek-chat
2025-04-07 05:07:00,828 - langchain_chat - INFO - 向量存储设置: 类型=chroma, 路径=backend/langchainchat/vector_store
2025-04-07 05:07:00,828 - langchain_chat - INFO - 记忆设置: 最大历史长度=10
2025-04-07 05:07:00,833 - langchainchat.utils.translator - INFO - 初始化DeepSeek翻译器
2025-04-07 05:07:00,833 - langchain_chat - INFO - 初始化聊天模型: deepseek-chat
2025-04-07 05:07:00,833 - langchain_chat - INFO - 使用DeepSeek模型
2025-04-07 05:07:00,834 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_API_KEY
2025-04-07 05:07:00,834 - langchain_chat - INFO - 从环境变量读取DEEPSEEK_BASE_URL
2025-04-07 05:07:00,834 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 05:07:00,834 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 05:07:00,834 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 05:07:00,834 - langchain_chat - INFO - API配置验证通过: 
2025-04-07 05:07:00,835 - langchain_chat - INFO - - 基础URL: https://api.deepseek.com/v1
2025-04-07 05:07:00,835 - langchain_chat - INFO - - API密钥: sk-fa08f...3fa5 (长度: 35字符)
2025-04-07 05:07:00,865 - langchain_chat - INFO - 已创建API客户端: 基础URL=https://api.deepseek.com/v1
2025-04-07 05:07:00,866 - langchainchat.utils.translator - INFO - 成功初始化DeepSeek翻译器
2025-04-07 05:07:00,870 - app.main - INFO - 导入workflow_router成功
2025-04-07 05:07:00,870 - app.main - INFO - 导入utils成功
2025-04-07 05:07:00,870 - app.main - INFO - 导入dependencies成功
2025-04-07 05:07:00,870 - app.main - INFO - 创建数据库表...
2025-04-07 05:07:00,871 - app.main - INFO - 数据库表创建成功
2025-04-07 05:07:00,871 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 05:07:00,877 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 05:07:00,878 - app.main - INFO - 注册路由...
2025-04-07 05:07:00,882 - app.main - INFO - 注册user路由成功
2025-04-07 05:07:00,887 - app.main - INFO - 注册flow路由成功
2025-04-07 05:07:00,887 - app.main - INFO - 注册email路由成功
2025-04-07 05:07:00,888 - app.main - INFO - 注册auth路由成功
2025-04-07 05:07:00,888 - app.main - INFO - 注册node_templates路由成功
2025-04-07 05:07:00,890 - app.main - INFO - 注册workflow路由成功
2025-04-07 05:07:00,899 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 05:07:00,899 - app.main - INFO - 注册chat路由成功
2025-04-07 05:07:00,899 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 05:07:00,900 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 05:07:00,900 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 05:07:00,900 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 05:07:00,900 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 05:07:00,900 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 05:07:00,900 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 05:07:00,901 - backend.deepseek - WARNING - 检测到基础URL已包含/v1路径: https://api.deepseek.com/v1，将使用此路径
2025-04-07 05:07:00,901 - backend.deepseek - INFO - 初始化DeepSeek客户端，模型: deepseek-chat, 基础URL: https://api.deepseek.com/v1, API密钥: sk-f***
2025-04-07 05:07:00,901 - backend.deepseek - INFO - 环境变量配置: DEEPSEEK_MODEL=deepseek-chat, DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
2025-04-07 05:07:00,931 - backend.deepseek - INFO - DeepSeek客户端初始化成功
2025-04-07 05:07:00,932 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 05:07:00,932 - backend.app.startup - INFO - 数据库URL: sqlite:///database/flow_editor.db
2025-04-07 05:07:00,932 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 05:07:00,932 - backend.app.startup - INFO - API前缀: /api
2025-04-07 05:07:00,932 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 07:05:00,739 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 07:05:00,739 - app.main - INFO - 开始导入模块...
2025-04-07 07:05:00,739 - app.main - INFO - 导入database成功
2025-04-07 07:05:00,739 - app.main - INFO - 导入models成功
2025-04-07 07:05:00,739 - app.main - INFO - 导入config成功
2025-04-07 07:05:00,821 - app.main - INFO - 导入基本路由成功
2025-04-07 07:05:01,292 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-07 07:05:01,292 - app.main - INFO - 导入utils成功
2025-04-07 07:05:01,292 - app.main - INFO - 导入dependencies成功
2025-04-07 07:05:01,292 - app.main - INFO - 创建数据库表...
2025-04-07 07:05:01,293 - app.main - INFO - 数据库表创建成功
2025-04-07 07:05:01,293 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 07:05:01,300 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 07:05:01,300 - app.main - INFO - 注册路由...
2025-04-07 07:05:01,304 - app.main - INFO - 注册user路由成功
2025-04-07 07:05:01,309 - app.main - INFO - 注册flow路由成功
2025-04-07 07:05:01,309 - app.main - INFO - 注册email路由成功
2025-04-07 07:05:01,310 - app.main - INFO - 注册auth路由成功
2025-04-07 07:05:01,310 - app.main - INFO - 注册node_templates路由成功
2025-04-07 07:05:01,310 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-07 07:05:01,319 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 07:05:01,320 - app.main - INFO - 注册chat路由成功
2025-04-07 07:05:01,320 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 07:05:01,321 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 07:05:01,321 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 07:05:01,321 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 07:05:01,321 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 07:05:01,321 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 07:05:01,321 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 07:05:01,321 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-07 07:05:01,353 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 07:05:01,353 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-07 07:05:01,353 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 07:05:01,353 - backend.app.startup - INFO - API前缀: /api
2025-04-07 07:05:01,353 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 07:05:06,700 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 07:05:06,700 - app.main - INFO - 使用最小模式启动，将跳过某些复杂路由
2025-04-07 07:05:06,700 - app.main - INFO - 开始导入模块...
2025-04-07 07:05:06,700 - app.main - INFO - 导入database成功
2025-04-07 07:05:06,700 - app.main - INFO - 导入models成功
2025-04-07 07:05:06,700 - app.main - INFO - 导入config成功
2025-04-07 07:05:06,776 - app.main - INFO - 导入基本路由成功
2025-04-07 07:05:06,776 - app.main - INFO - 导入utils成功
2025-04-07 07:05:06,776 - app.main - INFO - 导入dependencies成功
2025-04-07 07:05:06,776 - app.main - INFO - 创建数据库表...
2025-04-07 07:05:06,777 - app.main - INFO - 数据库表创建成功
2025-04-07 07:05:06,777 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 07:05:06,783 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 07:05:06,783 - app.main - INFO - 注册路由...
2025-04-07 07:05:06,788 - app.main - INFO - 注册user路由成功
2025-04-07 07:05:06,792 - app.main - INFO - 注册flow路由成功
2025-04-07 07:05:06,793 - app.main - INFO - 注册email路由成功
2025-04-07 07:05:06,793 - app.main - INFO - 注册auth路由成功
2025-04-07 07:05:06,794 - app.main - INFO - 注册node_templates路由成功
2025-04-07 07:05:06,794 - app.main - INFO - 跳过注册workflow路由
2025-04-07 07:05:06,802 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 07:05:06,802 - app.main - INFO - 注册chat路由成功
2025-04-07 07:05:06,802 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 07:05:06,803 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 07:05:06,803 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 07:05:06,803 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 07:05:06,804 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 07:05:06,804 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 07:05:06,804 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 07:05:07,029 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-07 07:05:07,060 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 07:05:07,060 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-07 07:05:07,060 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 07:05:07,060 - backend.app.startup - INFO - API前缀: /api
2025-04-07 07:05:07,061 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 07:06:01,603 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 07:06:01,603 - app.main - INFO - 使用最小模式启动，将跳过某些复杂路由
2025-04-07 07:06:01,603 - app.main - INFO - 开始导入模块...
2025-04-07 07:06:01,603 - app.main - INFO - 导入database成功
2025-04-07 07:06:01,603 - app.main - INFO - 导入models成功
2025-04-07 07:06:01,603 - app.main - INFO - 导入config成功
2025-04-07 07:06:01,680 - app.main - INFO - 导入基本路由成功
2025-04-07 07:06:01,680 - app.main - INFO - 导入utils成功
2025-04-07 07:06:01,680 - app.main - INFO - 导入dependencies成功
2025-04-07 07:06:01,680 - app.main - INFO - 创建数据库表...
2025-04-07 07:06:01,681 - app.main - INFO - 数据库表创建成功
2025-04-07 07:06:01,681 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 07:06:01,687 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 07:06:01,688 - app.main - INFO - 注册路由...
2025-04-07 07:06:01,692 - app.main - INFO - 注册user路由成功
2025-04-07 07:06:01,697 - app.main - INFO - 注册flow路由成功
2025-04-07 07:06:01,697 - app.main - INFO - 注册email路由成功
2025-04-07 07:06:01,698 - app.main - INFO - 注册auth路由成功
2025-04-07 07:06:01,698 - app.main - INFO - 注册node_templates路由成功
2025-04-07 07:06:01,698 - app.main - INFO - 跳过注册workflow路由
2025-04-07 07:06:01,707 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 07:06:01,707 - app.main - INFO - 注册chat路由成功
2025-04-07 07:06:01,707 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 07:06:01,708 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 07:06:01,708 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 07:06:01,708 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 07:06:01,708 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 07:06:01,708 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 07:06:01,708 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 07:06:01,941 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-07 07:06:01,973 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 07:06:01,973 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-07 07:06:01,973 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 07:06:01,973 - backend.app.startup - INFO - API前缀: /api
2025-04-07 07:06:01,973 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-07 07:07:12,169 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-07 07:07:12,219 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 07:07:12,222 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 07:07:12,238 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-07 07:07:12,240 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-07 07:07:17,832 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-07 07:07:17,834 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-07 07:07:17,857 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 07:07:17,858 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 07:07:17,870 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-07 07:07:17,872 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-07 08:41:02,198 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-07 08:41:02,199 - app.main - INFO - 开始导入模块...
2025-04-07 08:41:02,199 - app.main - INFO - 导入database成功
2025-04-07 08:41:02,199 - app.main - INFO - 导入models成功
2025-04-07 08:41:02,199 - app.main - INFO - 导入config成功
2025-04-07 08:41:02,284 - app.main - INFO - 导入基本路由成功
2025-04-07 08:41:02,788 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-07 08:41:02,788 - app.main - INFO - 导入utils成功
2025-04-07 08:41:02,788 - app.main - INFO - 导入dependencies成功
2025-04-07 08:41:02,788 - app.main - INFO - 创建数据库表...
2025-04-07 08:41:02,788 - app.main - INFO - 数据库表创建成功
2025-04-07 08:41:02,789 - app.main - INFO - 初始化FastAPI应用...
2025-04-07 08:41:02,795 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-07 08:41:02,795 - app.main - INFO - 注册路由...
2025-04-07 08:41:02,800 - app.main - INFO - 注册user路由成功
2025-04-07 08:41:02,804 - app.main - INFO - 注册flow路由成功
2025-04-07 08:41:02,805 - app.main - INFO - 注册email路由成功
2025-04-07 08:41:02,806 - app.main - INFO - 注册auth路由成功
2025-04-07 08:41:02,806 - app.main - INFO - 注册node_templates路由成功
2025-04-07 08:41:02,806 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-07 08:41:02,816 - app.main - INFO - 注册flow_variables路由成功
2025-04-07 08:41:02,816 - app.main - INFO - 注册chat路由成功
2025-04-07 08:41:02,816 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-07 08:41:02,817 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-07 08:41:02,817 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-07 08:41:02,817 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-07 08:41:02,817 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-07 08:41:02,817 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-07 08:41:02,817 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-07 08:41:02,817 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-07 08:41:02,849 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-07 08:41:02,849 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-07 08:41:02,849 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-07 08:41:02,849 - backend.app.startup - INFO - API前缀: /api
2025-04-07 08:41:02,849 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-08 04:55:40,269 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-08 04:55:40,269 - app.main - INFO - 开始导入模块...
2025-04-08 04:55:40,269 - app.main - INFO - 导入database成功
2025-04-08 04:55:40,269 - app.main - INFO - 导入models成功
2025-04-08 04:55:40,269 - app.main - INFO - 导入config成功
2025-04-08 04:55:40,351 - app.main - INFO - 导入基本路由成功
2025-04-08 04:55:40,826 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-08 04:55:40,826 - app.main - INFO - 导入utils成功
2025-04-08 04:55:40,826 - app.main - INFO - 导入dependencies成功
2025-04-08 04:55:40,826 - app.main - INFO - 创建数据库表...
2025-04-08 04:55:40,827 - app.main - INFO - 数据库表创建成功
2025-04-08 04:55:40,827 - app.main - INFO - 初始化FastAPI应用...
2025-04-08 04:55:40,834 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 04:55:40,834 - app.main - INFO - 注册路由...
2025-04-08 04:55:40,839 - app.main - INFO - 注册user路由成功
2025-04-08 04:55:40,843 - app.main - INFO - 注册flow路由成功
2025-04-08 04:55:40,844 - app.main - INFO - 注册email路由成功
2025-04-08 04:55:40,844 - app.main - INFO - 注册auth路由成功
2025-04-08 04:55:40,845 - app.main - INFO - 注册node_templates路由成功
2025-04-08 04:55:40,845 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-08 04:55:40,854 - app.main - INFO - 注册flow_variables路由成功
2025-04-08 04:55:40,854 - app.main - INFO - 注册chat路由成功
2025-04-08 04:55:40,854 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-08 04:55:40,855 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-08 04:55:40,855 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-08 04:55:40,855 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-08 04:55:40,855 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-08 04:55:40,855 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-08 04:55:40,855 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-08 04:55:40,856 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-08 04:55:40,887 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-08 04:55:40,887 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-08 04:55:40,887 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-08 04:55:40,887 - backend.app.startup - INFO - API前缀: /api
2025-04-08 04:55:40,887 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-08 04:55:51,589 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-08 04:55:51,589 - app.main - INFO - 开始导入模块...
2025-04-08 04:55:51,589 - app.main - INFO - 导入database成功
2025-04-08 04:55:51,589 - app.main - INFO - 导入models成功
2025-04-08 04:55:51,589 - app.main - INFO - 导入config成功
2025-04-08 04:55:51,666 - app.main - INFO - 导入基本路由成功
2025-04-08 04:55:52,126 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-08 04:55:52,126 - app.main - INFO - 导入utils成功
2025-04-08 04:55:52,126 - app.main - INFO - 导入dependencies成功
2025-04-08 04:55:52,126 - app.main - INFO - 创建数据库表...
2025-04-08 04:55:52,126 - app.main - INFO - 数据库表创建成功
2025-04-08 04:55:52,126 - app.main - INFO - 初始化FastAPI应用...
2025-04-08 04:55:52,133 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 04:55:52,133 - app.main - INFO - 注册路由...
2025-04-08 04:55:52,138 - app.main - INFO - 注册user路由成功
2025-04-08 04:55:52,142 - app.main - INFO - 注册flow路由成功
2025-04-08 04:55:52,143 - app.main - INFO - 注册email路由成功
2025-04-08 04:55:52,143 - app.main - INFO - 注册auth路由成功
2025-04-08 04:55:52,144 - app.main - INFO - 注册node_templates路由成功
2025-04-08 04:55:52,144 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-08 04:55:52,153 - app.main - INFO - 注册flow_variables路由成功
2025-04-08 04:55:52,153 - app.main - INFO - 注册chat路由成功
2025-04-08 04:55:52,153 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-08 04:55:52,154 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-08 04:55:52,154 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-08 04:55:52,154 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-08 04:55:52,154 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-08 04:55:52,154 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-08 04:55:52,154 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-08 04:55:52,155 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-08 04:55:52,185 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-08 04:55:52,186 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-08 04:55:52,186 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-08 04:55:52,186 - backend.app.startup - INFO - API前缀: /api
2025-04-08 04:55:52,186 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-08 04:55:57,017 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-08 04:55:57,017 - app.main - INFO - 开始导入模块...
2025-04-08 04:55:57,017 - app.main - INFO - 导入database成功
2025-04-08 04:55:57,017 - app.main - INFO - 导入models成功
2025-04-08 04:55:57,017 - app.main - INFO - 导入config成功
2025-04-08 04:55:57,104 - app.main - INFO - 导入基本路由成功
2025-04-08 04:55:57,611 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-08 04:55:57,611 - app.main - INFO - 导入utils成功
2025-04-08 04:55:57,611 - app.main - INFO - 导入dependencies成功
2025-04-08 04:55:57,611 - app.main - INFO - 创建数据库表...
2025-04-08 04:55:57,612 - app.main - INFO - 数据库表创建成功
2025-04-08 04:55:57,612 - app.main - INFO - 初始化FastAPI应用...
2025-04-08 04:55:57,619 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 04:55:57,619 - app.main - INFO - 注册路由...
2025-04-08 04:55:57,624 - app.main - INFO - 注册user路由成功
2025-04-08 04:55:57,628 - app.main - INFO - 注册flow路由成功
2025-04-08 04:55:57,629 - app.main - INFO - 注册email路由成功
2025-04-08 04:55:57,630 - app.main - INFO - 注册auth路由成功
2025-04-08 04:55:57,630 - app.main - INFO - 注册node_templates路由成功
2025-04-08 04:55:57,630 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-08 04:55:57,639 - app.main - INFO - 注册flow_variables路由成功
2025-04-08 04:55:57,640 - app.main - INFO - 注册chat路由成功
2025-04-08 04:55:57,640 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-08 04:55:57,641 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-08 04:55:57,641 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-08 04:55:57,641 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-08 04:55:57,641 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-08 04:55:57,641 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-08 04:55:57,641 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-08 04:55:57,641 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-08 04:55:57,672 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-08 04:55:57,672 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-08 04:55:57,672 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-08 04:55:57,672 - backend.app.startup - INFO - API前缀: /api
2025-04-08 04:55:57,672 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-08 04:56:45,201 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 04:56:45,204 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 04:56:46,318 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 04:56:46,320 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 04:56:46,346 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 04:56:46,348 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 04:56:46,359 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 04:56:46,362 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:03:45,872 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-08 05:03:45,872 - app.main - INFO - 开始导入模块...
2025-04-08 05:03:45,872 - app.main - INFO - 导入database成功
2025-04-08 05:03:45,872 - app.main - INFO - 导入models成功
2025-04-08 05:03:45,872 - app.main - INFO - 导入config成功
2025-04-08 05:03:45,952 - app.main - INFO - 导入基本路由成功
2025-04-08 05:03:46,425 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-08 05:03:46,425 - app.main - INFO - 导入utils成功
2025-04-08 05:03:46,425 - app.main - INFO - 导入dependencies成功
2025-04-08 05:03:46,425 - app.main - INFO - 创建数据库表...
2025-04-08 05:03:46,425 - app.main - INFO - 数据库表创建成功
2025-04-08 05:03:46,426 - app.main - INFO - 初始化FastAPI应用...
2025-04-08 05:03:46,433 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 05:03:46,433 - app.main - INFO - 注册路由...
2025-04-08 05:03:46,437 - app.main - INFO - 注册user路由成功
2025-04-08 05:03:46,442 - app.main - INFO - 注册flow路由成功
2025-04-08 05:03:46,442 - app.main - INFO - 注册email路由成功
2025-04-08 05:03:46,443 - app.main - INFO - 注册auth路由成功
2025-04-08 05:03:46,443 - app.main - INFO - 注册node_templates路由成功
2025-04-08 05:03:46,443 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-08 05:03:46,452 - app.main - INFO - 注册flow_variables路由成功
2025-04-08 05:03:46,452 - app.main - INFO - 注册chat路由成功
2025-04-08 05:03:46,452 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-08 05:03:46,454 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-08 05:03:46,454 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-08 05:03:46,454 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-08 05:03:46,454 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-08 05:03:46,454 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-08 05:03:46,454 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-08 05:03:46,454 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-08 05:03:46,485 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-08 05:03:46,485 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-08 05:03:46,485 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-08 05:03:46,485 - backend.app.startup - INFO - API前缀: /api
2025-04-08 05:03:46,485 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-08 05:18:36,388 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:19:17,478 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 0 个
2025-04-08 05:19:17,481 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 0 个
2025-04-08 05:19:17,487 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 0 个
2025-04-08 05:19:33,547 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 0 个
2025-04-08 05:19:33,557 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 0 个
2025-04-08 05:20:26,333 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 0 个
2025-04-08 05:20:26,336 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 0 个
2025-04-08 05:20:26,340 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 0 个
2025-04-08 05:20:41,845 - backend.app.services.flow_variable_service - INFO - 更新流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:21:04,795 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:21:04,797 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:21:04,801 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:25:28,398 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:25:28,438 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 05:25:28,443 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 05:25:28,456 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:25:28,459 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:25:31,737 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:25:31,738 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:25:31,743 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:34:43,236 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:34:43,239 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:34:43,245 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:34:56,361 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:34:56,368 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:34:56,386 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:34:56,406 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:35:14,522 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 05:35:14,524 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 05:35:14,537 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:35:14,539 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:35:32,719 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 05:35:32,721 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 05:35:32,730 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:35:32,732 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:35:51,051 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 05:35:51,052 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 05:35:51,064 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:35:51,066 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:46:51,844 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:46:51,898 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 05:46:51,902 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 05:46:51,920 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:46:51,925 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:46:53,503 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:46:53,504 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:46:53,508 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:47:14,011 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:47:14,012 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:47:14,018 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:50:45,234 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 05:56:18,613 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:56:18,614 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:56:18,624 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:56:38,360 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:56:38,362 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:56:38,368 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:56:53,931 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:56:53,932 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 05:56:53,939 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:01:34,551 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:01:57,634 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:02:01,629 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:02:01,672 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:02:01,678 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:02:01,695 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:02:01,698 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:02:03,274 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:02:03,276 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:02:03,285 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:02:18,448 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:02:36,832 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:02:36,902 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:02:36,906 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:02:36,931 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:02:36,933 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:02:48,987 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:02:48,988 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:02:49,233 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:02:50,125 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:02:50,127 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:02:50,166 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:02:50,168 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:02:50,182 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:02:50,184 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:02:52,379 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:02:52,381 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:02:52,382 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:04:15,290 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:04:15,292 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:04:15,300 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:04:17,322 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:04:17,359 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:04:17,361 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:04:17,376 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:04:17,379 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:04:18,833 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:04:18,834 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:04:18,843 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:04:32,629 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:04:32,662 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:04:32,664 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:04:32,680 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:04:32,682 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:04:34,107 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:04:34,108 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:04:34,117 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:04:42,628 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:04:42,629 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:04:43,522 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:04:43,523 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:04:43,556 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:04:43,557 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:04:43,572 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:04:43,575 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:04:45,240 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:04:45,241 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:04:45,256 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:05:35,533 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:05:36,358 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:05:36,360 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:05:36,367 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:05:39,037 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:05:39,078 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:05:39,080 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:05:39,095 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:05:39,097 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:05:40,337 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:05:40,338 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:05:40,349 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:06:01,670 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:06:05,585 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:06:05,628 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:06:05,630 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:06:05,647 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:06:05,650 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:06:06,628 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:06:06,629 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:06:06,637 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:06:22,120 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:06:22,722 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:06:22,767 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:06:22,769 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:06:22,785 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:06:22,787 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:06:24,173 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:06:24,174 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:06:24,183 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:06:41,652 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:06:42,046 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:06:42,080 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:06:42,083 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:06:42,099 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:06:42,101 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:06:43,326 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:06:43,330 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:06:43,336 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 0 个
2025-04-08 06:07:06,820 - backend.app.services.flow_variable_service - INFO - 更新流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-08 06:08:02,811 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:08:23,212 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:08:35,618 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:08:47,047 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:30:49,945 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:30:49,983 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:30:49,985 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:30:50,001 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:30:50,003 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-08 06:30:52,139 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-08 06:30:52,140 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-08 06:30:52,147 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-08 06:31:11,248 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:31:11,250 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:31:12,667 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:31:12,668 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:31:12,700 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:31:12,702 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:31:12,716 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:31:12,718 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:35:18,066 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:35:40,728 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:35:40,766 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:35:40,769 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:35:40,790 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:35:40,793 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:35:42,931 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:35:42,933 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:35:42,940 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:37:12,849 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:37:12,851 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:37:12,867 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:37:20,890 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:37:20,892 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:37:20,910 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:37:20,914 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:37:28,371 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:37:28,408 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:37:28,409 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:37:28,425 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:37:28,426 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:37:30,457 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-08 06:37:30,458 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-08 06:37:30,463 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-08 06:37:56,042 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:37:56,044 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:37:56,068 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:37:56,071 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:43:53,729 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:43:53,731 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:43:53,748 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:43:53,751 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:45:22,005 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:45:22,040 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:45:22,043 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:45:22,063 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:45:22,065 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:45:30,302 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:45:30,303 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:45:30,315 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:46:36,392 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:46:36,394 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:46:36,406 - backend.app.services.flow_variable_service - INFO - 获取流程图 b86dbc31-26fe-45bd-9c3a-7c807cc59d53 的变量成功，共 1 个
2025-04-08 06:46:47,285 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:46:47,287 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:46:48,357 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:46:48,362 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:46:48,395 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:46:48,396 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:46:48,411 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:46:48,415 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-08 06:48:02,090 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:48:02,091 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:48:03,348 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-08 06:48:03,353 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-08 06:48:03,403 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:48:03,405 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:48:03,424 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-08 06:48:03,427 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-08 06:50:17,754 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-08 06:50:17,754 - app.main - INFO - 开始导入模块...
2025-04-08 06:50:17,754 - app.main - INFO - 导入database成功
2025-04-08 06:50:17,754 - app.main - INFO - 导入models成功
2025-04-08 06:50:17,754 - app.main - INFO - 导入config成功
2025-04-08 06:50:17,832 - app.main - INFO - 导入基本路由成功
2025-04-08 06:50:18,291 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-08 06:50:18,291 - app.main - INFO - 导入utils成功
2025-04-08 06:50:18,291 - app.main - INFO - 导入dependencies成功
2025-04-08 06:50:18,291 - app.main - INFO - 创建数据库表...
2025-04-08 06:50:18,291 - app.main - INFO - 数据库表创建成功
2025-04-08 06:50:18,291 - app.main - INFO - 初始化FastAPI应用...
2025-04-08 06:50:18,298 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 06:50:18,298 - app.main - INFO - 注册路由...
2025-04-08 06:50:18,302 - app.main - INFO - 注册user路由成功
2025-04-08 06:50:18,307 - app.main - INFO - 注册flow路由成功
2025-04-08 06:50:18,307 - app.main - INFO - 注册email路由成功
2025-04-08 06:50:18,308 - app.main - INFO - 注册auth路由成功
2025-04-08 06:50:18,308 - app.main - INFO - 注册node_templates路由成功
2025-04-08 06:50:18,308 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-08 06:50:18,317 - app.main - INFO - 注册flow_variables路由成功
2025-04-08 06:50:18,318 - app.main - INFO - 注册chat路由成功
2025-04-08 06:50:18,318 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-08 06:50:18,319 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-08 06:50:18,319 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-08 06:50:18,319 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-08 06:50:18,319 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-08 06:50:18,319 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-08 06:50:18,319 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-08 06:50:18,319 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-08 06:50:18,350 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-08 06:50:18,350 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-08 06:50:18,350 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-08 06:50:18,350 - backend.app.startup - INFO - API前缀: /api
2025-04-08 06:50:18,350 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-08 06:54:38,044 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 07:51:29,874 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-08 07:51:29,875 - app.main - INFO - 开始导入模块...
2025-04-08 07:51:29,875 - app.main - INFO - 导入database成功
2025-04-08 07:51:29,875 - app.main - INFO - 导入models成功
2025-04-08 07:51:29,875 - app.main - INFO - 导入config成功
2025-04-08 07:51:29,951 - app.main - INFO - 导入基本路由成功
2025-04-08 07:51:30,409 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-08 07:51:30,409 - app.main - INFO - 导入utils成功
2025-04-08 07:51:30,409 - app.main - INFO - 导入dependencies成功
2025-04-08 07:51:30,409 - app.main - INFO - 创建数据库表...
2025-04-08 07:51:30,409 - app.main - INFO - 数据库表创建成功
2025-04-08 07:51:30,409 - app.main - INFO - 初始化FastAPI应用...
2025-04-08 07:51:30,415 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 07:51:30,416 - app.main - INFO - 注册路由...
2025-04-08 07:51:30,420 - app.main - INFO - 注册user路由成功
2025-04-08 07:51:30,424 - app.main - INFO - 注册flow路由成功
2025-04-08 07:51:30,425 - app.main - INFO - 注册email路由成功
2025-04-08 07:51:30,426 - app.main - INFO - 注册auth路由成功
2025-04-08 07:51:30,426 - app.main - INFO - 注册node_templates路由成功
2025-04-08 07:51:30,426 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-08 07:51:30,435 - app.main - INFO - 注册flow_variables路由成功
2025-04-08 07:51:30,435 - app.main - INFO - 注册chat路由成功
2025-04-08 07:51:30,435 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-08 07:51:30,436 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-08 07:51:30,436 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-08 07:51:30,436 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-08 07:51:30,436 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-08 07:51:30,436 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-08 07:51:30,436 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-08 07:51:30,437 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-08 07:51:30,467 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-08 07:51:30,467 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-08 07:51:30,468 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-08 07:51:30,468 - backend.app.startup - INFO - API前缀: /api
2025-04-08 07:51:30,468 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-08 07:51:48,663 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-08 07:51:48,663 - app.main - INFO - 开始导入模块...
2025-04-08 07:51:48,663 - app.main - INFO - 导入database成功
2025-04-08 07:51:48,663 - app.main - INFO - 导入models成功
2025-04-08 07:51:48,663 - app.main - INFO - 导入config成功
2025-04-08 07:51:48,738 - app.main - INFO - 导入基本路由成功
2025-04-08 07:51:49,192 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-08 07:51:49,192 - app.main - INFO - 导入utils成功
2025-04-08 07:51:49,192 - app.main - INFO - 导入dependencies成功
2025-04-08 07:51:49,192 - app.main - INFO - 创建数据库表...
2025-04-08 07:51:49,193 - app.main - INFO - 数据库表创建成功
2025-04-08 07:51:49,193 - app.main - INFO - 初始化FastAPI应用...
2025-04-08 07:51:49,199 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 07:51:49,199 - app.main - INFO - 注册路由...
2025-04-08 07:51:49,204 - app.main - INFO - 注册user路由成功
2025-04-08 07:51:49,208 - app.main - INFO - 注册flow路由成功
2025-04-08 07:51:49,209 - app.main - INFO - 注册email路由成功
2025-04-08 07:51:49,209 - app.main - INFO - 注册auth路由成功
2025-04-08 07:51:49,210 - app.main - INFO - 注册node_templates路由成功
2025-04-08 07:51:49,210 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-08 07:51:49,219 - app.main - INFO - 注册flow_variables路由成功
2025-04-08 07:51:49,219 - app.main - INFO - 注册chat路由成功
2025-04-08 07:51:49,219 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-08 07:51:49,220 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-08 07:51:49,220 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-08 07:51:49,220 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-08 07:51:49,220 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-08 07:51:49,220 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-08 07:51:49,220 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-08 07:51:49,220 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-08 07:51:49,251 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-08 07:51:49,251 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-08 07:51:49,251 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-08 07:51:49,251 - backend.app.startup - INFO - API前缀: /api
2025-04-08 07:51:49,251 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-08 07:52:07,932 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-08 07:52:07,933 - app.main - INFO - 开始导入模块...
2025-04-08 07:52:07,933 - app.main - INFO - 导入database成功
2025-04-08 07:52:07,933 - app.main - INFO - 导入models成功
2025-04-08 07:52:07,933 - app.main - INFO - 导入config成功
2025-04-08 07:52:08,008 - app.main - INFO - 导入基本路由成功
2025-04-08 07:52:08,461 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-08 07:52:08,461 - app.main - INFO - 导入utils成功
2025-04-08 07:52:08,461 - app.main - INFO - 导入dependencies成功
2025-04-08 07:52:08,461 - app.main - INFO - 创建数据库表...
2025-04-08 07:52:08,461 - app.main - INFO - 数据库表创建成功
2025-04-08 07:52:08,461 - app.main - INFO - 初始化FastAPI应用...
2025-04-08 07:52:08,468 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 07:52:08,468 - app.main - INFO - 注册路由...
2025-04-08 07:52:08,472 - app.main - INFO - 注册user路由成功
2025-04-08 07:52:08,477 - app.main - INFO - 注册flow路由成功
2025-04-08 07:52:08,477 - app.main - INFO - 注册email路由成功
2025-04-08 07:52:08,478 - app.main - INFO - 注册auth路由成功
2025-04-08 07:52:08,478 - app.main - INFO - 注册node_templates路由成功
2025-04-08 07:52:08,478 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-08 07:52:08,487 - app.main - INFO - 注册flow_variables路由成功
2025-04-08 07:52:08,487 - app.main - INFO - 注册chat路由成功
2025-04-08 07:52:08,487 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-08 07:52:08,488 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-08 07:52:08,488 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-08 07:52:08,488 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-08 07:52:08,488 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-08 07:52:08,488 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-08 07:52:08,488 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-08 07:52:08,489 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-08 07:52:08,519 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-08 07:52:08,520 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-08 07:52:08,520 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-08 07:52:08,520 - backend.app.startup - INFO - API前缀: /api
2025-04-08 07:52:08,520 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-08 07:54:07,218 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-08 07:58:00,437 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-08 07:58:16,814 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-08 07:58:16,863 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 07:58:16,866 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-08 07:58:16,888 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-08 07:58:16,937 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-08 08:01:03,209 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 00:33:10,457 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 00:33:10,459 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 00:33:12,201 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 00:33:12,253 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 00:33:12,281 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 00:33:12,290 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 00:33:12,296 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 00:33:12,299 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 00:35:24,138 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 00:35:24,195 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 00:35:24,241 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 00:35:24,263 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 00:35:24,277 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 00:35:24,279 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 00:35:24,282 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 00:35:51,830 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: d414b7dd-b903-4edf-aef9-475e67791277
2025-04-09 00:35:51,869 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: d414b7dd-b903-4edf-aef9-475e67791277
2025-04-09 00:35:51,898 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 00:35:51,904 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 00:35:51,911 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: d414b7dd-b903-4edf-aef9-475e67791277
2025-04-09 00:35:51,915 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: d414b7dd-b903-4edf-aef9-475e67791277
2025-04-09 00:36:01,972 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 00:36:02,012 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 00:36:02,015 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 00:36:02,022 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 00:36:02,028 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 00:36:50,634 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 00:36:50,735 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 00:36:50,740 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 00:36:50,756 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 00:36:50,760 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 00:59:14,746 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-09 00:59:14,799 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-09 00:59:14,827 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 00:59:14,833 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 00:59:14,848 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-09 00:59:14,852 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-09 01:00:12,323 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-09 01:00:12,380 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 01:00:12,383 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 01:00:12,400 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-09 01:00:12,405 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: b86dbc31-26fe-45bd-9c3a-7c807cc59d53
2025-04-09 01:00:22,305 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 01:00:22,343 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 01:00:22,388 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 01:00:22,390 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 01:00:22,406 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 01:00:22,409 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 01:00:29,487 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-09 01:00:29,489 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-09 01:00:29,505 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-09 01:05:42,885 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-09 01:05:42,887 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-09 01:05:42,903 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-09 01:31:57,655 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 01:31:57,695 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 01:31:57,696 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 01:31:57,717 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 01:31:57,721 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 01:32:01,047 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-09 01:32:01,065 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-09 01:32:01,097 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-09 01:32:19,627 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-09 01:32:19,633 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-09 01:32:19,654 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 01:32:19,678 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 01:32:19,680 - backend.app.services.flow_variable_service - INFO - 获取流程图 ed10ef28-ad53-41c0-860f-f359e3ea9640 的变量成功，共 0 个
2025-04-09 01:32:19,683 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-09 01:32:19,685 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-09 01:32:21,754 - backend.app.services.flow_variable_service - INFO - 获取流程图 ed10ef28-ad53-41c0-860f-f359e3ea9640 的变量成功，共 0 个
2025-04-09 01:32:21,757 - backend.app.services.flow_variable_service - INFO - 获取流程图 ed10ef28-ad53-41c0-860f-f359e3ea9640 的变量成功，共 0 个
2025-04-09 01:32:21,765 - backend.app.services.flow_variable_service - INFO - 获取流程图 ed10ef28-ad53-41c0-860f-f359e3ea9640 的变量成功，共 0 个
2025-04-09 01:32:32,413 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-09 01:32:32,425 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 01:32:32,430 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 01:32:32,448 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 01:32:32,455 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 01:32:32,478 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 01:32:32,481 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 01:32:34,708 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-09 01:32:34,710 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-09 01:32:34,722 - backend.app.services.flow_variable_service - INFO - 获取流程图 61751c36-5c34-4dcb-90ac-73480ce54638 的变量成功，共 2 个
2025-04-09 01:32:41,340 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 01:32:41,360 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 01:32:41,398 - backend.app.services.flow_variable_service - INFO - 获取流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的变量成功，共 0 个
2025-04-09 01:32:41,411 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 01:32:41,480 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 01:32:41,502 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 01:32:41,504 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 01:32:41,517 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 01:32:41,520 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 01:32:44,303 - backend.app.services.flow_variable_service - INFO - 获取流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的变量成功，共 0 个
2025-04-09 01:32:44,304 - backend.app.services.flow_variable_service - INFO - 获取流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的变量成功，共 0 个
2025-04-09 01:32:44,312 - backend.app.services.flow_variable_service - INFO - 获取流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的变量成功，共 0 个
2025-04-09 02:40:58,325 - backend.app.services.flow_variable_service - INFO - 获取流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的变量成功，共 0 个
2025-04-09 02:41:04,104 - backend.app.services.flow_variable_service - INFO - 获取流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的变量成功，共 0 个
2025-04-09 02:41:06,706 - backend.app.services.flow_variable_service - INFO - 获取流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的变量成功，共 0 个
2025-04-09 02:41:08,676 - backend.app.services.flow_variable_service - INFO - 获取流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的变量成功，共 0 个
2025-04-09 05:19:44,077 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-09 05:19:44,077 - app.main - INFO - 开始导入模块...
2025-04-09 05:19:44,077 - app.main - INFO - 导入database成功
2025-04-09 05:19:44,077 - app.main - INFO - 导入models成功
2025-04-09 05:19:44,077 - app.main - INFO - 导入config成功
2025-04-09 05:19:44,153 - app.main - INFO - 导入基本路由成功
2025-04-09 05:19:44,601 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-09 05:19:44,601 - app.main - INFO - 导入utils成功
2025-04-09 05:19:44,601 - app.main - INFO - 导入dependencies成功
2025-04-09 05:19:44,601 - app.main - INFO - 创建数据库表...
2025-04-09 05:19:44,602 - app.main - INFO - 数据库表创建成功
2025-04-09 05:19:44,602 - app.main - INFO - 初始化FastAPI应用...
2025-04-09 05:19:44,608 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:19:44,608 - app.main - INFO - 注册路由...
2025-04-09 05:19:44,613 - app.main - INFO - 注册user路由成功
2025-04-09 05:19:44,617 - app.main - INFO - 注册flow路由成功
2025-04-09 05:19:44,618 - app.main - INFO - 注册email路由成功
2025-04-09 05:19:44,618 - app.main - INFO - 注册auth路由成功
2025-04-09 05:19:44,618 - app.main - INFO - 注册node_templates路由成功
2025-04-09 05:19:44,619 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-09 05:19:44,628 - app.main - INFO - 注册flow_variables路由成功
2025-04-09 05:19:44,628 - app.main - INFO - 注册chat路由成功
2025-04-09 05:19:44,628 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-09 05:19:44,629 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-09 05:19:44,629 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-09 05:19:44,629 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-09 05:19:44,629 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-09 05:19:44,629 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-09 05:19:44,629 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-09 05:19:44,629 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-09 05:19:44,660 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-09 05:19:44,660 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-09 05:19:44,660 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-09 05:19:44,660 - backend.app.startup - INFO - API前缀: /api
2025-04-09 05:19:44,661 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-09 05:19:49,029 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:19:49,102 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:19:49,106 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:19:49,123 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:19:49,133 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:26:21,014 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-09 05:26:21,014 - app.main - INFO - 开始导入模块...
2025-04-09 05:26:21,014 - app.main - INFO - 导入database成功
2025-04-09 05:26:21,014 - app.main - INFO - 导入models成功
2025-04-09 05:26:21,014 - app.main - INFO - 导入config成功
2025-04-09 05:26:21,095 - app.main - INFO - 导入基本路由成功
2025-04-09 05:26:21,598 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-09 05:26:21,599 - app.main - INFO - 导入utils成功
2025-04-09 05:26:21,599 - app.main - INFO - 导入dependencies成功
2025-04-09 05:26:21,599 - app.main - INFO - 创建数据库表...
2025-04-09 05:26:21,600 - app.main - INFO - 数据库表创建成功
2025-04-09 05:26:21,600 - app.main - INFO - 初始化FastAPI应用...
2025-04-09 05:26:21,609 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:26:21,610 - app.main - INFO - 注册路由...
2025-04-09 05:26:21,615 - app.main - INFO - 注册user路由成功
2025-04-09 05:26:21,620 - app.main - INFO - 注册flow路由成功
2025-04-09 05:26:21,621 - app.main - INFO - 注册email路由成功
2025-04-09 05:26:21,621 - app.main - INFO - 注册auth路由成功
2025-04-09 05:26:21,622 - app.main - INFO - 注册node_templates路由成功
2025-04-09 05:26:21,622 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-09 05:26:21,631 - app.main - INFO - 注册flow_variables路由成功
2025-04-09 05:26:21,631 - app.main - INFO - 注册chat路由成功
2025-04-09 05:26:21,631 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-09 05:26:21,632 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-09 05:26:21,632 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-09 05:26:21,632 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-09 05:26:21,632 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-09 05:26:21,632 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-09 05:26:21,632 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-09 05:26:21,633 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-09 05:26:21,665 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-09 05:26:21,665 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-09 05:26:21,665 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-09 05:26:21,665 - backend.app.startup - INFO - API前缀: /api
2025-04-09 05:26:21,665 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-09 05:26:33,947 - app.main - INFO - 收到请求: GET /favicon.ico (来自: 172.19.0.1)
2025-04-09 05:26:33,948 - app.main - INFO - 请求完成: GET /favicon.ico - 404 (耗时: 0.0003s)
2025-04-09 05:26:33,979 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 05:26:33,983 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0030s)
2025-04-09 05:26:33,996 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:26:34,002 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:26:34,005 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 05:26:34,005 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0089s)
2025-04-09 05:26:34,006 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0008s)
2025-04-09 05:26:34,045 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 05:26:34,047 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0021s)
2025-04-09 05:26:34,069 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 05:26:34,071 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:26:34,071 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0014s)
2025-04-09 05:26:34,071 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 05:26:34,072 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:26:34,072 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0008s)
2025-04-09 05:26:34,089 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:26:34,093 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:26:34,095 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:26:34,096 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0064s)
2025-04-09 05:26:34,099 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:26:34,101 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0055s)
2025-04-09 05:26:34,123 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 05:26:34,130 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0064s)
2025-04-09 05:26:34,190 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:26:34,196 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0057s)
2025-04-09 05:26:36,190 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:26:36,238 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0484s)
2025-04-09 05:26:36,720 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 05:26:36,721 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 05:26:36,725 - app.main - INFO - 请求完成: POST /chats/ - 404 (耗时: 0.0041s)
2025-04-09 05:26:36,725 - app.main - INFO - 请求完成: POST /chats/ - 404 (耗时: 0.0049s)
2025-04-09 05:27:51,401 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-09 05:27:51,401 - app.main - INFO - 开始导入模块...
2025-04-09 05:27:51,401 - app.main - INFO - 导入database成功
2025-04-09 05:27:51,401 - app.main - INFO - 导入models成功
2025-04-09 05:27:51,401 - app.main - INFO - 导入config成功
2025-04-09 05:27:51,478 - app.main - INFO - 导入基本路由成功
2025-04-09 05:27:51,943 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-09 05:27:51,943 - app.main - INFO - 导入utils成功
2025-04-09 05:27:51,943 - app.main - INFO - 导入dependencies成功
2025-04-09 05:27:51,943 - app.main - INFO - 创建数据库表...
2025-04-09 05:27:51,944 - app.main - INFO - 数据库表创建成功
2025-04-09 05:27:51,944 - app.main - INFO - 初始化FastAPI应用...
2025-04-09 05:27:51,950 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:27:51,951 - app.main - INFO - 注册路由...
2025-04-09 05:27:51,955 - app.main - INFO - 注册user路由成功
2025-04-09 05:27:51,959 - app.main - INFO - 注册flow路由成功
2025-04-09 05:27:51,960 - app.main - INFO - 注册email路由成功
2025-04-09 05:27:51,960 - app.main - INFO - 注册auth路由成功
2025-04-09 05:27:51,961 - app.main - INFO - 注册node_templates路由成功
2025-04-09 05:27:51,961 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-09 05:27:51,970 - app.main - INFO - 注册flow_variables路由成功
2025-04-09 05:27:51,970 - app.main - INFO - 注册chat路由成功
2025-04-09 05:27:51,970 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-09 05:27:51,971 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-09 05:27:51,971 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-09 05:27:51,971 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-09 05:27:51,971 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-09 05:27:51,971 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-09 05:27:51,971 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-09 05:27:51,971 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-09 05:27:52,002 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-09 05:27:52,002 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-09 05:27:52,002 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-09 05:27:52,002 - backend.app.startup - INFO - API前缀: /api
2025-04-09 05:27:52,002 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-09 05:28:05,849 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 05:28:05,852 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 05:28:05,853 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0036s)
2025-04-09 05:28:05,854 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0016s)
2025-04-09 05:28:05,864 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 05:28:05,865 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-09 05:28:05,872 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 05:28:05,876 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:28:05,882 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:28:05,885 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0124s)
2025-04-09 05:28:05,886 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0092s)
2025-04-09 05:28:05,955 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 05:28:05,956 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:28:05,956 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-09 05:28:05,957 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 05:28:05,957 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:28:05,958 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0008s)
2025-04-09 05:28:05,973 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:28:05,975 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:28:05,976 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:28:06,024 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:28:06,025 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0518s)
2025-04-09 05:28:06,025 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0490s)
2025-04-09 05:28:06,090 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:28:06,096 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0056s)
2025-04-09 05:28:07,872 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 05:28:07,876 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 05:28:07,876 - backend.app.routers.chat - INFO - 验证 flow ownership: undefined
2025-04-09 05:28:07,876 - backend.app.routers.chat - ERROR - 处理 create_chat 时发生 HTTPException: 404 - 流程图不存在
2025-04-09 05:28:07,877 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 05:28:07,877 - app.main - INFO - 请求完成: POST /chats/ - 404 (耗时: 0.0051s)
2025-04-09 05:28:07,879 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 05:28:07,879 - backend.app.routers.chat - INFO - 验证 flow ownership: undefined
2025-04-09 05:28:07,879 - backend.app.routers.chat - ERROR - 处理 create_chat 时发生 HTTPException: 404 - 流程图不存在
2025-04-09 05:28:07,879 - app.main - INFO - 请求完成: POST /chats/ - 404 (耗时: 0.0025s)
2025-04-09 05:28:08,085 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:28:08,089 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0032s)
2025-04-09 05:30:17,095 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 05:30:17,097 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 05:30:17,099 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0038s)
2025-04-09 05:30:17,100 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0028s)
2025-04-09 05:30:17,113 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 05:30:17,114 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0004s)
2025-04-09 05:30:17,126 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:30:17,130 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:30:17,131 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0052s)
2025-04-09 05:30:17,190 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 05:30:17,191 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:30:17,192 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 05:30:17,192 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0019s)
2025-04-09 05:30:17,193 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:30:17,194 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0022s)
2025-04-09 05:30:17,206 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:30:17,209 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:30:17,211 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:30:17,212 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 05:30:17,212 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0061s)
2025-04-09 05:30:17,214 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:30:17,216 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0055s)
2025-04-09 05:30:17,217 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0054s)
2025-04-09 05:30:17,293 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:30:17,296 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0030s)
2025-04-09 05:30:19,301 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:30:19,316 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0143s)
2025-04-09 05:31:41,592 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:31:41,592 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:31:41,597 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:31:41,598 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0062s)
2025-04-09 05:31:41,599 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0058s)
2025-04-09 05:31:41,615 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:31:41,618 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0028s)
2025-04-09 05:31:41,640 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:31:41,643 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0031s)
2025-04-09 05:31:43,646 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:31:43,656 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0099s)
2025-04-09 05:32:14,487 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:14,488 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 05:32:14,492 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:14,493 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 05:32:14,493 - backend.app.routers.chat - INFO - 验证 flow ownership: 61
2025-04-09 05:32:14,493 - backend.app.routers.chat - ERROR - 处理 create_chat 时发生 HTTPException: 404 - 流程图不存在
2025-04-09 05:32:14,493 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0065s)
2025-04-09 05:32:14,496 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:32:14,496 - app.main - INFO - 请求完成: POST /chats/ - 404 (耗时: 0.0086s)
2025-04-09 05:32:14,497 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0053s)
2025-04-09 05:32:14,505 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:14,509 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0035s)
2025-04-09 05:32:14,524 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:14,529 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0047s)
2025-04-09 05:32:16,521 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:16,525 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0037s)
2025-04-09 05:32:28,360 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:28,360 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:28,367 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:32:28,368 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0080s)
2025-04-09 05:32:28,368 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0076s)
2025-04-09 05:32:28,377 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:28,381 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0042s)
2025-04-09 05:32:28,403 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:28,406 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0032s)
2025-04-09 05:32:30,416 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:30,427 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0103s)
2025-04-09 05:32:52,238 - app.main - INFO - 收到请求: GET /favicon.ico (来自: 172.19.0.1)
2025-04-09 05:32:52,239 - app.main - INFO - 请求完成: GET /favicon.ico - 404 (耗时: 0.0002s)
2025-04-09 05:32:52,269 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 05:32:52,270 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 05:32:52,271 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0027s)
2025-04-09 05:32:52,272 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0017s)
2025-04-09 05:32:52,284 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 05:32:52,284 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-09 05:32:52,287 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:52,289 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:32:52,290 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 05:32:52,290 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0034s)
2025-04-09 05:32:52,293 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0033s)
2025-04-09 05:32:52,355 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 05:32:52,356 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:32:52,356 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-09 05:32:52,361 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 05:32:52,362 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:32:52,363 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-09 05:32:52,438 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:52,439 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:52,441 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:32:52,443 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:32:52,444 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0057s)
2025-04-09 05:32:52,444 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0054s)
2025-04-09 05:32:52,503 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:52,506 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0030s)
2025-04-09 05:32:54,514 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:32:54,524 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0098s)
2025-04-09 05:32:59,435 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 05:32:59,435 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-09 05:32:59,491 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 05:32:59,495 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0035s)
2025-04-09 05:33:02,232 - app.main - INFO - 收到请求: POST /flows/072bf7ae-5bde-43dc-92a0-778a5441d8b2/set-as-last-selected (来自: 172.19.0.1)
2025-04-09 05:33:02,243 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 05:33:02,245 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:33:02,245 - app.main - INFO - 请求完成: POST /flows/072bf7ae-5bde-43dc-92a0-778a5441d8b2/set-as-last-selected - 200 (耗时: 0.0134s)
2025-04-09 05:33:02,250 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0045s)
2025-04-09 05:33:02,294 - app.main - INFO - 收到请求: GET /flows/072bf7ae-5bde-43dc-92a0-778a5441d8b2 (来自: 172.19.0.1)
2025-04-09 05:33:02,297 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 05:33:02,298 - app.main - INFO - 请求完成: GET /flows/072bf7ae-5bde-43dc-92a0-778a5441d8b2 - 200 (耗时: 0.0043s)
2025-04-09 05:33:02,338 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 05:33:02,339 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:33:02,340 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0017s)
2025-04-09 05:33:02,342 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 05:33:02,343 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:33:02,343 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0008s)
2025-04-09 05:33:02,354 - app.main - INFO - 收到请求: GET /flows/072bf7ae-5bde-43dc-92a0-778a5441d8b2 (来自: 172.19.0.1)
2025-04-09 05:33:02,355 - app.main - INFO - 收到请求: GET /flows/072bf7ae-5bde-43dc-92a0-778a5441d8b2 (来自: 172.19.0.1)
2025-04-09 05:33:02,359 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 05:33:02,361 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 072bf7ae-5bde-43dc-92a0-778a5441d8b2
2025-04-09 05:33:02,362 - app.main - INFO - 请求完成: GET /flows/072bf7ae-5bde-43dc-92a0-778a5441d8b2 - 200 (耗时: 0.0064s)
2025-04-09 05:33:02,362 - app.main - INFO - 请求完成: GET /flows/072bf7ae-5bde-43dc-92a0-778a5441d8b2 - 200 (耗时: 0.0077s)
2025-04-09 05:33:04,720 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 05:33:04,721 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 05:33:04,723 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 05:33:04,723 - backend.app.routers.chat - INFO - 验证 flow ownership: 72
2025-04-09 05:33:04,723 - backend.app.routers.chat - ERROR - 处理 create_chat 时发生 HTTPException: 404 - 流程图不存在
2025-04-09 05:33:04,724 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 05:33:04,724 - backend.app.routers.chat - INFO - 验证 flow ownership: 72
2025-04-09 05:33:04,724 - backend.app.routers.chat - ERROR - 处理 create_chat 时发生 HTTPException: 404 - 流程图不存在
2025-04-09 05:33:04,725 - app.main - INFO - 请求完成: POST /chats/ - 404 (耗时: 0.0043s)
2025-04-09 05:33:04,725 - app.main - INFO - 请求完成: POST /chats/ - 404 (耗时: 0.0039s)
2025-04-09 05:52:36,528 - app.main - INFO - 收到请求: GET /favicon.ico (来自: 172.19.0.1)
2025-04-09 05:52:36,529 - app.main - INFO - 请求完成: GET /favicon.ico - 404 (耗时: 0.0002s)
2025-04-09 05:52:36,563 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 05:52:36,564 - app.main - INFO - 请求完成: GET /auth/verify-token - 401 (耗时: 0.0008s)
2025-04-09 05:52:36,565 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 05:52:36,565 - app.main - INFO - 请求完成: GET /auth/verify-token - 401 (耗时: 0.0006s)
2025-04-09 05:52:39,750 - app.main - INFO - 收到请求: POST /users/login (来自: 172.19.0.1)
2025-04-09 05:52:39,939 - app.main - INFO - 请求完成: POST /users/login - 200 (耗时: 0.1886s)
2025-04-09 05:52:39,943 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 05:52:39,945 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0018s)
2025-04-09 05:52:40,026 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 05:52:40,026 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-09 05:52:40,035 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 05:52:40,036 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:52:40,037 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0014s)
2025-04-09 05:52:40,043 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 05:52:40,044 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:52:40,045 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0013s)
2025-04-09 05:52:40,087 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 05:52:40,088 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0004s)
2025-04-09 05:52:40,089 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 05:52:40,089 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-09 05:52:40,111 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 05:52:40,111 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0004s)
2025-04-09 05:52:40,128 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 05:52:40,132 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0040s)
2025-04-09 05:52:40,160 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 05:52:40,161 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 05:52:40,168 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 05:52:40,170 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0090s)
2025-04-09 05:52:40,172 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0106s)
2025-04-09 05:52:40,173 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0040s)
2025-04-09 05:52:41,472 - app.main - INFO - 收到请求: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected (来自: 172.19.0.1)
2025-04-09 05:52:41,485 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:52:41,486 - app.main - INFO - 请求完成: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected - 200 (耗时: 0.0138s)
2025-04-09 05:52:41,517 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:52:41,520 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:52:41,522 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0043s)
2025-04-09 05:52:41,564 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 05:52:41,565 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:52:41,565 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0011s)
2025-04-09 05:52:41,568 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 05:52:41,568 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 05:52:41,569 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0008s)
2025-04-09 05:52:41,584 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:52:41,585 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:52:41,587 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:52:41,589 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 05:52:41,590 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0050s)
2025-04-09 05:52:41,590 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0050s)
2025-04-09 05:52:41,692 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:52:41,695 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0027s)
2025-04-09 05:52:43,653 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 05:52:43,663 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0096s)
2025-04-09 05:52:50,430 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 05:52:50,432 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 05:52:50,432 - backend.app.routers.chat - INFO - 验证 flow ownership: 61
2025-04-09 05:52:50,432 - backend.app.routers.chat - ERROR - 处理 create_chat 时发生 HTTPException: 404 - 流程图不存在
2025-04-09 05:52:50,432 - app.main - INFO - 请求完成: POST /chats/ - 404 (耗时: 0.0022s)
2025-04-09 05:52:50,471 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 05:52:50,473 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 05:52:50,473 - backend.app.routers.chat - INFO - 验证 flow ownership: 61
2025-04-09 05:52:50,474 - backend.app.routers.chat - ERROR - 处理 create_chat 时发生 HTTPException: 404 - 流程图不存在
2025-04-09 05:52:50,474 - app.main - INFO - 请求完成: POST /chats/ - 404 (耗时: 0.0026s)
2025-04-09 06:00:50,586 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:00:50,588 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 06:00:50,590 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:00:50,591 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0045s)
2025-04-09 06:00:50,593 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 06:00:50,594 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0037s)
2025-04-09 06:00:50,595 - app.main - INFO - 请求完成: POST /chats/ - 422 (耗时: 0.0067s)
2025-04-09 06:00:50,609 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:00:50,612 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0027s)
2025-04-09 06:00:50,645 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:00:50,648 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0027s)
2025-04-09 06:00:52,637 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:00:52,644 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0066s)
2025-04-09 06:01:14,638 - app.main - INFO - 收到请求: GET /favicon.ico (来自: 172.19.0.1)
2025-04-09 06:01:14,639 - app.main - INFO - 请求完成: GET /favicon.ico - 404 (耗时: 0.0003s)
2025-04-09 06:01:14,677 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 06:01:14,678 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 06:01:14,680 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0029s)
2025-04-09 06:01:14,681 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0026s)
2025-04-09 06:01:14,692 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 06:01:14,692 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-09 06:01:14,703 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:01:14,706 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 06:01:14,707 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 06:01:14,708 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0039s)
2025-04-09 06:01:14,711 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0042s)
2025-04-09 06:01:14,754 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 06:01:14,755 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 06:01:14,755 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0012s)
2025-04-09 06:01:14,778 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 06:01:14,779 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 06:01:14,780 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-09 06:01:14,780 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:01:14,782 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 06:01:14,783 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:01:14,785 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 06:01:14,785 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0050s)
2025-04-09 06:01:14,786 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0030s)
2025-04-09 06:01:14,868 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:01:14,872 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0036s)
2025-04-09 06:01:16,874 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:01:16,898 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0232s)
2025-04-09 06:02:33,748 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:02:33,749 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 06:02:33,752 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:02:33,754 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 06:02:33,754 - backend.app.routers.chat - INFO - 验证 flow ownership: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 06:02:33,754 - backend.app.routers.chat - INFO - Flow ownership 验证通过
2025-04-09 06:02:33,754 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-09 06:02:33,767 - backend.app.services.chat_service - INFO - 已为流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 创建聊天 2225927e-4fcf-4c2e-a772-ae3bc104f20b
2025-04-09 06:02:33,767 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=2225927e-4fcf-4c2e-a772-ae3bc104f20b, name='新聊天', flow_id=61aa7e47-7611-41e8-b7bb-a438f0c09adb)>
2025-04-09 06:02:33,767 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: 2225927e-4fcf-4c2e-a772-ae3bc104f20b
2025-04-09 06:02:33,768 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0199s)
2025-04-09 06:02:33,770 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 06:02:33,771 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:02:33,772 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0233s)
2025-04-09 06:02:33,772 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0200s)
2025-04-09 06:02:33,775 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0037s)
2025-04-09 06:02:33,799 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:02:33,803 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0038s)
2025-04-09 06:02:33,823 - app.main - INFO - 收到请求: GET /chats/2225927e-4fcf-4c2e-a772-ae3bc104f20b (来自: 172.19.0.1)
2025-04-09 06:02:33,825 - app.main - INFO - 请求完成: GET /chats/2225927e-4fcf-4c2e-a772-ae3bc104f20b - 200 (耗时: 0.0024s)
2025-04-09 06:02:35,860 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:02:35,871 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0101s)
2025-04-09 06:03:08,124 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,128 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0031s)
2025-04-09 06:03:08,136 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,148 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0125s)
2025-04-09 06:03:08,150 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,154 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0040s)
2025-04-09 06:03:08,182 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,183 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,188 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,188 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0063s)
2025-04-09 06:03:08,200 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0172s)
2025-04-09 06:03:08,201 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0131s)
2025-04-09 06:03:08,211 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,216 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0056s)
2025-04-09 06:03:08,222 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,227 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0048s)
2025-04-09 06:03:08,259 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,260 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,269 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0103s)
2025-04-09 06:03:08,270 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0102s)
2025-04-09 06:03:08,277 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,282 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0054s)
2025-04-09 06:03:08,294 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,299 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0047s)
2025-04-09 06:03:08,309 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,315 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0057s)
2025-04-09 06:03:08,332 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,337 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0053s)
2025-04-09 06:03:08,343 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,346 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0033s)
2025-04-09 06:03:08,355 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,359 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0043s)
2025-04-09 06:03:08,377 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:08,380 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0031s)
2025-04-09 06:03:10,376 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:10,384 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0074s)
2025-04-09 06:03:10,997 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 06:03:10,999 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 06:03:10,999 - backend.app.routers.chat - INFO - 验证 flow ownership: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 06:03:11,000 - backend.app.routers.chat - INFO - Flow ownership 验证通过
2025-04-09 06:03:11,000 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-09 06:03:11,011 - backend.app.services.chat_service - INFO - 已为流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 创建聊天 43b5d619-3b54-4262-9256-ed7e2993b467
2025-04-09 06:03:11,011 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=43b5d619-3b54-4262-9256-ed7e2993b467, name='新聊天', flow_id=61aa7e47-7611-41e8-b7bb-a438f0c09adb)>
2025-04-09 06:03:11,011 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: 43b5d619-3b54-4262-9256-ed7e2993b467
2025-04-09 06:03:11,012 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0141s)
2025-04-09 06:03:11,020 - app.main - INFO - 收到请求: GET /chats/43b5d619-3b54-4262-9256-ed7e2993b467 (来自: 172.19.0.1)
2025-04-09 06:03:11,023 - app.main - INFO - 请求完成: GET /chats/43b5d619-3b54-4262-9256-ed7e2993b467 - 200 (耗时: 0.0028s)
2025-04-09 06:03:11,041 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 06:03:11,042 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 06:03:11,042 - backend.app.routers.chat - INFO - 验证 flow ownership: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 06:03:11,043 - backend.app.routers.chat - INFO - Flow ownership 验证通过
2025-04-09 06:03:11,043 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-09 06:03:11,046 - backend.app.services.chat_service - INFO - 已为流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 创建聊天 642835f6-ce4d-49d1-80fa-bca7e246a70e
2025-04-09 06:03:11,046 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=642835f6-ce4d-49d1-80fa-bca7e246a70e, name='新聊天', flow_id=61aa7e47-7611-41e8-b7bb-a438f0c09adb)>
2025-04-09 06:03:11,046 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: 642835f6-ce4d-49d1-80fa-bca7e246a70e
2025-04-09 06:03:11,046 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0051s)
2025-04-09 06:03:11,098 - app.main - INFO - 收到请求: GET /chats/642835f6-ce4d-49d1-80fa-bca7e246a70e (来自: 172.19.0.1)
2025-04-09 06:03:11,100 - app.main - INFO - 请求完成: GET /chats/642835f6-ce4d-49d1-80fa-bca7e246a70e - 200 (耗时: 0.0023s)
2025-04-09 06:03:19,187 - app.main - INFO - 收到请求: POST /chats/642835f6-ce4d-49d1-80fa-bca7e246a70e/messages (来自: 172.19.0.1)
2025-04-09 06:03:19,194 - backend.app.services.chat_service - INFO - 已向聊天 642835f6-ce4d-49d1-80fa-bca7e246a70e 添加一条 user 消息
2025-04-09 06:03:19,195 - app.main - INFO - 请求完成: POST /chats/642835f6-ce4d-49d1-80fa-bca7e246a70e/messages - 200 (耗时: 0.0074s)
2025-04-09 06:03:33,271 - app.main - INFO - 收到请求: GET /favicon.ico (来自: 172.19.0.1)
2025-04-09 06:03:33,271 - app.main - INFO - 请求完成: GET /favicon.ico - 404 (耗时: 0.0003s)
2025-04-09 06:03:33,300 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 06:03:33,302 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0016s)
2025-04-09 06:03:33,334 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 06:03:33,334 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-09 06:03:33,335 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:33,337 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 06:03:33,338 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0031s)
2025-04-09 06:03:33,341 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 06:03:33,342 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0014s)
2025-04-09 06:03:33,391 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 06:03:33,392 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 06:03:33,392 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0011s)
2025-04-09 06:03:33,397 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 06:03:33,398 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 06:03:33,398 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-09 06:03:33,410 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:33,412 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 06:03:33,413 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:33,414 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0040s)
2025-04-09 06:03:33,416 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 06:03:33,418 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0042s)
2025-04-09 06:03:33,421 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 06:03:33,424 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0030s)
2025-04-09 06:03:33,514 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:33,519 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0047s)
2025-04-09 06:03:35,512 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:03:35,517 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0053s)
2025-04-09 06:03:36,332 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 06:03:36,334 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 06:03:36,334 - backend.app.routers.chat - INFO - 验证 flow ownership: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 06:03:36,335 - backend.app.routers.chat - INFO - Flow ownership 验证通过
2025-04-09 06:03:36,335 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-09 06:03:36,345 - backend.app.services.chat_service - INFO - 已为流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 创建聊天 7dcecbea-6b17-477d-bea4-ca339eb67ff8
2025-04-09 06:03:36,345 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=7dcecbea-6b17-477d-bea4-ca339eb67ff8, name='新聊天', flow_id=61aa7e47-7611-41e8-b7bb-a438f0c09adb)>
2025-04-09 06:03:36,345 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: 7dcecbea-6b17-477d-bea4-ca339eb67ff8
2025-04-09 06:03:36,345 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 06:03:36,347 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 06:03:36,347 - backend.app.routers.chat - INFO - 验证 flow ownership: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 06:03:36,348 - backend.app.routers.chat - INFO - Flow ownership 验证通过
2025-04-09 06:03:36,348 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-09 06:03:36,350 - backend.app.services.chat_service - INFO - 已为流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 创建聊天 97781511-28e4-4893-873a-e6d7e88445ec
2025-04-09 06:03:36,350 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=97781511-28e4-4893-873a-e6d7e88445ec, name='新聊天', flow_id=61aa7e47-7611-41e8-b7bb-a438f0c09adb)>
2025-04-09 06:03:36,350 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: 97781511-28e4-4893-873a-e6d7e88445ec
2025-04-09 06:03:36,350 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0174s)
2025-04-09 06:03:36,351 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0054s)
2025-04-09 06:03:36,363 - app.main - INFO - 收到请求: GET /chats/7dcecbea-6b17-477d-bea4-ca339eb67ff8 (来自: 172.19.0.1)
2025-04-09 06:03:36,365 - app.main - INFO - 请求完成: GET /chats/7dcecbea-6b17-477d-bea4-ca339eb67ff8 - 200 (耗时: 0.0021s)
2025-04-09 06:03:36,413 - app.main - INFO - 收到请求: GET /chats/97781511-28e4-4893-873a-e6d7e88445ec (来自: 172.19.0.1)
2025-04-09 06:03:36,422 - app.main - INFO - 请求完成: GET /chats/97781511-28e4-4893-873a-e6d7e88445ec - 200 (耗时: 0.0086s)
2025-04-09 06:04:21,590 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 06:04:21,590 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-09 06:04:21,653 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 06:04:21,656 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0030s)
2025-04-09 06:04:23,704 - app.main - INFO - 收到请求: POST /flows/61751c36-5c34-4dcb-90ac-73480ce54638/set-as-last-selected (来自: 172.19.0.1)
2025-04-09 06:04:23,718 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 06:04:23,719 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 06:04:23,719 - app.main - INFO - 请求完成: POST /flows/61751c36-5c34-4dcb-90ac-73480ce54638/set-as-last-selected - 200 (耗时: 0.0150s)
2025-04-09 06:04:23,722 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0032s)
2025-04-09 06:04:23,752 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:04:23,754 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 06:04:23,755 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0029s)
2025-04-09 06:04:23,790 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 06:04:23,791 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 06:04:23,791 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0013s)
2025-04-09 06:04:23,793 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 06:04:23,793 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 06:04:23,794 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0008s)
2025-04-09 06:04:23,807 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:04:23,809 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 06:04:23,810 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:04:23,810 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0033s)
2025-04-09 06:04:23,812 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 06:04:23,813 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0033s)
2025-04-09 06:04:23,905 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:04:23,909 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0035s)
2025-04-09 06:04:25,863 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:04:25,874 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0100s)
2025-04-09 06:04:26,074 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 06:04:26,075 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 06:04:26,075 - backend.app.routers.chat - INFO - 验证 flow ownership: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 06:04:26,076 - backend.app.routers.chat - INFO - Flow ownership 验证通过
2025-04-09 06:04:26,076 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-09 06:04:26,089 - backend.app.services.chat_service - INFO - 已为流程图 61751c36-5c34-4dcb-90ac-73480ce54638 创建聊天 675dee98-4c26-4c79-8ebd-4a8cd2f3d9b9
2025-04-09 06:04:26,089 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=675dee98-4c26-4c79-8ebd-4a8cd2f3d9b9, name='新聊天', flow_id=61751c36-5c34-4dcb-90ac-73480ce54638)>
2025-04-09 06:04:26,089 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: 675dee98-4c26-4c79-8ebd-4a8cd2f3d9b9
2025-04-09 06:04:26,089 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 06:04:26,091 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 06:04:26,091 - backend.app.routers.chat - INFO - 验证 flow ownership: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 06:04:26,092 - backend.app.routers.chat - INFO - Flow ownership 验证通过
2025-04-09 06:04:26,092 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-09 06:04:26,094 - backend.app.services.chat_service - INFO - 已为流程图 61751c36-5c34-4dcb-90ac-73480ce54638 创建聊天 ac884264-5bf5-4f43-8533-171ea86e92b2
2025-04-09 06:04:26,094 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=ac884264-5bf5-4f43-8533-171ea86e92b2, name='新聊天', flow_id=61751c36-5c34-4dcb-90ac-73480ce54638)>
2025-04-09 06:04:26,094 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: ac884264-5bf5-4f43-8533-171ea86e92b2
2025-04-09 06:04:26,094 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0205s)
2025-04-09 06:04:26,095 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0056s)
2025-04-09 06:04:26,107 - app.main - INFO - 收到请求: GET /chats/675dee98-4c26-4c79-8ebd-4a8cd2f3d9b9 (来自: 172.19.0.1)
2025-04-09 06:04:26,109 - app.main - INFO - 请求完成: GET /chats/675dee98-4c26-4c79-8ebd-4a8cd2f3d9b9 - 200 (耗时: 0.0021s)
2025-04-09 06:04:26,151 - app.main - INFO - 收到请求: GET /chats/ac884264-5bf5-4f43-8533-171ea86e92b2 (来自: 172.19.0.1)
2025-04-09 06:04:26,153 - app.main - INFO - 请求完成: GET /chats/ac884264-5bf5-4f43-8533-171ea86e92b2 - 200 (耗时: 0.0021s)
2025-04-09 06:05:02,049 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-09 06:05:02,050 - app.main - INFO - 开始导入模块...
2025-04-09 06:05:02,050 - app.main - INFO - 导入database成功
2025-04-09 06:05:02,050 - app.main - INFO - 导入models成功
2025-04-09 06:05:02,050 - app.main - INFO - 导入config成功
2025-04-09 06:05:02,134 - app.main - INFO - 导入基本路由成功
2025-04-09 06:05:02,609 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-09 06:05:02,609 - app.main - INFO - 导入utils成功
2025-04-09 06:05:02,610 - app.main - INFO - 导入dependencies成功
2025-04-09 06:05:02,610 - app.main - INFO - 创建数据库表...
2025-04-09 06:05:02,610 - app.main - INFO - 数据库表创建成功
2025-04-09 06:05:02,610 - app.main - INFO - 初始化FastAPI应用...
2025-04-09 06:05:02,616 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 06:05:02,617 - app.main - INFO - 注册路由...
2025-04-09 06:05:02,621 - app.main - INFO - 注册user路由成功
2025-04-09 06:05:02,626 - app.main - INFO - 注册flow路由成功
2025-04-09 06:05:02,626 - app.main - INFO - 注册email路由成功
2025-04-09 06:05:02,627 - app.main - INFO - 注册auth路由成功
2025-04-09 06:05:02,627 - app.main - INFO - 注册node_templates路由成功
2025-04-09 06:05:02,627 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-09 06:05:02,636 - app.main - INFO - 注册flow_variables路由成功
2025-04-09 06:05:02,636 - app.main - INFO - 注册chat路由成功
2025-04-09 06:05:02,636 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-09 06:05:02,638 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-09 06:05:02,638 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-09 06:05:02,638 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-09 06:05:02,638 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-09 06:05:02,638 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-09 06:05:02,638 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-09 06:05:02,638 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-09 06:05:02,669 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-09 06:05:02,669 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-09 06:05:02,669 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-09 06:05:02,669 - backend.app.startup - INFO - API前缀: /api
2025-04-09 06:05:02,669 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-09 06:06:41,445 - app.main - INFO - 收到请求: POST /chats/ac884264-5bf5-4f43-8533-171ea86e92b2/messages (来自: 172.19.0.1)
2025-04-09 06:06:41,457 - backend.app.services.chat_service - INFO - 已向聊天 ac884264-5bf5-4f43-8533-171ea86e92b2 添加一条 user 消息
2025-04-09 06:06:41,458 - app.main - INFO - 请求完成: POST /chats/ac884264-5bf5-4f43-8533-171ea86e92b2/messages - 200 (耗时: 0.0120s)
2025-04-09 06:07:50,968 - app.main - INFO - 收到请求: POST /chats/ac884264-5bf5-4f43-8533-171ea86e92b2/messages (来自: 172.19.0.1)
2025-04-09 06:07:50,981 - backend.app.services.chat_service - INFO - 已向聊天 ac884264-5bf5-4f43-8533-171ea86e92b2 添加一条 user 消息
2025-04-09 06:07:50,982 - app.main - INFO - 请求完成: POST /chats/ac884264-5bf5-4f43-8533-171ea86e92b2/messages - 200 (耗时: 0.0138s)
2025-04-09 06:08:39,591 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:39,595 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0044s)
2025-04-09 06:08:40,788 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:40,792 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0030s)
2025-04-09 06:08:40,843 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:40,857 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0136s)
2025-04-09 06:08:40,904 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:40,909 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0042s)
2025-04-09 06:08:40,940 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:40,945 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0043s)
2025-04-09 06:08:40,978 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:40,983 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0049s)
2025-04-09 06:08:41,002 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:41,007 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0049s)
2025-04-09 06:08:41,042 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:41,046 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0042s)
2025-04-09 06:08:41,057 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:41,063 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0060s)
2025-04-09 06:08:41,088 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:41,092 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0045s)
2025-04-09 06:08:41,111 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:41,115 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0042s)
2025-04-09 06:08:42,250 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,265 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,265 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0154s)
2025-04-09 06:08:42,272 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0073s)
2025-04-09 06:08:42,280 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,284 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0040s)
2025-04-09 06:08:42,292 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,344 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,345 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,345 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,345 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0524s)
2025-04-09 06:08:42,360 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,360 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0161s)
2025-04-09 06:08:42,361 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0156s)
2025-04-09 06:08:42,361 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0157s)
2025-04-09 06:08:42,365 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0047s)
2025-04-09 06:08:42,386 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,392 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0059s)
2025-04-09 06:08:42,394 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,398 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0039s)
2025-04-09 06:08:42,411 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,416 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0041s)
2025-04-09 06:08:42,429 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,433 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0041s)
2025-04-09 06:08:42,452 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,457 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0048s)
2025-04-09 06:08:42,459 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,464 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0042s)
2025-04-09 06:08:42,475 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,481 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0055s)
2025-04-09 06:08:42,493 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,497 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0041s)
2025-04-09 06:08:42,517 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,521 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,522 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0052s)
2025-04-09 06:08:42,527 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0050s)
2025-04-09 06:08:42,539 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,544 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0043s)
2025-04-09 06:08:42,565 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:42,568 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0030s)
2025-04-09 06:08:44,570 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:08:44,580 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0101s)
2025-04-09 06:09:33,656 - app.main - INFO - 收到请求: POST /chats/ac884264-5bf5-4f43-8533-171ea86e92b2/messages (来自: 172.19.0.1)
2025-04-09 06:09:33,662 - backend.app.services.chat_service - INFO - 已向聊天 ac884264-5bf5-4f43-8533-171ea86e92b2 添加一条 user 消息
2025-04-09 06:09:33,662 - app.main - INFO - 请求完成: POST /chats/ac884264-5bf5-4f43-8533-171ea86e92b2/messages - 200 (耗时: 0.0061s)
2025-04-09 06:12:31,777 - app.main - INFO - 收到请求: POST /chats/ac884264-5bf5-4f43-8533-171ea86e92b2/messages (来自: 172.19.0.1)
2025-04-09 06:12:31,782 - backend.app.services.chat_service - INFO - 已向聊天 ac884264-5bf5-4f43-8533-171ea86e92b2 添加一条 user 消息
2025-04-09 06:12:31,782 - app.main - INFO - 请求完成: POST /chats/ac884264-5bf5-4f43-8533-171ea86e92b2/messages - 200 (耗时: 0.0047s)
2025-04-09 06:18:03,140 - app.main - INFO - 收到请求: GET /favicon.ico (来自: 172.19.0.1)
2025-04-09 06:18:03,140 - app.main - INFO - 请求完成: GET /favicon.ico - 404 (耗时: 0.0003s)
2025-04-09 06:18:03,171 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 06:18:03,173 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 06:18:03,174 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0029s)
2025-04-09 06:18:03,176 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0026s)
2025-04-09 06:18:03,251 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 06:18:03,251 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:18:03,252 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0007s)
2025-04-09 06:18:03,255 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 06:18:03,256 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0047s)
2025-04-09 06:18:03,306 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 06:18:03,311 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0044s)
2025-04-09 06:18:03,315 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 06:18:03,316 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 06:18:03,316 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-09 06:18:03,318 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 06:18:03,319 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 06:18:03,319 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-09 06:18:03,334 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:18:03,337 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 06:18:03,339 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:18:03,339 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0049s)
2025-04-09 06:18:03,343 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 06:18:03,344 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0055s)
2025-04-09 06:18:03,432 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:18:03,436 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0032s)
2025-04-09 06:18:05,337 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 06:18:05,338 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 06:18:05,340 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 06:18:05,340 - backend.app.routers.chat - INFO - 验证 flow ownership: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 06:18:05,341 - backend.app.routers.chat - INFO - Flow ownership 验证通过
2025-04-09 06:18:05,341 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-09 06:18:05,344 - backend.app.services.chat_service - INFO - 已为流程图 61751c36-5c34-4dcb-90ac-73480ce54638 创建聊天 b6208e81-685c-470b-b167-b43b9ecdeac8
2025-04-09 06:18:05,344 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=b6208e81-685c-470b-b167-b43b9ecdeac8, name='新聊天', flow_id=61751c36-5c34-4dcb-90ac-73480ce54638)>
2025-04-09 06:18:05,344 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: b6208e81-685c-470b-b167-b43b9ecdeac8
2025-04-09 06:18:05,345 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 06:18:05,345 - backend.app.routers.chat - INFO - 验证 flow ownership: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 06:18:05,345 - backend.app.routers.chat - INFO - Flow ownership 验证通过
2025-04-09 06:18:05,345 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-09 06:18:05,347 - backend.app.services.chat_service - INFO - 已为流程图 61751c36-5c34-4dcb-90ac-73480ce54638 创建聊天 e817dca0-c24a-4f93-a07d-0aafa93143de
2025-04-09 06:18:05,347 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=e817dca0-c24a-4f93-a07d-0aafa93143de, name='新聊天', flow_id=61751c36-5c34-4dcb-90ac-73480ce54638)>
2025-04-09 06:18:05,347 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: e817dca0-c24a-4f93-a07d-0aafa93143de
2025-04-09 06:18:05,348 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0105s)
2025-04-09 06:18:05,348 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0104s)
2025-04-09 06:18:05,398 - app.main - INFO - 收到请求: GET /chats/b6208e81-685c-470b-b167-b43b9ecdeac8 (来自: 172.19.0.1)
2025-04-09 06:18:05,401 - app.main - INFO - 请求完成: GET /chats/b6208e81-685c-470b-b167-b43b9ecdeac8 - 200 (耗时: 0.0027s)
2025-04-09 06:18:05,403 - app.main - INFO - 收到请求: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de (来自: 172.19.0.1)
2025-04-09 06:18:05,405 - app.main - INFO - 请求完成: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de - 200 (耗时: 0.0018s)
2025-04-09 06:18:05,428 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 06:18:05,430 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0028s)
2025-04-09 06:18:15,065 - app.main - INFO - 收到请求: POST /chats/e817dca0-c24a-4f93-a07d-0aafa93143de/messages (来自: 172.19.0.1)
2025-04-09 06:18:15,069 - backend.app.services.chat_service - INFO - 已向聊天 e817dca0-c24a-4f93-a07d-0aafa93143de 添加一条 user 消息
2025-04-09 06:18:15,069 - app.main - INFO - 请求完成: POST /chats/e817dca0-c24a-4f93-a07d-0aafa93143de/messages - 200 (耗时: 0.0045s)
2025-04-09 07:09:16,220 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:09:16,221 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:09:16,221 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-09 07:09:16,224 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:09:16,224 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:09:16,225 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-09 07:09:16,241 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:09:16,243 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:09:16,243 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:09:16,250 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 07:09:16,252 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 07:09:16,252 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0114s)
2025-04-09 07:09:16,253 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0106s)
2025-04-09 07:09:16,254 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0106s)
2025-04-09 07:09:16,311 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:09:16,314 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0031s)
2025-04-09 07:09:18,310 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:09:18,313 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0030s)
2025-04-09 07:15:14,134 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-09 07:15:14,134 - app.main - INFO - 开始导入模块...
2025-04-09 07:15:14,134 - app.main - INFO - 导入database成功
2025-04-09 07:15:14,134 - app.main - INFO - 导入models成功
2025-04-09 07:15:14,134 - app.main - INFO - 导入config成功
2025-04-09 07:15:14,214 - app.main - INFO - 导入基本路由成功
2025-04-09 07:15:14,679 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-09 07:15:14,679 - app.main - INFO - 导入utils成功
2025-04-09 07:15:14,679 - app.main - INFO - 导入dependencies成功
2025-04-09 07:15:14,679 - app.main - INFO - 创建数据库表...
2025-04-09 07:15:14,679 - app.main - INFO - 数据库表创建成功
2025-04-09 07:15:14,679 - app.main - INFO - 初始化FastAPI应用...
2025-04-09 07:15:14,682 - backend.app.utils - WARNING - 从数据库读取版本信息失败: Could not determine join condition between parent/child tables on relationship Flow.chats - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.
2025-04-09 07:15:14,682 - backend.app.utils - INFO - 从环境变量获取版本信息: 0.3.4
2025-04-09 07:15:14,683 - app.main - INFO - 注册路由...
2025-04-09 07:15:14,687 - app.main - INFO - 注册user路由成功
2025-04-09 07:15:14,692 - app.main - INFO - 注册flow路由成功
2025-04-09 07:15:14,692 - app.main - INFO - 注册email路由成功
2025-04-09 07:15:14,693 - app.main - INFO - 注册auth路由成功
2025-04-09 07:15:14,693 - app.main - INFO - 注册node_templates路由成功
2025-04-09 07:15:14,693 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-09 07:15:14,703 - app.main - INFO - 注册flow_variables路由成功
2025-04-09 07:15:14,703 - app.main - INFO - 注册chat路由成功
2025-04-09 07:15:14,703 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-09 07:15:14,704 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-09 07:15:14,704 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-09 07:15:14,704 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-09 07:15:14,704 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-09 07:15:14,704 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-09 07:15:14,704 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-09 07:15:14,704 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-09 07:15:14,735 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-09 07:15:14,735 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-09 07:15:14,735 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-09 07:15:14,735 - backend.app.startup - INFO - API前缀: /api
2025-04-09 07:15:14,735 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-09 07:15:32,298 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-09 07:15:32,298 - app.main - INFO - 开始导入模块...
2025-04-09 07:15:32,298 - app.main - INFO - 导入database成功
2025-04-09 07:15:32,298 - app.main - INFO - 导入models成功
2025-04-09 07:15:32,298 - app.main - INFO - 导入config成功
2025-04-09 07:15:32,382 - app.main - INFO - 导入基本路由成功
2025-04-09 07:15:32,881 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-09 07:15:32,882 - app.main - INFO - 导入utils成功
2025-04-09 07:15:32,882 - app.main - INFO - 导入dependencies成功
2025-04-09 07:15:32,882 - app.main - INFO - 创建数据库表...
2025-04-09 07:15:32,882 - app.main - INFO - 数据库表创建成功
2025-04-09 07:15:32,882 - app.main - INFO - 初始化FastAPI应用...
2025-04-09 07:15:32,885 - backend.app.utils - WARNING - 从数据库读取版本信息失败: Could not determine join condition between parent/child tables on relationship Flow.chats - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.
2025-04-09 07:15:32,885 - backend.app.utils - INFO - 从环境变量获取版本信息: 0.3.4
2025-04-09 07:15:32,886 - app.main - INFO - 注册路由...
2025-04-09 07:15:32,890 - app.main - INFO - 注册user路由成功
2025-04-09 07:15:32,895 - app.main - INFO - 注册flow路由成功
2025-04-09 07:15:32,896 - app.main - INFO - 注册email路由成功
2025-04-09 07:15:32,896 - app.main - INFO - 注册auth路由成功
2025-04-09 07:15:32,896 - app.main - INFO - 注册node_templates路由成功
2025-04-09 07:15:32,896 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-09 07:15:32,905 - app.main - INFO - 注册flow_variables路由成功
2025-04-09 07:15:32,905 - app.main - INFO - 注册chat路由成功
2025-04-09 07:15:32,905 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-09 07:15:32,907 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-09 07:15:32,907 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-09 07:15:32,907 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-09 07:15:32,907 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-09 07:15:32,907 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-09 07:15:32,907 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-09 07:15:32,907 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-09 07:15:32,938 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-09 07:15:32,938 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-09 07:15:32,938 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-09 07:15:32,938 - backend.app.startup - INFO - API前缀: /api
2025-04-09 07:15:32,938 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-09 07:15:57,187 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-09 07:15:57,187 - app.main - INFO - 开始导入模块...
2025-04-09 07:15:57,187 - app.main - INFO - 导入database成功
2025-04-09 07:15:57,187 - app.main - INFO - 导入models成功
2025-04-09 07:15:57,187 - app.main - INFO - 导入config成功
2025-04-09 07:15:57,269 - app.main - INFO - 导入基本路由成功
2025-04-09 07:15:57,742 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-09 07:15:57,742 - app.main - INFO - 导入utils成功
2025-04-09 07:15:57,742 - app.main - INFO - 导入dependencies成功
2025-04-09 07:15:57,742 - app.main - INFO - 创建数据库表...
2025-04-09 07:15:57,742 - app.main - INFO - 数据库表创建成功
2025-04-09 07:15:57,743 - app.main - INFO - 初始化FastAPI应用...
2025-04-09 07:15:57,746 - backend.app.utils - WARNING - 从数据库读取版本信息失败: Could not determine join condition between parent/child tables on relationship Flow.chats - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.
2025-04-09 07:15:57,746 - backend.app.utils - INFO - 从环境变量获取版本信息: 0.3.4
2025-04-09 07:15:57,746 - app.main - INFO - 注册路由...
2025-04-09 07:15:57,750 - app.main - INFO - 注册user路由成功
2025-04-09 07:15:57,755 - app.main - INFO - 注册flow路由成功
2025-04-09 07:15:57,756 - app.main - INFO - 注册email路由成功
2025-04-09 07:15:57,756 - app.main - INFO - 注册auth路由成功
2025-04-09 07:15:57,757 - app.main - INFO - 注册node_templates路由成功
2025-04-09 07:15:57,757 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-09 07:15:57,766 - app.main - INFO - 注册flow_variables路由成功
2025-04-09 07:15:57,766 - app.main - INFO - 注册chat路由成功
2025-04-09 07:15:57,766 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-09 07:15:57,767 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-09 07:15:57,767 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-09 07:15:57,767 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-09 07:15:57,767 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-09 07:15:57,767 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-09 07:15:57,767 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-09 07:15:57,768 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-09 07:15:57,798 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-09 07:15:57,799 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-09 07:15:57,799 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-09 07:15:57,799 - backend.app.startup - INFO - API前缀: /api
2025-04-09 07:15:57,799 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-09 07:17:12,412 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:17:12,414 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:17:12,415 - app.main - ERROR - 请求处理出错: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Flow(flows)]'. Original exception was: Could not determine join condition between parent/child tables on relationship Flow.chats - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table. (耗时: 0.0029s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
  File "/workspace/backend/app/utils.py", line 75, in get_current_user
    user = db.query(User).filter(User.username == token_data.username).first()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2800, in query
    return self._query_cls(entities, self, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 273, in __init__
    self._set_entities(entities)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 282, in _set_entities
    self._raw_columns = [
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 283, in <listcomp>
    coercions.expect(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/sql/coercions.py", line 406, in expect
    insp._post_inspect
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2681, in _post_inspect
    self._check_configure()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2362, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4177, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4215, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Flow(flows)]'. Original exception was: Could not determine join condition between parent/child tables on relationship Flow.chats - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.
2025-04-09 07:17:12,428 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-09 07:17:12,430 - app.main - ERROR - 请求处理出错: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Flow(flows)]'. Original exception was: Could not determine join condition between parent/child tables on relationship Flow.chats - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table. (耗时: 0.0159s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
  File "/workspace/backend/app/utils.py", line 75, in get_current_user
    user = db.query(User).filter(User.username == token_data.username).first()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2800, in query
    return self._query_cls(entities, self, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 273, in __init__
    self._set_entities(entities)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 282, in _set_entities
    self._raw_columns = [
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 283, in <listcomp>
    coercions.expect(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/sql/coercions.py", line 406, in expect
    insp._post_inspect
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2681, in _post_inspect
    self._check_configure()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2362, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4177, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4215, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Flow(flows)]'. Original exception was: Could not determine join condition between parent/child tables on relationship Flow.chats - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.
2025-04-09 07:17:12,431 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:17:12,432 - app.main - ERROR - 请求处理出错: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Flow(flows)]'. Original exception was: Could not determine join condition between parent/child tables on relationship Flow.chats - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table. (耗时: 0.0037s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
  File "/workspace/backend/app/utils.py", line 75, in get_current_user
    user = db.query(User).filter(User.username == token_data.username).first()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2800, in query
    return self._query_cls(entities, self, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 273, in __init__
    self._set_entities(entities)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 282, in _set_entities
    self._raw_columns = [
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 283, in <listcomp>
    coercions.expect(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/sql/coercions.py", line 406, in expect
    insp._post_inspect
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2681, in _post_inspect
    self._check_configure()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2362, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4177, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4215, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Flow(flows)]'. Original exception was: Could not determine join condition between parent/child tables on relationship Flow.chats - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.
2025-04-09 07:17:12,433 - app.main - ERROR - 请求处理出错: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Flow(flows)]'. Original exception was: Could not determine join condition between parent/child tables on relationship Flow.chats - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table. (耗时: 0.0023s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
  File "/workspace/backend/app/utils.py", line 75, in get_current_user
    user = db.query(User).filter(User.username == token_data.username).first()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2800, in query
    return self._query_cls(entities, self, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 273, in __init__
    self._set_entities(entities)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 282, in _set_entities
    self._raw_columns = [
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 283, in <listcomp>
    coercions.expect(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/sql/coercions.py", line 406, in expect
    insp._post_inspect
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2681, in _post_inspect
    self._check_configure()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2362, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4177, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4215, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Flow(flows)]'. Original exception was: Could not determine join condition between parent/child tables on relationship Flow.chats - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.
2025-04-09 07:17:14,438 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:17:14,444 - app.main - ERROR - 请求处理出错: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Flow(flows)]'. Original exception was: Could not determine join condition between parent/child tables on relationship Flow.chats - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table. (耗时: 0.0053s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 291, in app
    solved_result = await solve_dependencies(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/dependencies/utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
  File "/workspace/backend/app/utils.py", line 75, in get_current_user
    user = db.query(User).filter(User.username == token_data.username).first()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2800, in query
    return self._query_cls(entities, self, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 273, in __init__
    self._set_entities(entities)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 282, in _set_entities
    self._raw_columns = [
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 283, in <listcomp>
    coercions.expect(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/sql/coercions.py", line 406, in expect
    insp._post_inspect
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2681, in _post_inspect
    self._check_configure()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2362, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4177, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4215, in _do_configure_registries
    raise e
sqlalchemy.exc.InvalidRequestError: One or more mappers failed to initialize - can't proceed with initialization of other mappers. Triggering mapper: 'Mapper[Flow(flows)]'. Original exception was: Could not determine join condition between parent/child tables on relationship Flow.chats - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.
2025-04-09 07:20:14,111 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-09 07:20:14,112 - app.main - INFO - 开始导入模块...
2025-04-09 07:20:14,112 - app.main - INFO - 导入database成功
2025-04-09 07:20:14,112 - app.main - INFO - 导入models成功
2025-04-09 07:20:14,112 - app.main - INFO - 导入config成功
2025-04-09 07:20:14,189 - app.main - INFO - 导入基本路由成功
2025-04-09 07:20:14,644 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-09 07:20:14,644 - app.main - INFO - 导入utils成功
2025-04-09 07:20:14,644 - app.main - INFO - 导入dependencies成功
2025-04-09 07:20:14,644 - app.main - INFO - 创建数据库表...
2025-04-09 07:20:14,645 - app.main - INFO - 数据库表创建成功
2025-04-09 07:20:14,645 - app.main - INFO - 初始化FastAPI应用...
2025-04-09 07:20:14,651 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:20:14,652 - app.main - INFO - 注册路由...
2025-04-09 07:20:14,656 - app.main - INFO - 注册user路由成功
2025-04-09 07:20:14,661 - app.main - INFO - 注册flow路由成功
2025-04-09 07:20:14,662 - app.main - INFO - 注册email路由成功
2025-04-09 07:20:14,663 - app.main - INFO - 注册auth路由成功
2025-04-09 07:20:14,663 - app.main - INFO - 注册node_templates路由成功
2025-04-09 07:20:14,663 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-09 07:20:14,672 - app.main - INFO - 注册flow_variables路由成功
2025-04-09 07:20:14,672 - app.main - INFO - 注册chat路由成功
2025-04-09 07:20:14,672 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-09 07:20:14,673 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-09 07:20:14,673 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-09 07:20:14,673 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-09 07:20:14,673 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-09 07:20:14,673 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-09 07:20:14,673 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-09 07:20:14,673 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-09 07:20:14,704 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-09 07:20:14,704 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-09 07:20:14,704 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-09 07:20:14,704 - backend.app.startup - INFO - API前缀: /api
2025-04-09 07:20:14,704 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-09 07:24:24,051 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-09 07:24:24,051 - app.main - INFO - 开始导入模块...
2025-04-09 07:24:24,051 - app.main - INFO - 导入database成功
2025-04-09 07:24:24,051 - app.main - INFO - 导入models成功
2025-04-09 07:24:24,051 - app.main - INFO - 导入config成功
2025-04-09 07:24:24,132 - app.main - INFO - 导入基本路由成功
2025-04-09 07:24:24,610 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-09 07:24:24,610 - app.main - INFO - 导入utils成功
2025-04-09 07:24:24,610 - app.main - INFO - 导入dependencies成功
2025-04-09 07:24:24,610 - app.main - INFO - 创建数据库表...
2025-04-09 07:24:24,611 - app.main - INFO - 数据库表创建成功
2025-04-09 07:24:24,611 - app.main - INFO - 初始化FastAPI应用...
2025-04-09 07:24:24,617 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:24:24,618 - app.main - INFO - 注册路由...
2025-04-09 07:24:24,622 - app.main - INFO - 注册user路由成功
2025-04-09 07:24:24,627 - app.main - INFO - 注册flow路由成功
2025-04-09 07:24:24,628 - app.main - INFO - 注册email路由成功
2025-04-09 07:24:24,629 - app.main - INFO - 注册auth路由成功
2025-04-09 07:24:24,629 - app.main - INFO - 注册node_templates路由成功
2025-04-09 07:24:24,629 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-09 07:24:24,638 - app.main - INFO - 注册flow_variables路由成功
2025-04-09 07:24:24,638 - app.main - INFO - 注册chat路由成功
2025-04-09 07:24:24,638 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-09 07:24:24,639 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-09 07:24:24,639 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-09 07:24:24,639 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-09 07:24:24,639 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-09 07:24:24,639 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-09 07:24:24,639 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-09 07:24:24,639 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-09 07:24:24,671 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-09 07:24:24,671 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-09 07:24:24,671 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-09 07:24:24,671 - backend.app.startup - INFO - API前缀: /api
2025-04-09 07:24:24,671 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-09 07:24:34,373 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-09 07:24:34,374 - app.main - INFO - 开始导入模块...
2025-04-09 07:24:34,374 - app.main - INFO - 导入database成功
2025-04-09 07:24:34,374 - app.main - INFO - 导入models成功
2025-04-09 07:24:34,374 - app.main - INFO - 导入config成功
2025-04-09 07:24:34,455 - app.main - INFO - 导入基本路由成功
2025-04-09 07:24:34,935 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-09 07:24:34,935 - app.main - INFO - 导入utils成功
2025-04-09 07:24:34,935 - app.main - INFO - 导入dependencies成功
2025-04-09 07:24:34,935 - app.main - INFO - 创建数据库表...
2025-04-09 07:24:34,936 - app.main - INFO - 数据库表创建成功
2025-04-09 07:24:34,936 - app.main - INFO - 初始化FastAPI应用...
2025-04-09 07:24:34,942 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:24:34,943 - app.main - INFO - 注册路由...
2025-04-09 07:24:34,947 - app.main - INFO - 注册user路由成功
2025-04-09 07:24:34,952 - app.main - INFO - 注册flow路由成功
2025-04-09 07:24:34,954 - app.main - INFO - 注册email路由成功
2025-04-09 07:24:34,954 - app.main - INFO - 注册auth路由成功
2025-04-09 07:24:34,955 - app.main - INFO - 注册node_templates路由成功
2025-04-09 07:24:34,955 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-09 07:24:34,963 - app.main - INFO - 注册flow_variables路由成功
2025-04-09 07:24:34,964 - app.main - INFO - 注册chat路由成功
2025-04-09 07:24:34,964 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-09 07:24:34,965 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-09 07:24:34,965 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-09 07:24:34,965 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-09 07:24:34,965 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-09 07:24:34,965 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-09 07:24:34,965 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-09 07:24:34,965 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-09 07:24:34,996 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-09 07:24:34,996 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-09 07:24:34,996 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-09 07:24:34,996 - backend.app.startup - INFO - API前缀: /api
2025-04-09 07:24:34,996 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-09 07:24:48,193 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:24:48,199 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-09 07:24:48,199 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:24:48,199 - app.main - ERROR - 请求处理出错: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - (sqlite3.OperationalError) no such column: flows.last_interacted_chat_id
[SQL: SELECT flows.id AS flows_id, flows.flow_data AS flows_flow_data, flows.owner_id AS flows_owner_id, flows.created_at AS flows_created_at, flows.updated_at AS flows_updated_at, flows.name AS flows_name, flows.last_interacted_chat_id AS flows_last_interacted_chat_id 
FROM flows 
WHERE flows.id = ?
 LIMIT ? OFFSET ?]
[parameters: ('61751c36-5c34-4dcb-90ac-73480ce54638', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8) (耗时: 0.0062s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1968, in _exec_single_context
    self.dialect.do_execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 920, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: flows.last_interacted_chat_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/flow.py", line 61, in update_flow
    db_flow = verify_flow_ownership(flow_id, current_user, db)
  File "/workspace/backend/app/utils.py", line 117, in verify_flow_ownership
    flow = db.query(Flow).filter(Flow.id == flow_id).first()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2747, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2846, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2232, in execute
    return self._execute_internal(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2127, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1413, in execute
    return meth(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 483, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1987, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1968, in _exec_single_context
    self.dialect.do_execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 920, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: flows.last_interacted_chat_id
[SQL: SELECT flows.id AS flows_id, flows.flow_data AS flows_flow_data, flows.owner_id AS flows_owner_id, flows.created_at AS flows_created_at, flows.updated_at AS flows_updated_at, flows.name AS flows_name, flows.last_interacted_chat_id AS flows_last_interacted_chat_id 
FROM flows 
WHERE flows.id = ?
 LIMIT ? OFFSET ?]
[parameters: ('61751c36-5c34-4dcb-90ac-73480ce54638', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-04-09 07:24:48,215 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:24:48,215 - backend.app.routers.flow - ERROR - Unexpected error getting last chat ID for flow 61751c36-5c34-4dcb-90ac-73480ce54638
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1968, in _exec_single_context
    self.dialect.do_execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 920, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: flows.last_interacted_chat_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/backend/app/routers/flow.py", line 153, in get_flow_last_chat_id
    flow = verify_flow_ownership(flow_id, current_user, db) # Re-use ownership verification
  File "/workspace/backend/app/utils.py", line 117, in verify_flow_ownership
    flow = db.query(Flow).filter(Flow.id == flow_id).first()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2747, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2846, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2232, in execute
    return self._execute_internal(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2127, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1413, in execute
    return meth(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 483, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1987, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1968, in _exec_single_context
    self.dialect.do_execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 920, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: flows.last_interacted_chat_id
[SQL: SELECT flows.id AS flows_id, flows.flow_data AS flows_flow_data, flows.owner_id AS flows_owner_id, flows.created_at AS flows_created_at, flows.updated_at AS flows_updated_at, flows.name AS flows_name, flows.last_interacted_chat_id AS flows_last_interacted_chat_id 
FROM flows 
WHERE flows.id = ?
 LIMIT ? OFFSET ?]
[parameters: ('61751c36-5c34-4dcb-90ac-73480ce54638', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-04-09 07:24:48,217 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 500 (耗时: 0.0183s)
2025-04-09 07:24:48,218 - app.main - ERROR - 请求处理出错: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - (sqlite3.OperationalError) no such column: flows.last_interacted_chat_id
[SQL: SELECT flows.id AS flows_id, flows.flow_data AS flows_flow_data, flows.owner_id AS flows_owner_id, flows.created_at AS flows_created_at, flows.updated_at AS flows_updated_at, flows.name AS flows_name, flows.last_interacted_chat_id AS flows_last_interacted_chat_id 
FROM flows 
WHERE flows.id = ?
 LIMIT ? OFFSET ?]
[parameters: ('61751c36-5c34-4dcb-90ac-73480ce54638', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8) (耗时: 0.0188s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1968, in _exec_single_context
    self.dialect.do_execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 920, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: flows.last_interacted_chat_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/flow.py", line 61, in update_flow
    db_flow = verify_flow_ownership(flow_id, current_user, db)
  File "/workspace/backend/app/utils.py", line 117, in verify_flow_ownership
    flow = db.query(Flow).filter(Flow.id == flow_id).first()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2747, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2846, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2232, in execute
    return self._execute_internal(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2127, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1413, in execute
    return meth(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 483, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1987, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1968, in _exec_single_context
    self.dialect.do_execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 920, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: flows.last_interacted_chat_id
[SQL: SELECT flows.id AS flows_id, flows.flow_data AS flows_flow_data, flows.owner_id AS flows_owner_id, flows.created_at AS flows_created_at, flows.updated_at AS flows_updated_at, flows.name AS flows_name, flows.last_interacted_chat_id AS flows_last_interacted_chat_id 
FROM flows 
WHERE flows.id = ?
 LIMIT ? OFFSET ?]
[parameters: ('61751c36-5c34-4dcb-90ac-73480ce54638', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-04-09 07:24:48,234 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:24:48,237 - app.main - ERROR - 请求处理出错: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - (sqlite3.OperationalError) no such column: flows.last_interacted_chat_id
[SQL: SELECT flows.id AS flows_id, flows.flow_data AS flows_flow_data, flows.owner_id AS flows_owner_id, flows.created_at AS flows_created_at, flows.updated_at AS flows_updated_at, flows.name AS flows_name, flows.last_interacted_chat_id AS flows_last_interacted_chat_id 
FROM flows 
WHERE flows.id = ?
 LIMIT ? OFFSET ?]
[parameters: ('61751c36-5c34-4dcb-90ac-73480ce54638', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8) (耗时: 0.0029s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1968, in _exec_single_context
    self.dialect.do_execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 920, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: flows.last_interacted_chat_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/flow.py", line 47, in get_flow
    flow = verify_flow_ownership(flow_id, current_user, db)
  File "/workspace/backend/app/utils.py", line 117, in verify_flow_ownership
    flow = db.query(Flow).filter(Flow.id == flow_id).first()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2747, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2846, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2232, in execute
    return self._execute_internal(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2127, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1413, in execute
    return meth(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 483, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1987, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1968, in _exec_single_context
    self.dialect.do_execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 920, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: flows.last_interacted_chat_id
[SQL: SELECT flows.id AS flows_id, flows.flow_data AS flows_flow_data, flows.owner_id AS flows_owner_id, flows.created_at AS flows_created_at, flows.updated_at AS flows_updated_at, flows.name AS flows_name, flows.last_interacted_chat_id AS flows_last_interacted_chat_id 
FROM flows 
WHERE flows.id = ?
 LIMIT ? OFFSET ?]
[parameters: ('61751c36-5c34-4dcb-90ac-73480ce54638', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-04-09 07:24:50,211 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:24:50,217 - app.main - ERROR - 请求处理出错: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - (sqlite3.OperationalError) no such column: flows.last_interacted_chat_id
[SQL: SELECT flows.id AS flows_id, flows.flow_data AS flows_flow_data, flows.owner_id AS flows_owner_id, flows.created_at AS flows_created_at, flows.updated_at AS flows_updated_at, flows.name AS flows_name, flows.last_interacted_chat_id AS flows_last_interacted_chat_id 
FROM flows 
WHERE flows.id = ?
 LIMIT ? OFFSET ?]
[parameters: ('61751c36-5c34-4dcb-90ac-73480ce54638', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8) (耗时: 0.0055s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1968, in _exec_single_context
    self.dialect.do_execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 920, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: no such column: flows.last_interacted_chat_id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/flow.py", line 61, in update_flow
    db_flow = verify_flow_ownership(flow_id, current_user, db)
  File "/workspace/backend/app/utils.py", line 117, in verify_flow_ownership
    flow = db.query(Flow).filter(Flow.id == flow_id).first()
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2747, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2846, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2232, in execute
    return self._execute_internal(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2127, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 293, in orm_execute_statement
    result = conn.execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1413, in execute
    return meth(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 483, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1987, in _exec_single_context
    self._handle_dbapi_exception(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2344, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1968, in _exec_single_context
    self.dialect.do_execute(
  File "/home/vscode/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 920, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: flows.last_interacted_chat_id
[SQL: SELECT flows.id AS flows_id, flows.flow_data AS flows_flow_data, flows.owner_id AS flows_owner_id, flows.created_at AS flows_created_at, flows.updated_at AS flows_updated_at, flows.name AS flows_name, flows.last_interacted_chat_id AS flows_last_interacted_chat_id 
FROM flows 
WHERE flows.id = ?
 LIMIT ? OFFSET ?]
[parameters: ('61751c36-5c34-4dcb-90ac-73480ce54638', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-04-09 07:28:55,606 - app.main - INFO - 收到请求: GET /favicon.ico (来自: 172.19.0.1)
2025-04-09 07:28:55,606 - app.main - INFO - 请求完成: GET /favicon.ico - 404 (耗时: 0.0004s)
2025-04-09 07:28:55,636 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 07:28:55,639 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 07:28:55,689 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0523s)
2025-04-09 07:28:55,691 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0020s)
2025-04-09 07:28:55,712 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:28:55,712 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-09 07:28:55,716 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:28:55,719 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 07:28:55,721 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0046s)
2025-04-09 07:28:55,776 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:28:55,780 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:28:55,781 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:28:55,781 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0047s)
2025-04-09 07:28:55,782 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0011s)
2025-04-09 07:28:55,784 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:28:55,785 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:28:55,785 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0008s)
2025-04-09 07:28:55,791 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:28:55,795 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 07:28:55,796 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-09 07:28:55,797 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:28:55,798 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-09 07:28:55,798 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0062s)
2025-04-09 07:28:55,799 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:28:55,800 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-09 07:28:55,802 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 07:28:55,803 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:28:55,803 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-09 07:28:55,803 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0069s)
2025-04-09 07:28:55,804 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0065s)
2025-04-09 07:28:55,804 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0065s)
2025-04-09 07:28:55,898 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:28:55,901 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0031s)
2025-04-09 07:28:57,897 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:28:57,908 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0107s)
2025-04-09 07:29:05,804 - app.main - INFO - 收到请求: POST /users/login (来自: 172.19.0.1)
2025-04-09 07:29:06,004 - app.main - INFO - 请求完成: POST /users/login - 200 (耗时: 0.1990s)
2025-04-09 07:29:06,010 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 07:29:06,012 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0018s)
2025-04-09 07:29:06,078 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:29:06,079 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-09 07:29:06,090 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:29:06,091 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:29:06,091 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0013s)
2025-04-09 07:29:06,093 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:29:06,094 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:29:06,094 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0007s)
2025-04-09 07:29:06,113 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:29:06,114 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0004s)
2025-04-09 07:29:06,115 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:29:06,115 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-09 07:29:06,158 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:29:06,159 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:29:06,159 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0009s)
2025-04-09 07:29:06,163 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0047s)
2025-04-09 07:29:06,164 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:29:06,168 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:29:06,169 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0040s)
2025-04-09 07:29:06,172 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0035s)
2025-04-09 07:29:06,204 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:29:06,208 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0031s)
2025-04-09 07:29:07,788 - app.main - INFO - 收到请求: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected (来自: 172.19.0.1)
2025-04-09 07:29:07,801 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 07:29:07,802 - app.main - INFO - 请求完成: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected - 200 (耗时: 0.0132s)
2025-04-09 07:29:07,835 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 07:29:07,841 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 07:29:07,843 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0074s)
2025-04-09 07:29:07,890 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:29:07,891 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:29:07,891 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0011s)
2025-04-09 07:29:07,892 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:29:07,893 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:29:07,893 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0008s)
2025-04-09 07:29:07,906 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 07:29:07,908 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 07:29:07,909 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 07:29:07,910 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0044s)
2025-04-09 07:29:07,913 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 07:29:07,914 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-09 07:29:07,916 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:29:07,916 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-09 07:29:07,917 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-09 07:29:07,917 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0074s)
2025-04-09 07:29:07,918 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:29:07,918 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-09 07:29:07,918 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0042s)
2025-04-09 07:29:07,919 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0023s)
2025-04-09 07:29:08,009 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 07:29:08,014 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0043s)
2025-04-09 07:29:09,972 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 07:29:09,982 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0097s)
2025-04-09 07:29:45,945 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:29:45,945 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-09 07:29:45,949 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:29:45,952 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0029s)
2025-04-09 07:29:48,304 - app.main - INFO - 收到请求: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected (来自: 172.19.0.1)
2025-04-09 07:29:48,306 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-09 07:29:48,306 - app.main - INFO - 请求完成: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected - 200 (耗时: 0.0023s)
2025-04-09 07:29:50,569 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:29:50,569 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-09 07:29:50,580 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:29:50,584 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0030s)
2025-04-09 07:29:51,464 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:29:51,477 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 07:29:51,478 - app.main - INFO - 收到请求: POST /flows/61751c36-5c34-4dcb-90ac-73480ce54638/set-as-last-selected (来自: 172.19.0.1)
2025-04-09 07:29:51,478 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-09 07:29:51,479 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0145s)
2025-04-09 07:29:51,481 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 07:29:51,484 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0049s)
2025-04-09 07:29:51,484 - app.main - INFO - 请求完成: POST /flows/61751c36-5c34-4dcb-90ac-73480ce54638/set-as-last-selected - 200 (耗时: 0.0055s)
2025-04-09 07:29:51,500 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:29:51,500 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:29:51,501 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-09 07:29:51,506 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:29:51,507 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:29:51,507 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-09 07:29:51,512 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:29:51,514 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 07:29:51,515 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-09 07:29:51,515 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:29:51,516 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0036s)
2025-04-09 07:29:51,517 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:29:51,517 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-09 07:29:51,518 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-09 07:29:51,519 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0043s)
2025-04-09 07:29:51,520 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0048s)
2025-04-09 07:29:51,530 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-09 07:29:51,532 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:29:51,532 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-09 07:29:51,533 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0021s)
2025-04-09 07:29:51,573 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:29:51,576 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0028s)
2025-04-09 07:29:53,579 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:29:53,599 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0199s)
2025-04-09 07:29:59,979 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:29:59,980 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-09 07:29:59,984 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:29:59,987 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0031s)
2025-04-09 07:30:01,389 - app.main - INFO - 收到请求: POST /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640/set-as-last-selected (来自: 172.19.0.1)
2025-04-09 07:30:01,394 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-09 07:30:01,395 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-09 07:30:01,395 - app.main - INFO - 请求完成: POST /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640/set-as-last-selected - 200 (耗时: 0.0055s)
2025-04-09 07:30:01,397 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0027s)
2025-04-09 07:30:01,433 - app.main - INFO - 收到请求: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:01,439 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-09 07:30:01,440 - app.main - INFO - 请求完成: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0067s)
2025-04-09 07:30:01,485 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:30:01,486 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:30:01,487 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0012s)
2025-04-09 07:30:01,488 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:30:01,489 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:30:01,489 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0007s)
2025-04-09 07:30:01,497 - app.main - INFO - 收到请求: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:01,499 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-09 07:30:01,500 - app.main - INFO - 请求完成: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0036s)
2025-04-09 07:30:01,505 - app.main - INFO - 收到请求: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:01,507 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-09 07:30:01,508 - app.main - INFO - 收到请求: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640/last_chat (来自: 172.19.0.1)
2025-04-09 07:30:01,509 - app.main - INFO - 请求完成: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0035s)
2025-04-09 07:30:01,510 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: ed10ef28-ad53-41c0-860f-f359e3ea9640 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:30:01,510 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-09 07:30:01,510 - app.main - INFO - 请求完成: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640/last_chat - 200 (耗时: 0.0021s)
2025-04-09 07:30:01,550 - app.main - INFO - 收到请求: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640/last_chat (来自: 172.19.0.1)
2025-04-09 07:30:01,552 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: ed10ef28-ad53-41c0-860f-f359e3ea9640 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:30:01,552 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-09 07:30:01,553 - app.main - INFO - 请求完成: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640/last_chat - 200 (耗时: 0.0021s)
2025-04-09 07:30:01,617 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:01,635 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0179s)
2025-04-09 07:30:03,559 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:03,566 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0070s)
2025-04-09 07:30:04,131 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,134 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0027s)
2025-04-09 07:30:04,148 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,161 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0132s)
2025-04-09 07:30:04,165 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,170 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0048s)
2025-04-09 07:30:04,187 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,196 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,196 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0090s)
2025-04-09 07:30:04,201 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0048s)
2025-04-09 07:30:04,209 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,214 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0046s)
2025-04-09 07:30:04,223 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,228 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0052s)
2025-04-09 07:30:04,259 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,260 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,269 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0090s)
2025-04-09 07:30:04,269 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0100s)
2025-04-09 07:30:04,277 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,281 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0042s)
2025-04-09 07:30:04,290 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,294 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0044s)
2025-04-09 07:30:04,310 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,315 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0050s)
2025-04-09 07:30:04,336 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,341 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,342 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0054s)
2025-04-09 07:30:04,347 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0049s)
2025-04-09 07:30:04,359 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,363 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0045s)
2025-04-09 07:30:04,373 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,378 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0050s)
2025-04-09 07:30:04,389 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,393 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0035s)
2025-04-09 07:30:04,411 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:04,414 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0028s)
2025-04-09 07:30:06,188 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:30:06,188 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-09 07:30:06,191 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:30:06,194 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0027s)
2025-04-09 07:30:06,408 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:06,412 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0032s)
2025-04-09 07:30:09,888 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-09 07:30:09,891 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0028s)
2025-04-09 07:30:09,892 - app.main - INFO - 收到请求: POST /flows/30a17510-07bf-4371-aa18-6583ad908aa4/set-as-last-selected (来自: 172.19.0.1)
2025-04-09 07:30:09,904 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:30:09,904 - app.main - INFO - 请求完成: POST /flows/30a17510-07bf-4371-aa18-6583ad908aa4/set-as-last-selected - 200 (耗时: 0.0127s)
2025-04-09 07:30:09,955 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:30:09,959 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:30:09,960 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0041s)
2025-04-09 07:30:09,985 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:30:09,986 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:30:09,986 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-09 07:30:09,988 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:30:09,989 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:30:09,990 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0019s)
2025-04-09 07:30:09,998 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:30:10,001 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:30:10,002 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:30:10,003 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0044s)
2025-04-09 07:30:10,005 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:30:10,007 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:30:10,008 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0054s)
2025-04-09 07:30:10,009 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:30:10,009 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-09 07:30:10,010 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0026s)
2025-04-09 07:30:10,048 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:30:10,050 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:30:10,050 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-09 07:30:10,051 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0022s)
2025-04-09 07:30:10,079 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:30:10,083 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0032s)
2025-04-09 07:30:12,236 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:30:12,246 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0095s)
2025-04-09 07:30:19,078 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 07:30:19,080 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 07:30:19,080 - backend.app.routers.chat - INFO - 验证 flow ownership: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:30:19,081 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:30:19,081 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-09 07:30:19,096 - backend.app.services.chat_service - INFO - 已为流程图 30a17510-07bf-4371-aa18-6583ad908aa4 创建聊天 f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:30:19,096 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=f62bebc3-bf7e-40a1-852b-211a6bde00ff, name='新聊天', flow_id=30a17510-07bf-4371-aa18-6583ad908aa4)>
2025-04-09 07:30:19,100 - backend.app.routers.chat - INFO - 更新 Flow 30a17510-07bf-4371-aa18-6583ad908aa4 的 last_interacted_chat_id 为 f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:30:19,100 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:30:19,101 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0230s)
2025-04-09 07:30:19,144 - app.main - INFO - 收到请求: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:30:19,147 - app.main - INFO - 请求完成: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0028s)
2025-04-09 07:30:24,717 - app.main - INFO - 收到请求: POST /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff/messages (来自: 172.19.0.1)
2025-04-09 07:30:24,720 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 linked to chat: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:30:24,723 - backend.app.services.chat_service - INFO - 已向聊天 f62bebc3-bf7e-40a1-852b-211a6bde00ff 添加一条 user 消息
2025-04-09 07:30:24,726 - backend.app.routers.chat - INFO - 更新 Flow 30a17510-07bf-4371-aa18-6583ad908aa4 的 last_interacted_chat_id 为 f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:30:24,726 - app.main - INFO - 请求完成: POST /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff/messages - 200 (耗时: 0.0095s)
2025-04-09 07:30:43,492 - app.main - INFO - 收到请求: POST /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff/messages (来自: 172.19.0.1)
2025-04-09 07:30:43,495 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 linked to chat: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:30:43,498 - backend.app.services.chat_service - INFO - 已向聊天 f62bebc3-bf7e-40a1-852b-211a6bde00ff 添加一条 user 消息
2025-04-09 07:30:43,502 - backend.app.routers.chat - INFO - 更新 Flow 30a17510-07bf-4371-aa18-6583ad908aa4 的 last_interacted_chat_id 为 f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:30:43,503 - app.main - INFO - 请求完成: POST /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff/messages - 200 (耗时: 0.0115s)
2025-04-09 07:30:56,136 - app.main - INFO - 收到请求: GET /favicon.ico (来自: 172.19.0.1)
2025-04-09 07:30:56,137 - app.main - INFO - 请求完成: GET /favicon.ico - 404 (耗时: 0.0002s)
2025-04-09 07:30:56,168 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 07:30:56,170 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 07:30:56,172 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0037s)
2025-04-09 07:30:56,172 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0025s)
2025-04-09 07:30:56,186 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:30:56,187 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-09 07:30:56,192 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:30:56,192 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:30:56,195 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:30:56,198 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0063s)
2025-04-09 07:30:56,199 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0061s)
2025-04-09 07:30:56,269 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:30:56,270 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:30:56,271 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0013s)
2025-04-09 07:30:56,272 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:30:56,273 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:30:56,273 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0012s)
2025-04-09 07:30:56,282 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:30:56,287 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:30:56,289 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0070s)
2025-04-09 07:30:56,294 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:30:56,295 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:30:56,297 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:30:56,299 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:30:56,299 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:30:56,300 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:30:56,300 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0062s)
2025-04-09 07:30:56,301 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:30:56,302 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:30:56,302 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0075s)
2025-04-09 07:30:56,303 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0031s)
2025-04-09 07:30:56,393 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:30:56,396 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0036s)
2025-04-09 07:30:57,744 - app.main - INFO - 收到请求: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:30:57,745 - app.main - INFO - 收到请求: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:30:57,749 - app.main - INFO - 请求完成: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0043s)
2025-04-09 07:30:57,749 - app.main - INFO - 请求完成: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0042s)
2025-04-09 07:30:58,384 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:30:58,390 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0062s)
2025-04-09 07:32:22,297 - app.main - INFO - 收到请求: GET /node-templates/ (来自: 172.19.0.1)
2025-04-09 07:32:22,298 - app.main - INFO - 请求完成: GET /node-templates/ - 200 (耗时: 0.0005s)
2025-04-09 07:32:22,298 - app.main - INFO - 收到请求: GET /node-templates/ (来自: 172.19.0.1)
2025-04-09 07:32:22,299 - app.main - INFO - 请求完成: GET /node-templates/ - 200 (耗时: 0.0003s)
2025-04-09 07:32:22,339 - app.main - INFO - 收到请求: GET /node-templates/ (来自: 172.19.0.1)
2025-04-09 07:32:22,340 - app.main - INFO - 请求完成: GET /node-templates/ - 200 (耗时: 0.0010s)
2025-04-09 07:32:24,702 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:32:24,707 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0045s)
2025-04-09 07:32:26,707 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:32:26,730 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0223s)
2025-04-09 07:45:38,357 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:45:38,358 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:45:38,363 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:45:38,364 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0073s)
2025-04-09 07:45:38,365 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0066s)
2025-04-09 07:45:38,366 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:45:38,367 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:45:38,368 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:45:38,369 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0035s)
2025-04-09 07:45:38,375 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:45:38,380 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0046s)
2025-04-09 07:45:38,407 - app.main - INFO - 收到请求: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:45:38,411 - app.main - INFO - 请求完成: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0036s)
2025-04-09 07:45:38,412 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:45:38,416 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0041s)
2025-04-09 07:45:38,441 - app.main - INFO - 收到请求: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:45:38,442 - app.main - INFO - 收到请求: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:45:38,447 - app.main - INFO - 请求完成: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0064s)
2025-04-09 07:45:38,448 - app.main - INFO - 请求完成: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0062s)
2025-04-09 07:45:40,462 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:45:40,475 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0127s)
2025-04-09 07:57:17,587 - app.main - INFO - 收到请求: GET /favicon.ico (来自: 172.19.0.1)
2025-04-09 07:57:17,587 - app.main - INFO - 请求完成: GET /favicon.ico - 404 (耗时: 0.0003s)
2025-04-09 07:57:17,617 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 07:57:17,619 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0018s)
2025-04-09 07:57:17,633 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:57:17,634 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-09 07:57:17,652 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:57:17,653 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:57:17,653 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-09 07:57:17,658 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:57:17,658 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:57:17,659 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-09 07:57:17,660 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 07:57:17,661 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0013s)
2025-04-09 07:57:17,723 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:57:17,723 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:57:17,723 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0005s)
2025-04-09 07:57:17,724 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0006s)
2025-04-09 07:57:17,729 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:57:17,732 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0031s)
2025-04-09 07:57:17,757 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:57:17,758 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-09 07:57:17,765 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:57:17,768 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0026s)
2025-04-09 07:57:17,770 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:57:17,774 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0039s)
2025-04-09 07:57:17,842 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:57:17,845 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0026s)
2025-04-09 07:57:18,645 - app.main - INFO - 收到请求: GET /main.043a1a8ace98851ba75c.hot-update.json (来自: 172.19.0.1)
2025-04-09 07:57:18,645 - app.main - INFO - 请求完成: GET /main.043a1a8ace98851ba75c.hot-update.json - 404 (耗时: 0.0003s)
2025-04-09 07:57:18,884 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 07:57:18,885 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 07:57:18,889 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0042s)
2025-04-09 07:57:18,890 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0042s)
2025-04-09 07:57:18,900 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:57:18,901 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-09 07:57:18,909 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:57:18,910 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:18,914 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:57:18,915 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0061s)
2025-04-09 07:57:18,916 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0059s)
2025-04-09 07:57:18,963 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:18,963 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:57:18,964 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:57:18,966 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:57:18,967 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0034s)
2025-04-09 07:57:18,967 - app.main - INFO - 收到请求: POST /flows/30a17510-07bf-4371-aa18-6583ad908aa4/set-as-last-selected (来自: 172.19.0.1)
2025-04-09 07:57:18,968 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:57:18,969 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:57:18,969 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0061s)
2025-04-09 07:57:18,969 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0012s)
2025-04-09 07:57:18,972 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:57:18,973 - app.main - INFO - 请求完成: POST /flows/30a17510-07bf-4371-aa18-6583ad908aa4/set-as-last-selected - 200 (耗时: 0.0053s)
2025-04-09 07:57:18,980 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:18,982 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:57:18,983 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:18,984 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0042s)
2025-04-09 07:57:18,987 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:57:18,988 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:57:18,990 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:57:18,991 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:57:18,991 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0072s)
2025-04-09 07:57:18,991 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0028s)
2025-04-09 07:57:19,024 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:57:19,025 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:57:19,026 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:57:19,026 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0018s)
2025-04-09 07:57:19,027 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:57:19,028 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0015s)
2025-04-09 07:57:19,034 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:57:19,036 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:57:19,037 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:57:19,038 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0029s)
2025-04-09 07:57:19,038 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:19,039 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:57:19,039 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:19,044 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:57:19,046 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:57:19,047 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:57:19,047 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:57:19,051 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:57:19,055 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:57:19,056 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:57:19,056 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0172s)
2025-04-09 07:57:19,056 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0180s)
2025-04-09 07:57:19,057 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0174s)
2025-04-09 07:57:19,057 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0099s)
2025-04-09 07:57:19,128 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:19,141 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0128s)
2025-04-09 07:57:21,121 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:21,134 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0126s)
2025-04-09 07:57:23,239 - app.main - INFO - 收到请求: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:57:23,240 - app.main - INFO - 收到请求: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:57:23,243 - app.main - INFO - 请求完成: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0033s)
2025-04-09 07:57:23,244 - app.main - INFO - 请求完成: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0041s)
2025-04-09 07:57:36,479 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:57:36,480 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:57:36,482 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:57:36,482 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:57:36,483 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:57:36,483 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:57:36,484 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0041s)
2025-04-09 07:57:36,484 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0037s)
2025-04-09 07:57:36,492 - app.main - INFO - 收到请求: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:36,493 - app.main - INFO - 收到请求: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:36,497 - app.main - INFO - 请求完成: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0044s)
2025-04-09 07:57:36,497 - app.main - INFO - 请求完成: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0052s)
2025-04-09 07:57:36,542 - app.main - INFO - 收到请求: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:57:36,543 - app.main - INFO - 收到请求: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:57:36,550 - app.main - INFO - 请求完成: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0079s)
2025-04-09 07:57:36,552 - app.main - INFO - 请求完成: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0077s)
2025-04-09 07:57:36,570 - app.main - INFO - 收到请求: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:57:36,572 - app.main - INFO - 请求完成: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0025s)
2025-04-09 07:57:39,629 - app.main - INFO - 收到请求: GET /favicon.ico (来自: 172.19.0.1)
2025-04-09 07:57:39,629 - app.main - INFO - 请求完成: GET /favicon.ico - 404 (耗时: 0.0002s)
2025-04-09 07:57:39,652 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 07:57:39,653 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 07:57:39,655 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0023s)
2025-04-09 07:57:39,655 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0033s)
2025-04-09 07:57:39,663 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 07:57:39,664 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:39,664 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0007s)
2025-04-09 07:57:39,667 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:57:39,668 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 07:57:39,668 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0041s)
2025-04-09 07:57:39,671 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0029s)
2025-04-09 07:57:39,704 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:57:39,705 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:57:39,705 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-09 07:57:39,706 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 07:57:39,707 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 07:57:39,707 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0006s)
2025-04-09 07:57:39,725 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:39,729 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:57:39,730 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:39,731 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:57:39,732 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:57:39,732 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0069s)
2025-04-09 07:57:39,734 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:57:39,735 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:57:39,735 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:57:39,736 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:57:39,737 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:57:39,737 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0062s)
2025-04-09 07:57:39,737 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0062s)
2025-04-09 07:57:39,738 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0056s)
2025-04-09 07:57:39,832 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:39,835 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0032s)
2025-04-09 07:57:41,505 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:57:41,506 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 07:57:41,508 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:57:41,509 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:57:41,509 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 07:57:41,510 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:57:41,510 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0044s)
2025-04-09 07:57:41,511 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0052s)
2025-04-09 07:57:41,516 - app.main - INFO - 收到请求: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:41,517 - app.main - INFO - 收到请求: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:41,521 - app.main - INFO - 请求完成: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0047s)
2025-04-09 07:57:41,521 - app.main - INFO - 请求完成: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0045s)
2025-04-09 07:57:41,566 - app.main - INFO - 收到请求: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:57:41,567 - app.main - INFO - 收到请求: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:57:41,570 - app.main - INFO - 请求完成: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0037s)
2025-04-09 07:57:41,570 - app.main - INFO - 请求完成: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0034s)
2025-04-09 07:57:41,583 - app.main - INFO - 收到请求: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:57:41,587 - app.main - INFO - 请求完成: GET /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0033s)
2025-04-09 07:57:41,836 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:41,847 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0113s)
2025-04-09 07:57:47,323 - app.main - INFO - 收到请求: DELETE /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff (来自: 172.19.0.1)
2025-04-09 07:57:47,341 - backend.app.services.chat_service - INFO - 已删除聊天 f62bebc3-bf7e-40a1-852b-211a6bde00ff
2025-04-09 07:57:47,342 - app.main - INFO - 请求完成: DELETE /chats/f62bebc3-bf7e-40a1-852b-211a6bde00ff - 200 (耗时: 0.0188s)
2025-04-09 07:57:47,346 - app.main - INFO - 收到请求: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:47,349 - app.main - INFO - 请求完成: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0031s)
2025-04-09 07:57:53,330 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 07:57:53,331 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 07:57:53,332 - backend.app.routers.chat - INFO - 验证 flow ownership: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:57:53,332 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:57:53,332 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-09 07:57:53,345 - backend.app.services.chat_service - INFO - 已为流程图 30a17510-07bf-4371-aa18-6583ad908aa4 创建聊天 6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b
2025-04-09 07:57:53,345 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b, name='新聊天', flow_id=30a17510-07bf-4371-aa18-6583ad908aa4)>
2025-04-09 07:57:53,351 - backend.app.routers.chat - INFO - 更新 Flow 30a17510-07bf-4371-aa18-6583ad908aa4 的 last_interacted_chat_id 为 6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b
2025-04-09 07:57:53,351 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: 6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b
2025-04-09 07:57:53,352 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0219s)
2025-04-09 07:57:53,358 - app.main - INFO - 收到请求: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:57:53,366 - app.main - INFO - 请求完成: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0070s)
2025-04-09 07:57:53,450 - app.main - INFO - 收到请求: GET /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b (来自: 172.19.0.1)
2025-04-09 07:57:53,452 - app.main - INFO - 请求完成: GET /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b - 200 (耗时: 0.0022s)
2025-04-09 07:57:56,411 - app.main - INFO - 收到请求: POST /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b/messages (来自: 172.19.0.1)
2025-04-09 07:57:56,413 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 linked to chat: 6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b
2025-04-09 07:57:56,416 - backend.app.services.chat_service - INFO - 已向聊天 6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b 添加一条 user 消息
2025-04-09 07:57:56,418 - backend.app.routers.chat - INFO - 更新 Flow 30a17510-07bf-4371-aa18-6583ad908aa4 的 last_interacted_chat_id 为 6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b
2025-04-09 07:57:56,419 - app.main - INFO - 请求完成: POST /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b/messages - 200 (耗时: 0.0077s)
2025-04-09 07:58:00,475 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-09 07:58:00,477 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-09 07:58:00,477 - backend.app.routers.chat - INFO - 验证 flow ownership: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:58:00,477 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 07:58:00,477 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-09 07:58:00,488 - backend.app.services.chat_service - INFO - 已为流程图 30a17510-07bf-4371-aa18-6583ad908aa4 创建聊天 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-09 07:58:00,488 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=8b728096-aeb5-4f52-beba-de36bd9c287c, name='新聊天', flow_id=30a17510-07bf-4371-aa18-6583ad908aa4)>
2025-04-09 07:58:00,491 - backend.app.routers.chat - INFO - 更新 Flow 30a17510-07bf-4371-aa18-6583ad908aa4 的 last_interacted_chat_id 为 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-09 07:58:00,491 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-09 07:58:00,492 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0165s)
2025-04-09 07:58:00,496 - app.main - INFO - 收到请求: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 07:58:00,499 - app.main - INFO - 请求完成: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0029s)
2025-04-09 07:58:00,576 - app.main - INFO - 收到请求: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c (来自: 172.19.0.1)
2025-04-09 07:58:00,579 - app.main - INFO - 请求完成: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c - 200 (耗时: 0.0023s)
2025-04-09 07:58:02,060 - app.main - INFO - 收到请求: GET /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b (来自: 172.19.0.1)
2025-04-09 07:58:02,063 - app.main - INFO - 请求完成: GET /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b - 200 (耗时: 0.0032s)
2025-04-09 07:58:02,466 - app.main - INFO - 收到请求: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c (来自: 172.19.0.1)
2025-04-09 07:58:02,469 - app.main - INFO - 请求完成: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c - 200 (耗时: 0.0024s)
2025-04-09 07:58:03,398 - app.main - INFO - 收到请求: GET /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b (来自: 172.19.0.1)
2025-04-09 07:58:03,400 - app.main - INFO - 请求完成: GET /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b - 200 (耗时: 0.0021s)
2025-04-09 07:58:03,686 - app.main - INFO - 收到请求: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c (来自: 172.19.0.1)
2025-04-09 07:58:03,689 - app.main - INFO - 请求完成: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c - 200 (耗时: 0.0023s)
2025-04-09 08:28:13,568 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-09 08:28:13,568 - app.main - INFO - 开始导入模块...
2025-04-09 08:28:13,568 - app.main - INFO - 导入database成功
2025-04-09 08:28:13,568 - app.main - INFO - 导入models成功
2025-04-09 08:28:13,568 - app.main - INFO - 导入config成功
2025-04-09 08:28:13,650 - app.main - INFO - 导入基本路由成功
2025-04-09 08:28:14,128 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-09 08:28:14,128 - app.main - INFO - 导入utils成功
2025-04-09 08:28:14,128 - app.main - INFO - 导入dependencies成功
2025-04-09 08:28:14,128 - app.main - INFO - 创建数据库表...
2025-04-09 08:28:14,129 - app.main - INFO - 数据库表创建成功
2025-04-09 08:28:14,129 - app.main - INFO - 初始化FastAPI应用...
2025-04-09 08:28:14,135 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 08:28:14,136 - app.main - INFO - 注册路由...
2025-04-09 08:28:14,140 - app.main - INFO - 注册user路由成功
2025-04-09 08:28:14,145 - app.main - INFO - 注册flow路由成功
2025-04-09 08:28:14,147 - app.main - INFO - 注册email路由成功
2025-04-09 08:28:14,147 - app.main - INFO - 注册auth路由成功
2025-04-09 08:28:14,147 - app.main - INFO - 注册node_templates路由成功
2025-04-09 08:28:14,147 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-09 08:28:14,156 - app.main - INFO - 注册flow_variables路由成功
2025-04-09 08:28:14,156 - app.main - INFO - 注册chat路由成功
2025-04-09 08:28:14,156 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-09 08:28:14,157 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-09 08:28:14,157 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-09 08:28:14,157 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-09 08:28:14,157 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-09 08:28:14,157 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-09 08:28:14,157 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-09 08:28:14,158 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-09 08:28:14,189 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-09 08:28:14,189 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-09 08:28:14,189 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-09 08:28:14,189 - backend.app.startup - INFO - API前缀: /api
2025-04-09 08:28:14,189 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-09 09:36:55,301 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-09 09:36:55,301 - app.main - INFO - 开始导入模块...
2025-04-09 09:36:55,301 - app.main - INFO - 导入database成功
2025-04-09 09:36:55,301 - app.main - INFO - 导入models成功
2025-04-09 09:36:55,301 - app.main - INFO - 导入config成功
2025-04-09 09:36:55,381 - app.main - INFO - 导入基本路由成功
2025-04-09 09:36:55,838 - app.main - ERROR - 导入workflow_router失败: No module named 'langchainchat.config'
2025-04-09 09:36:55,839 - app.main - INFO - 导入utils成功
2025-04-09 09:36:55,839 - app.main - INFO - 导入dependencies成功
2025-04-09 09:36:55,839 - app.main - INFO - 创建数据库表...
2025-04-09 09:36:55,839 - app.main - INFO - 数据库表创建成功
2025-04-09 09:36:55,839 - app.main - INFO - 初始化FastAPI应用...
2025-04-09 09:36:55,846 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 09:36:55,846 - app.main - INFO - 注册路由...
2025-04-09 09:36:55,850 - app.main - INFO - 注册user路由成功
2025-04-09 09:36:55,855 - app.main - INFO - 注册flow路由成功
2025-04-09 09:36:55,856 - app.main - INFO - 注册email路由成功
2025-04-09 09:36:55,857 - app.main - INFO - 注册auth路由成功
2025-04-09 09:36:55,857 - app.main - INFO - 注册node_templates路由成功
2025-04-09 09:36:55,857 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-09 09:36:55,866 - app.main - INFO - 注册flow_variables路由成功
2025-04-09 09:36:55,866 - app.main - INFO - 注册chat路由成功
2025-04-09 09:36:55,866 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-09 09:36:55,867 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-09 09:36:55,868 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-09 09:36:55,868 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-09 09:36:55,868 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-09 09:36:55,868 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-09 09:36:55,868 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-09 09:36:55,868 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-09 09:36:55,900 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-09 09:36:55,900 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-09 09:36:55,900 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-09 09:36:55,900 - backend.app.startup - INFO - API前缀: /api
2025-04-09 09:36:55,900 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-09 09:37:08,069 - app.main - INFO - 收到请求: GET /favicon.ico (来自: 172.19.0.1)
2025-04-09 09:37:08,069 - app.main - INFO - 请求完成: GET /favicon.ico - 404 (耗时: 0.0003s)
2025-04-09 09:37:08,101 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 09:37:08,105 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 09:37:08,105 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0039s)
2025-04-09 09:37:08,106 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0016s)
2025-04-09 09:37:08,142 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 09:37:08,143 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 09:37:08,143 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0012s)
2025-04-09 09:37:08,144 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 09:37:08,145 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 09:37:08,145 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-09 09:37:08,161 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 09:37:08,161 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-09 09:37:08,175 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 09:37:08,175 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-09 09:37:08,212 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 09:37:08,212 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-09 09:37:08,215 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-09 09:37:08,215 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-09 09:37:08,224 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 09:37:08,229 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 09:37:08,229 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0051s)
2025-04-09 09:37:08,277 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 09:37:08,278 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-09 09:37:08,278 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0493s)
2025-04-09 09:37:08,284 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0067s)
2025-04-09 09:37:08,285 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0068s)
2025-04-09 09:37:09,370 - app.main - INFO - 收到请求: POST /flows/30a17510-07bf-4371-aa18-6583ad908aa4/set-as-last-selected (来自: 172.19.0.1)
2025-04-09 09:37:09,374 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 09:37:09,374 - app.main - INFO - 请求完成: POST /flows/30a17510-07bf-4371-aa18-6583ad908aa4/set-as-last-selected - 200 (耗时: 0.0046s)
2025-04-09 09:37:09,418 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 09:37:09,423 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 09:37:09,426 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0079s)
2025-04-09 09:37:09,457 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 09:37:09,458 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 09:37:09,459 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0012s)
2025-04-09 09:37:09,460 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-09 09:37:09,461 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-09 09:37:09,461 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-09 09:37:09,473 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 09:37:09,474 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 09:37:09,476 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 09:37:09,478 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 09:37:09,479 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-09 09:37:09,480 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0072s)
2025-04-09 09:37:09,482 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 09:37:09,482 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-09 09:37:09,483 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 09:37:09,483 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0088s)
2025-04-09 09:37:09,484 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 09:37:09,485 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-09 09:37:09,485 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0072s)
2025-04-09 09:37:09,486 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0030s)
2025-04-09 09:37:09,556 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 09:37:09,562 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0050s)
2025-04-09 09:37:11,561 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 09:37:11,572 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0104s)
2025-04-09 09:37:11,749 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 09:37:11,750 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-09 09:37:11,751 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 09:37:11,752 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-09 09:37:11,752 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-09 09:37:11,753 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-09 09:37:11,753 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0033s)
2025-04-09 09:37:11,754 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0041s)
2025-04-09 09:37:11,758 - app.main - INFO - 收到请求: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 09:37:11,759 - app.main - INFO - 收到请求: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 09:37:11,763 - app.main - INFO - 请求完成: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0042s)
2025-04-09 09:37:11,764 - app.main - INFO - 请求完成: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0052s)
2025-04-09 09:37:11,784 - app.main - INFO - 收到请求: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c (来自: 172.19.0.1)
2025-04-09 09:37:11,787 - app.main - INFO - 请求完成: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c - 200 (耗时: 0.0026s)
2025-04-09 09:37:11,808 - app.main - INFO - 收到请求: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c (来自: 172.19.0.1)
2025-04-09 09:37:11,809 - app.main - INFO - 收到请求: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c (来自: 172.19.0.1)
2025-04-09 09:37:11,814 - app.main - INFO - 请求完成: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c - 200 (耗时: 0.0061s)
2025-04-09 09:37:11,815 - app.main - INFO - 请求完成: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c - 200 (耗时: 0.0058s)
2025-04-09 09:37:14,861 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 09:37:14,864 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-09 09:37:14,865 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0034s)
2025-04-09 09:37:14,866 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0015s)
2025-04-09 09:37:16,868 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-09 09:37:16,882 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0126s)
2025-04-09 09:37:20,819 - app.main - INFO - 收到请求: POST /chats/8b728096-aeb5-4f52-beba-de36bd9c287c/messages (来自: 172.19.0.1)
2025-04-09 09:37:20,821 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 linked to chat: 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-09 09:37:20,826 - backend.app.services.chat_service - INFO - 已向聊天 8b728096-aeb5-4f52-beba-de36bd9c287c 添加一条 user 消息
2025-04-09 09:37:20,831 - backend.app.routers.chat - INFO - 更新 Flow 30a17510-07bf-4371-aa18-6583ad908aa4 的 last_interacted_chat_id 为 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-09 09:37:20,831 - app.main - INFO - 请求完成: POST /chats/8b728096-aeb5-4f52-beba-de36bd9c287c/messages - 200 (耗时: 0.0124s)
2025-04-10 05:01:28,034 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 05:01:28,035 - app.main - INFO - 请求完成: GET /auth/verify-token - 401 (耗时: 0.0009s)
2025-04-10 05:01:28,075 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 05:01:28,076 - app.main - INFO - 请求完成: GET /auth/verify-token - 401 (耗时: 0.0009s)
2025-04-10 05:01:28,960 - app.main - INFO - 收到请求: POST /users/login (来自: 172.19.0.1)
2025-04-10 05:01:29,152 - app.main - INFO - 请求完成: POST /users/login - 200 (耗时: 0.1911s)
2025-04-10 05:01:29,155 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 05:01:29,156 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0013s)
2025-04-10 05:01:29,167 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 05:01:29,168 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0014s)
2025-04-10 05:01:29,184 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 05:01:29,184 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 05:01:29,185 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 05:01:29,185 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0011s)
2025-04-10 05:01:29,185 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0004s)
2025-04-10 05:01:29,188 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 05:01:29,189 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 05:01:29,189 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0008s)
2025-04-10 05:01:29,208 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 05:01:29,209 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-10 05:01:29,209 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 05:01:29,210 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-10 05:01:29,212 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 05:01:29,213 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-10 05:01:29,215 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 05:01:29,216 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 05:01:29,216 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0013s)
2025-04-10 05:01:29,218 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 05:01:29,218 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 05:01:29,221 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 05:01:29,223 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 05:01:29,223 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 05:01:29,225 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0024s)
2025-04-10 05:01:29,226 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0080s)
2025-04-10 05:01:29,226 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0084s)
2025-04-10 05:01:29,227 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0064s)
2025-04-10 05:01:29,228 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 05:01:29,229 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 05:01:29,229 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0005s)
2025-04-10 05:01:29,229 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0005s)
2025-04-10 05:01:29,244 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 05:01:29,245 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-10 05:01:29,247 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 05:01:29,247 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 05:01:29,248 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 05:01:29,254 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0072s)
2025-04-10 05:01:29,255 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0074s)
2025-04-10 05:01:29,255 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0073s)
2025-04-10 05:01:29,262 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 05:01:29,262 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0004s)
2025-04-10 05:01:29,263 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 05:01:29,266 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0032s)
2025-04-10 05:01:29,284 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 05:01:29,287 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0027s)
2025-04-10 05:01:32,191 - app.main - INFO - 收到请求: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected (来自: 172.19.0.1)
2025-04-10 05:01:32,192 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:01:32,209 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 05:01:32,212 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 05:01:32,213 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0214s)
2025-04-10 05:01:32,214 - app.main - INFO - 请求完成: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected - 200 (耗时: 0.0230s)
2025-04-10 05:01:32,258 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 05:01:32,259 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 05:01:32,260 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-10 05:01:32,260 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 05:01:32,261 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 05:01:32,261 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0006s)
2025-04-10 05:01:32,274 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:01:32,274 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:01:32,277 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 05:01:32,279 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 05:01:32,281 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0073s)
2025-04-10 05:01:32,281 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0070s)
2025-04-10 05:01:32,282 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-10 05:01:32,282 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-10 05:01:32,283 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 05:01:32,284 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 05:01:32,284 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 05:01:32,284 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 05:01:32,285 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0032s)
2025-04-10 05:01:32,285 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0031s)
2025-04-10 05:01:32,328 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:01:32,333 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0048s)
2025-04-10 05:01:34,335 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:01:34,348 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0124s)
2025-04-10 05:01:36,578 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-10 05:01:36,579 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-10 05:01:36,580 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 05:01:36,581 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 05:01:36,581 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 05:01:36,582 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 05:01:36,582 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0031s)
2025-04-10 05:01:36,582 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0038s)
2025-04-10 05:01:36,590 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:01:36,590 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:01:36,594 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0041s)
2025-04-10 05:01:36,594 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0040s)
2025-04-10 05:01:40,491 - app.main - INFO - 收到请求: GET /chats/642835f6-ce4d-49d1-80fa-bca7e246a70e (来自: 172.19.0.1)
2025-04-10 05:01:40,493 - app.main - INFO - 请求完成: GET /chats/642835f6-ce4d-49d1-80fa-bca7e246a70e - 200 (耗时: 0.0022s)
2025-04-10 05:01:41,095 - app.main - INFO - 收到请求: GET /chats/2225927e-4fcf-4c2e-a772-ae3bc104f20b (来自: 172.19.0.1)
2025-04-10 05:01:41,097 - app.main - INFO - 请求完成: GET /chats/2225927e-4fcf-4c2e-a772-ae3bc104f20b - 200 (耗时: 0.0020s)
2025-04-10 05:01:41,499 - app.main - INFO - 收到请求: GET /chats/43b5d619-3b54-4262-9256-ed7e2993b467 (来自: 172.19.0.1)
2025-04-10 05:01:41,502 - app.main - INFO - 请求完成: GET /chats/43b5d619-3b54-4262-9256-ed7e2993b467 - 200 (耗时: 0.0028s)
2025-04-10 05:01:41,995 - app.main - INFO - 收到请求: GET /chats/7dcecbea-6b17-477d-bea4-ca339eb67ff8 (来自: 172.19.0.1)
2025-04-10 05:01:41,997 - app.main - INFO - 请求完成: GET /chats/7dcecbea-6b17-477d-bea4-ca339eb67ff8 - 200 (耗时: 0.0020s)
2025-04-10 05:01:42,368 - app.main - INFO - 收到请求: GET /chats/97781511-28e4-4893-873a-e6d7e88445ec (来自: 172.19.0.1)
2025-04-10 05:01:42,371 - app.main - INFO - 请求完成: GET /chats/97781511-28e4-4893-873a-e6d7e88445ec - 200 (耗时: 0.0025s)
2025-04-10 05:02:03,181 - app.main - INFO - 收到请求: DELETE /chats/642835f6-ce4d-49d1-80fa-bca7e246a70e (来自: 172.19.0.1)
2025-04-10 05:02:03,194 - backend.app.services.chat_service - INFO - 已删除聊天 642835f6-ce4d-49d1-80fa-bca7e246a70e
2025-04-10 05:02:03,195 - app.main - INFO - 请求完成: DELETE /chats/642835f6-ce4d-49d1-80fa-bca7e246a70e - 200 (耗时: 0.0140s)
2025-04-10 05:02:03,201 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:02:03,204 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0027s)
2025-04-10 05:02:04,873 - app.main - INFO - 收到请求: DELETE /chats/2225927e-4fcf-4c2e-a772-ae3bc104f20b (来自: 172.19.0.1)
2025-04-10 05:02:04,877 - backend.app.services.chat_service - INFO - 已删除聊天 2225927e-4fcf-4c2e-a772-ae3bc104f20b
2025-04-10 05:02:04,878 - app.main - INFO - 请求完成: DELETE /chats/2225927e-4fcf-4c2e-a772-ae3bc104f20b - 200 (耗时: 0.0041s)
2025-04-10 05:02:04,881 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:02:04,884 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0025s)
2025-04-10 05:02:06,050 - app.main - INFO - 收到请求: GET /chats/7dcecbea-6b17-477d-bea4-ca339eb67ff8 (来自: 172.19.0.1)
2025-04-10 05:02:06,054 - app.main - INFO - 请求完成: GET /chats/7dcecbea-6b17-477d-bea4-ca339eb67ff8 - 200 (耗时: 0.0037s)
2025-04-10 05:02:06,464 - app.main - INFO - 收到请求: GET /chats/43b5d619-3b54-4262-9256-ed7e2993b467 (来自: 172.19.0.1)
2025-04-10 05:02:06,466 - app.main - INFO - 请求完成: GET /chats/43b5d619-3b54-4262-9256-ed7e2993b467 - 200 (耗时: 0.0020s)
2025-04-10 05:02:08,307 - app.main - INFO - 收到请求: DELETE /chats/43b5d619-3b54-4262-9256-ed7e2993b467 (来自: 172.19.0.1)
2025-04-10 05:02:08,319 - backend.app.services.chat_service - INFO - 已删除聊天 43b5d619-3b54-4262-9256-ed7e2993b467
2025-04-10 05:02:08,320 - app.main - INFO - 请求完成: DELETE /chats/43b5d619-3b54-4262-9256-ed7e2993b467 - 200 (耗时: 0.0130s)
2025-04-10 05:02:08,324 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:02:08,326 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0022s)
2025-04-10 05:02:09,138 - app.main - INFO - 收到请求: GET /chats/7dcecbea-6b17-477d-bea4-ca339eb67ff8 (来自: 172.19.0.1)
2025-04-10 05:02:09,141 - app.main - INFO - 请求完成: GET /chats/7dcecbea-6b17-477d-bea4-ca339eb67ff8 - 200 (耗时: 0.0020s)
2025-04-10 05:02:10,638 - app.main - INFO - 收到请求: DELETE /chats/7dcecbea-6b17-477d-bea4-ca339eb67ff8 (来自: 172.19.0.1)
2025-04-10 05:02:10,649 - backend.app.services.chat_service - INFO - 已删除聊天 7dcecbea-6b17-477d-bea4-ca339eb67ff8
2025-04-10 05:02:10,650 - app.main - INFO - 请求完成: DELETE /chats/7dcecbea-6b17-477d-bea4-ca339eb67ff8 - 200 (耗时: 0.0118s)
2025-04-10 05:02:10,654 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:02:10,660 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0059s)
2025-04-10 05:02:12,453 - app.main - INFO - 收到请求: DELETE /chats/97781511-28e4-4893-873a-e6d7e88445ec (来自: 172.19.0.1)
2025-04-10 05:02:12,466 - backend.app.services.chat_service - INFO - 已删除聊天 97781511-28e4-4893-873a-e6d7e88445ec
2025-04-10 05:02:12,467 - app.main - INFO - 请求完成: DELETE /chats/97781511-28e4-4893-873a-e6d7e88445ec - 200 (耗时: 0.0137s)
2025-04-10 05:02:12,470 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:02:12,474 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0040s)
2025-04-10 05:02:18,600 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-10 05:02:18,601 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-10 05:02:18,603 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 05:02:18,603 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 05:02:18,604 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 05:02:18,604 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 05:02:18,605 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0037s)
2025-04-10 05:02:18,605 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0048s)
2025-04-10 05:02:18,609 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:02:18,609 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:02:18,613 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0038s)
2025-04-10 05:02:18,613 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0037s)
2025-04-10 05:02:21,828 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-10 05:02:21,831 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-10 05:02:21,831 - backend.app.routers.chat - INFO - 验证 flow ownership: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 05:02:21,832 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 05:02:21,832 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-10 05:02:21,844 - backend.app.services.chat_service - INFO - 已为流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 创建聊天 c418816a-fcc6-4c6a-b252-b546b78ab6e1
2025-04-10 05:02:21,845 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=c418816a-fcc6-4c6a-b252-b546b78ab6e1, name='新聊天', flow_id=61aa7e47-7611-41e8-b7bb-a438f0c09adb)>
2025-04-10 05:02:21,850 - backend.app.routers.chat - INFO - 更新 Flow 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的 last_interacted_chat_id 为 c418816a-fcc6-4c6a-b252-b546b78ab6e1
2025-04-10 05:02:21,850 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: c418816a-fcc6-4c6a-b252-b546b78ab6e1
2025-04-10 05:02:21,851 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0228s)
2025-04-10 05:02:21,856 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:02:21,860 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0035s)
2025-04-10 05:02:21,941 - app.main - INFO - 收到请求: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 (来自: 172.19.0.1)
2025-04-10 05:02:21,943 - app.main - INFO - 请求完成: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 - 200 (耗时: 0.0027s)
2025-04-10 05:02:24,802 - app.main - INFO - 收到请求: POST /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1/messages (来自: 172.19.0.1)
2025-04-10 05:02:24,805 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb linked to chat: c418816a-fcc6-4c6a-b252-b546b78ab6e1
2025-04-10 05:02:24,807 - backend.app.services.chat_service - INFO - 已向聊天 c418816a-fcc6-4c6a-b252-b546b78ab6e1 添加一条 user 消息
2025-04-10 05:02:24,810 - backend.app.routers.chat - INFO - 更新 Flow 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的 last_interacted_chat_id 为 c418816a-fcc6-4c6a-b252-b546b78ab6e1
2025-04-10 05:02:24,810 - app.main - INFO - 请求完成: POST /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1/messages - 200 (耗时: 0.0078s)
2025-04-10 05:02:45,762 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:02:45,764 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0027s)
2025-04-10 05:02:47,764 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 05:02:47,772 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0086s)
2025-04-10 06:17:16,456 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-10 06:17:16,457 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-10 06:17:16,457 - backend.app.routers.chat - INFO - 验证 flow ownership: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:17:16,458 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:17:16,458 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-10 06:17:16,472 - backend.app.services.chat_service - INFO - 已为流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 创建聊天 b8a4fc22-195c-48ad-a1d0-168eb55fb0d9
2025-04-10 06:17:16,472 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=b8a4fc22-195c-48ad-a1d0-168eb55fb0d9, name='新聊天', flow_id=61aa7e47-7611-41e8-b7bb-a438f0c09adb)>
2025-04-10 06:17:16,476 - backend.app.routers.chat - INFO - 更新 Flow 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的 last_interacted_chat_id 为 b8a4fc22-195c-48ad-a1d0-168eb55fb0d9
2025-04-10 06:17:16,476 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: b8a4fc22-195c-48ad-a1d0-168eb55fb0d9
2025-04-10 06:17:16,477 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0208s)
2025-04-10 06:17:16,524 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:17:16,533 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0081s)
2025-04-10 06:17:16,577 - app.main - INFO - 收到请求: GET /chats/b8a4fc22-195c-48ad-a1d0-168eb55fb0d9 (来自: 172.19.0.1)
2025-04-10 06:17:16,579 - app.main - INFO - 请求完成: GET /chats/b8a4fc22-195c-48ad-a1d0-168eb55fb0d9 - 200 (耗时: 0.0024s)
2025-04-10 06:17:17,484 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-10 06:17:17,487 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-10 06:17:17,487 - backend.app.routers.chat - INFO - 验证 flow ownership: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:17:17,487 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:17:17,487 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-10 06:17:17,500 - backend.app.services.chat_service - INFO - 已为流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 创建聊天 6bb5b883-af3f-472d-8842-a403dc72b020
2025-04-10 06:17:17,500 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=6bb5b883-af3f-472d-8842-a403dc72b020, name='新聊天', flow_id=61aa7e47-7611-41e8-b7bb-a438f0c09adb)>
2025-04-10 06:17:17,504 - backend.app.routers.chat - INFO - 更新 Flow 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的 last_interacted_chat_id 为 6bb5b883-af3f-472d-8842-a403dc72b020
2025-04-10 06:17:17,504 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: 6bb5b883-af3f-472d-8842-a403dc72b020
2025-04-10 06:17:17,505 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0200s)
2025-04-10 06:17:17,509 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:17:17,513 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0033s)
2025-04-10 06:17:17,610 - app.main - INFO - 收到请求: GET /chats/6bb5b883-af3f-472d-8842-a403dc72b020 (来自: 172.19.0.1)
2025-04-10 06:17:17,612 - app.main - INFO - 请求完成: GET /chats/6bb5b883-af3f-472d-8842-a403dc72b020 - 200 (耗时: 0.0021s)
2025-04-10 06:17:17,677 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-10 06:17:17,679 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-10 06:17:17,679 - backend.app.routers.chat - INFO - 验证 flow ownership: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:17:17,679 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:17:17,679 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-10 06:17:17,690 - backend.app.services.chat_service - INFO - 已为流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 创建聊天 bc6b29eb-2007-4137-8afe-f46d0f011791
2025-04-10 06:17:17,691 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=bc6b29eb-2007-4137-8afe-f46d0f011791, name='新聊天', flow_id=61aa7e47-7611-41e8-b7bb-a438f0c09adb)>
2025-04-10 06:17:17,694 - backend.app.routers.chat - INFO - 更新 Flow 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的 last_interacted_chat_id 为 bc6b29eb-2007-4137-8afe-f46d0f011791
2025-04-10 06:17:17,694 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: bc6b29eb-2007-4137-8afe-f46d0f011791
2025-04-10 06:17:17,695 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0175s)
2025-04-10 06:17:17,698 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:17:17,701 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0024s)
2025-04-10 06:17:17,785 - app.main - INFO - 收到请求: GET /chats/bc6b29eb-2007-4137-8afe-f46d0f011791 (来自: 172.19.0.1)
2025-04-10 06:17:17,788 - app.main - INFO - 请求完成: GET /chats/bc6b29eb-2007-4137-8afe-f46d0f011791 - 200 (耗时: 0.0030s)
2025-04-10 06:17:17,865 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-10 06:17:17,867 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-10 06:17:17,867 - backend.app.routers.chat - INFO - 验证 flow ownership: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:17:17,868 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:17:17,868 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-10 06:17:17,878 - backend.app.services.chat_service - INFO - 已为流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 创建聊天 f00bcb73-6551-4d7e-a760-9d94d92e26d0
2025-04-10 06:17:17,878 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=f00bcb73-6551-4d7e-a760-9d94d92e26d0, name='新聊天', flow_id=61aa7e47-7611-41e8-b7bb-a438f0c09adb)>
2025-04-10 06:17:17,880 - backend.app.routers.chat - INFO - 更新 Flow 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的 last_interacted_chat_id 为 f00bcb73-6551-4d7e-a760-9d94d92e26d0
2025-04-10 06:17:17,880 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: f00bcb73-6551-4d7e-a760-9d94d92e26d0
2025-04-10 06:17:17,881 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0152s)
2025-04-10 06:17:17,883 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:17:17,885 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0019s)
2025-04-10 06:17:17,980 - app.main - INFO - 收到请求: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 (来自: 172.19.0.1)
2025-04-10 06:17:17,983 - app.main - INFO - 请求完成: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 - 200 (耗时: 0.0028s)
2025-04-10 06:17:18,257 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-10 06:17:18,259 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-10 06:17:18,259 - backend.app.routers.chat - INFO - 验证 flow ownership: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:17:18,259 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:17:18,259 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-10 06:17:18,271 - backend.app.services.chat_service - INFO - 已为流程图 61aa7e47-7611-41e8-b7bb-a438f0c09adb 创建聊天 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:17:18,271 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=53e43ec9-ce1e-4f77-8c3d-c559f90ff84c, name='新聊天', flow_id=61aa7e47-7611-41e8-b7bb-a438f0c09adb)>
2025-04-10 06:17:18,278 - backend.app.routers.chat - INFO - 更新 Flow 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的 last_interacted_chat_id 为 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:17:18,278 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:17:18,279 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0221s)
2025-04-10 06:17:18,287 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:17:18,294 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0065s)
2025-04-10 06:17:18,392 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:17:18,396 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0038s)
2025-04-10 06:17:19,651 - app.main - INFO - 收到请求: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 (来自: 172.19.0.1)
2025-04-10 06:17:19,653 - app.main - INFO - 请求完成: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 - 200 (耗时: 0.0020s)
2025-04-10 06:17:20,001 - app.main - INFO - 收到请求: GET /chats/bc6b29eb-2007-4137-8afe-f46d0f011791 (来自: 172.19.0.1)
2025-04-10 06:17:20,004 - app.main - INFO - 请求完成: GET /chats/bc6b29eb-2007-4137-8afe-f46d0f011791 - 200 (耗时: 0.0029s)
2025-04-10 06:17:20,422 - app.main - INFO - 收到请求: GET /chats/6bb5b883-af3f-472d-8842-a403dc72b020 (来自: 172.19.0.1)
2025-04-10 06:17:20,424 - app.main - INFO - 请求完成: GET /chats/6bb5b883-af3f-472d-8842-a403dc72b020 - 200 (耗时: 0.0023s)
2025-04-10 06:17:32,177 - app.main - INFO - 收到请求: GET /chats/bc6b29eb-2007-4137-8afe-f46d0f011791 (来自: 172.19.0.1)
2025-04-10 06:17:32,179 - app.main - INFO - 请求完成: GET /chats/bc6b29eb-2007-4137-8afe-f46d0f011791 - 200 (耗时: 0.0021s)
2025-04-10 06:17:34,440 - app.main - INFO - 收到请求: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 (来自: 172.19.0.1)
2025-04-10 06:17:34,442 - app.main - INFO - 请求完成: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 - 200 (耗时: 0.0020s)
2025-04-10 06:17:37,629 - app.main - INFO - 收到请求: DELETE /chats/b8a4fc22-195c-48ad-a1d0-168eb55fb0d9 (来自: 172.19.0.1)
2025-04-10 06:17:37,641 - backend.app.services.chat_service - INFO - 已删除聊天 b8a4fc22-195c-48ad-a1d0-168eb55fb0d9
2025-04-10 06:17:37,641 - app.main - INFO - 请求完成: DELETE /chats/b8a4fc22-195c-48ad-a1d0-168eb55fb0d9 - 200 (耗时: 0.0116s)
2025-04-10 06:17:37,646 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:17:37,648 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0023s)
2025-04-10 06:17:39,679 - app.main - INFO - 收到请求: DELETE /chats/6bb5b883-af3f-472d-8842-a403dc72b020 (来自: 172.19.0.1)
2025-04-10 06:17:39,693 - backend.app.services.chat_service - INFO - 已删除聊天 6bb5b883-af3f-472d-8842-a403dc72b020
2025-04-10 06:17:39,694 - app.main - INFO - 请求完成: DELETE /chats/6bb5b883-af3f-472d-8842-a403dc72b020 - 200 (耗时: 0.0149s)
2025-04-10 06:17:39,700 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:17:39,703 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0030s)
2025-04-10 06:17:41,635 - app.main - INFO - 收到请求: DELETE /chats/bc6b29eb-2007-4137-8afe-f46d0f011791 (来自: 172.19.0.1)
2025-04-10 06:17:41,649 - backend.app.services.chat_service - INFO - 已删除聊天 bc6b29eb-2007-4137-8afe-f46d0f011791
2025-04-10 06:17:41,649 - app.main - INFO - 请求完成: DELETE /chats/bc6b29eb-2007-4137-8afe-f46d0f011791 - 200 (耗时: 0.0135s)
2025-04-10 06:17:41,652 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:17:41,655 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0027s)
2025-04-10 06:24:10,857 - app.main - INFO - 收到请求: PUT /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 (来自: 172.19.0.1)
2025-04-10 06:24:10,863 - backend.app.services.chat_service - INFO - 已更新聊天 f00bcb73-6551-4d7e-a760-9d94d92e26d0
2025-04-10 06:24:10,864 - app.main - INFO - 请求完成: PUT /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 - 200 (耗时: 0.0062s)
2025-04-10 06:24:10,867 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:24:10,869 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0020s)
2025-04-10 06:24:11,987 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:24:11,991 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0038s)
2025-04-10 06:24:12,651 - app.main - INFO - 收到请求: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 (来自: 172.19.0.1)
2025-04-10 06:24:12,654 - app.main - INFO - 请求完成: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 - 200 (耗时: 0.0027s)
2025-04-10 06:24:13,357 - app.main - INFO - 收到请求: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 (来自: 172.19.0.1)
2025-04-10 06:24:13,363 - app.main - INFO - 请求完成: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 - 200 (耗时: 0.0048s)
2025-04-10 06:24:14,276 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:24:14,279 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0027s)
2025-04-10 06:24:26,188 - app.main - INFO - 收到请求: PUT /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 (来自: 172.19.0.1)
2025-04-10 06:24:26,202 - backend.app.services.chat_service - INFO - 已更新聊天 c418816a-fcc6-4c6a-b252-b546b78ab6e1
2025-04-10 06:24:26,203 - app.main - INFO - 请求完成: PUT /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 - 200 (耗时: 0.0150s)
2025-04-10 06:24:26,209 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:24:26,212 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0024s)
2025-04-10 06:24:37,441 - app.main - INFO - 收到请求: PUT /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:24:37,445 - backend.app.services.chat_service - INFO - 已更新聊天 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:24:37,446 - app.main - INFO - 请求完成: PUT /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0051s)
2025-04-10 06:24:37,449 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:24:37,453 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0035s)
2025-04-10 06:24:40,921 - app.main - INFO - 收到请求: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 (来自: 172.19.0.1)
2025-04-10 06:24:40,923 - app.main - INFO - 请求完成: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 - 200 (耗时: 0.0020s)
2025-04-10 06:24:41,589 - app.main - INFO - 收到请求: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 (来自: 172.19.0.1)
2025-04-10 06:24:41,591 - app.main - INFO - 请求完成: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 - 200 (耗时: 0.0021s)
2025-04-10 06:24:44,938 - app.main - INFO - 收到请求: POST /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0/messages (来自: 172.19.0.1)
2025-04-10 06:24:44,940 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb linked to chat: f00bcb73-6551-4d7e-a760-9d94d92e26d0
2025-04-10 06:24:44,943 - backend.app.services.chat_service - INFO - 已向聊天 f00bcb73-6551-4d7e-a760-9d94d92e26d0 添加一条 user 消息
2025-04-10 06:24:44,945 - backend.app.routers.chat - INFO - 更新 Flow 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的 last_interacted_chat_id 为 f00bcb73-6551-4d7e-a760-9d94d92e26d0
2025-04-10 06:24:44,946 - app.main - INFO - 请求完成: POST /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0/messages - 200 (耗时: 0.0074s)
2025-04-10 06:24:46,228 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:24:46,232 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0033s)
2025-04-10 06:24:49,073 - app.main - INFO - 收到请求: POST /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c/messages (来自: 172.19.0.1)
2025-04-10 06:24:49,075 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb linked to chat: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:24:49,078 - backend.app.services.chat_service - INFO - 已向聊天 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c 添加一条 user 消息
2025-04-10 06:24:49,080 - backend.app.routers.chat - INFO - 更新 Flow 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的 last_interacted_chat_id 为 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:24:49,080 - app.main - INFO - 请求完成: POST /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c/messages - 200 (耗时: 0.0076s)
2025-04-10 06:24:50,148 - app.main - INFO - 收到请求: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 (来自: 172.19.0.1)
2025-04-10 06:24:50,150 - app.main - INFO - 请求完成: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 - 200 (耗时: 0.0023s)
2025-04-10 06:24:50,814 - app.main - INFO - 收到请求: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 (来自: 172.19.0.1)
2025-04-10 06:24:50,816 - app.main - INFO - 请求完成: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 - 200 (耗时: 0.0022s)
2025-04-10 06:24:51,212 - app.main - INFO - 收到请求: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 (来自: 172.19.0.1)
2025-04-10 06:24:51,216 - app.main - INFO - 请求完成: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 - 200 (耗时: 0.0035s)
2025-04-10 06:24:51,544 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:24:51,546 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0022s)
2025-04-10 06:24:51,932 - app.main - INFO - 收到请求: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 (来自: 172.19.0.1)
2025-04-10 06:24:51,935 - app.main - INFO - 请求完成: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 - 200 (耗时: 0.0032s)
2025-04-10 06:24:52,840 - app.main - INFO - 收到请求: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 (来自: 172.19.0.1)
2025-04-10 06:24:52,843 - app.main - INFO - 请求完成: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 - 200 (耗时: 0.0025s)
2025-04-10 06:24:53,151 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:24:53,155 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0033s)
2025-04-10 06:24:53,819 - app.main - INFO - 收到请求: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 (来自: 172.19.0.1)
2025-04-10 06:24:53,822 - app.main - INFO - 请求完成: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 - 200 (耗时: 0.0026s)
2025-04-10 06:24:58,936 - app.main - INFO - 收到请求: POST /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1/messages (来自: 172.19.0.1)
2025-04-10 06:24:58,938 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb linked to chat: c418816a-fcc6-4c6a-b252-b546b78ab6e1
2025-04-10 06:24:58,941 - backend.app.services.chat_service - INFO - 已向聊天 c418816a-fcc6-4c6a-b252-b546b78ab6e1 添加一条 user 消息
2025-04-10 06:24:58,944 - backend.app.routers.chat - INFO - 更新 Flow 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的 last_interacted_chat_id 为 c418816a-fcc6-4c6a-b252-b546b78ab6e1
2025-04-10 06:24:58,945 - app.main - INFO - 请求完成: POST /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1/messages - 200 (耗时: 0.0092s)
2025-04-10 06:25:00,516 - app.main - INFO - 收到请求: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 (来自: 172.19.0.1)
2025-04-10 06:25:00,519 - app.main - INFO - 请求完成: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 - 200 (耗时: 0.0027s)
2025-04-10 06:25:03,110 - app.main - INFO - 收到请求: POST /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0/messages (来自: 172.19.0.1)
2025-04-10 06:25:03,112 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb linked to chat: f00bcb73-6551-4d7e-a760-9d94d92e26d0
2025-04-10 06:25:03,114 - backend.app.services.chat_service - INFO - 已向聊天 f00bcb73-6551-4d7e-a760-9d94d92e26d0 添加一条 user 消息
2025-04-10 06:25:03,117 - backend.app.routers.chat - INFO - 更新 Flow 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的 last_interacted_chat_id 为 f00bcb73-6551-4d7e-a760-9d94d92e26d0
2025-04-10 06:25:03,117 - app.main - INFO - 请求完成: POST /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0/messages - 200 (耗时: 0.0075s)
2025-04-10 06:25:04,155 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:25:04,158 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0023s)
2025-04-10 06:25:07,215 - app.main - INFO - 收到请求: POST /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c/messages (来自: 172.19.0.1)
2025-04-10 06:25:07,218 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb linked to chat: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:25:07,220 - backend.app.services.chat_service - INFO - 已向聊天 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c 添加一条 user 消息
2025-04-10 06:25:07,223 - backend.app.routers.chat - INFO - 更新 Flow 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的 last_interacted_chat_id 为 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:25:07,223 - app.main - INFO - 请求完成: POST /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c/messages - 200 (耗时: 0.0079s)
2025-04-10 06:25:12,546 - app.main - INFO - 收到请求: POST /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c/messages (来自: 172.19.0.1)
2025-04-10 06:25:12,548 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb linked to chat: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:25:12,552 - backend.app.services.chat_service - INFO - 已向聊天 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c 添加一条 user 消息
2025-04-10 06:25:12,555 - backend.app.routers.chat - INFO - 更新 Flow 61aa7e47-7611-41e8-b7bb-a438f0c09adb 的 last_interacted_chat_id 为 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:25:12,556 - app.main - INFO - 请求完成: POST /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c/messages - 200 (耗时: 0.0094s)
2025-04-10 06:25:18,858 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 06:25:18,858 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-10 06:25:18,903 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 06:25:18,907 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0037s)
2025-04-10 06:25:20,186 - app.main - INFO - 收到请求: POST /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640/set-as-last-selected (来自: 172.19.0.1)
2025-04-10 06:25:20,199 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-10 06:25:20,200 - app.main - INFO - 请求完成: POST /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640/set-as-last-selected - 200 (耗时: 0.0135s)
2025-04-10 06:25:20,200 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:25:20,203 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0029s)
2025-04-10 06:25:20,230 - app.main - INFO - 收到请求: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-10 06:25:20,233 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-10 06:25:20,235 - app.main - INFO - 请求完成: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0053s)
2025-04-10 06:25:20,260 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 06:25:20,261 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 06:25:20,261 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-10 06:25:20,262 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 06:25:20,263 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 06:25:20,263 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0006s)
2025-04-10 06:25:20,274 - app.main - INFO - 收到请求: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-10 06:25:20,278 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-10 06:25:20,279 - app.main - INFO - 收到请求: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-10 06:25:20,280 - app.main - INFO - 收到请求: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640/last_chat (来自: 172.19.0.1)
2025-04-10 06:25:20,281 - app.main - INFO - 请求完成: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0061s)
2025-04-10 06:25:20,283 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-10 06:25:20,284 - app.main - INFO - 收到请求: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640/last_chat (来自: 172.19.0.1)
2025-04-10 06:25:20,285 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: ed10ef28-ad53-41c0-860f-f359e3ea9640 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:25:20,285 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 06:25:20,286 - app.main - INFO - 请求完成: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0067s)
2025-04-10 06:25:20,287 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: ed10ef28-ad53-41c0-860f-f359e3ea9640 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:25:20,287 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 06:25:20,288 - app.main - INFO - 请求完成: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640/last_chat - 200 (耗时: 0.0072s)
2025-04-10 06:25:20,288 - app.main - INFO - 请求完成: GET /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640/last_chat - 200 (耗时: 0.0039s)
2025-04-10 06:25:20,367 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-10 06:25:20,382 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0142s)
2025-04-10 06:25:22,328 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-10 06:25:22,340 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0110s)
2025-04-10 06:25:22,725 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 06:25:22,725 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-10 06:25:22,729 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 06:25:22,732 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0032s)
2025-04-10 06:25:24,165 - app.main - INFO - 收到请求: POST /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640/set-as-last-selected (来自: 172.19.0.1)
2025-04-10 06:25:24,167 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: ed10ef28-ad53-41c0-860f-f359e3ea9640
2025-04-10 06:25:24,168 - app.main - INFO - 请求完成: POST /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640/set-as-last-selected - 200 (耗时: 0.0023s)
2025-04-10 06:25:26,018 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 06:25:26,018 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-10 06:25:26,030 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 06:25:26,033 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0034s)
2025-04-10 06:25:26,855 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:25:26,868 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:25:26,869 - app.main - INFO - 收到请求: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected (来自: 172.19.0.1)
2025-04-10 06:25:26,870 - app.main - INFO - 收到请求: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 (来自: 172.19.0.1)
2025-04-10 06:25:26,870 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0153s)
2025-04-10 06:25:26,872 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:25:26,875 - app.main - INFO - 请求完成: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected - 200 (耗时: 0.0060s)
2025-04-10 06:25:26,877 - app.main - INFO - 请求完成: PUT /flows/ed10ef28-ad53-41c0-860f-f359e3ea9640 - 200 (耗时: 0.0067s)
2025-04-10 06:25:26,894 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 06:25:26,895 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 06:25:26,895 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0013s)
2025-04-10 06:25:26,897 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 06:25:26,898 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 06:25:26,898 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0006s)
2025-04-10 06:25:26,908 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:25:26,909 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:25:26,913 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:25:26,915 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:25:26,916 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0076s)
2025-04-10 06:25:26,917 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-10 06:25:26,917 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0072s)
2025-04-10 06:25:26,918 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:25:26,918 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:25:26,918 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0016s)
2025-04-10 06:25:26,955 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-10 06:25:26,957 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:25:26,958 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:25:26,958 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0029s)
2025-04-10 06:25:26,965 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:25:26,968 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0027s)
2025-04-10 06:25:29,010 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 06:25:29,011 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-10 06:25:29,012 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:25:29,015 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 06:25:29,015 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0031s)
2025-04-10 06:25:29,018 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0028s)
2025-04-10 06:25:30,654 - app.main - INFO - 收到请求: POST /flows/30a17510-07bf-4371-aa18-6583ad908aa4/set-as-last-selected (来自: 172.19.0.1)
2025-04-10 06:25:30,654 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:30,668 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-10 06:25:30,671 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-10 06:25:30,671 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:25:30,672 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0172s)
2025-04-10 06:25:30,672 - app.main - INFO - 请求完成: POST /flows/30a17510-07bf-4371-aa18-6583ad908aa4/set-as-last-selected - 200 (耗时: 0.0179s)
2025-04-10 06:25:30,675 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0033s)
2025-04-10 06:25:30,694 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 06:25:30,695 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 06:25:30,695 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-10 06:25:30,696 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 06:25:30,697 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 06:25:30,697 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0011s)
2025-04-10 06:25:30,707 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:30,708 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:30,713 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-10 06:25:30,715 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-10 06:25:30,716 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0083s)
2025-04-10 06:25:30,716 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0078s)
2025-04-10 06:25:30,751 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-10 06:25:30,753 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:25:30,754 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-10 06:25:30,755 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-10 06:25:30,755 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0041s)
2025-04-10 06:25:30,756 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:25:30,756 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-10 06:25:30,757 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0020s)
2025-04-10 06:25:30,813 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:30,817 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0038s)
2025-04-10 06:25:32,796 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-10 06:25:32,797 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-10 06:25:32,798 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:25:32,799 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-10 06:25:32,799 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:25:32,800 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-10 06:25:32,800 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:32,801 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0045s)
2025-04-10 06:25:32,801 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0041s)
2025-04-10 06:25:32,803 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0030s)
2025-04-10 06:25:32,806 - app.main - INFO - 收到请求: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:32,809 - app.main - INFO - 收到请求: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:32,811 - app.main - INFO - 请求完成: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0047s)
2025-04-10 06:25:32,811 - app.main - INFO - 请求完成: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0025s)
2025-04-10 06:25:32,856 - app.main - INFO - 收到请求: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c (来自: 172.19.0.1)
2025-04-10 06:25:32,860 - app.main - INFO - 收到请求: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c (来自: 172.19.0.1)
2025-04-10 06:25:32,861 - app.main - INFO - 请求完成: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c - 200 (耗时: 0.0051s)
2025-04-10 06:25:32,865 - app.main - INFO - 请求完成: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c - 200 (耗时: 0.0038s)
2025-04-10 06:25:32,870 - app.main - INFO - 收到请求: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c (来自: 172.19.0.1)
2025-04-10 06:25:32,873 - app.main - INFO - 请求完成: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c - 200 (耗时: 0.0027s)
2025-04-10 06:25:34,077 - app.main - INFO - 收到请求: GET /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b (来自: 172.19.0.1)
2025-04-10 06:25:34,079 - app.main - INFO - 请求完成: GET /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b - 200 (耗时: 0.0021s)
2025-04-10 06:25:34,626 - app.main - INFO - 收到请求: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c (来自: 172.19.0.1)
2025-04-10 06:25:34,631 - app.main - INFO - 请求完成: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c - 200 (耗时: 0.0046s)
2025-04-10 06:25:35,683 - app.main - INFO - 收到请求: GET /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b (来自: 172.19.0.1)
2025-04-10 06:25:35,686 - app.main - INFO - 请求完成: GET /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b - 200 (耗时: 0.0021s)
2025-04-10 06:25:36,118 - app.main - INFO - 收到请求: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c (来自: 172.19.0.1)
2025-04-10 06:25:36,120 - app.main - INFO - 请求完成: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c - 200 (耗时: 0.0022s)
2025-04-10 06:25:37,282 - app.main - INFO - 收到请求: GET /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b (来自: 172.19.0.1)
2025-04-10 06:25:37,284 - app.main - INFO - 请求完成: GET /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b - 200 (耗时: 0.0020s)
2025-04-10 06:25:40,311 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 06:25:40,312 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 06:25:40,314 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0029s)
2025-04-10 06:25:40,315 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0029s)
2025-04-10 06:25:40,328 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:40,330 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-10 06:25:40,332 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0037s)
2025-04-10 06:25:40,365 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 06:25:40,366 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 06:25:40,366 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0005s)
2025-04-10 06:25:40,366 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 06:25:40,367 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0011s)
2025-04-10 06:25:40,368 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 06:25:40,368 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 06:25:40,368 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0006s)
2025-04-10 06:25:40,381 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:40,381 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-10 06:25:40,384 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-10 06:25:40,385 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:25:40,386 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-10 06:25:40,386 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-10 06:25:40,386 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:40,387 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0061s)
2025-04-10 06:25:40,387 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0059s)
2025-04-10 06:25:40,389 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 30a17510-07bf-4371-aa18-6583ad908aa4
2025-04-10 06:25:40,390 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:25:40,390 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-10 06:25:40,391 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0048s)
2025-04-10 06:25:40,391 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0053s)
2025-04-10 06:25:40,459 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 06:25:40,462 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0028s)
2025-04-10 06:25:40,470 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:40,473 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0030s)
2025-04-10 06:25:41,614 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-10 06:25:41,614 - app.main - INFO - 收到请求: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat (来自: 172.19.0.1)
2025-04-10 06:25:41,616 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:25:41,616 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-10 06:25:41,617 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 30a17510-07bf-4371-aa18-6583ad908aa4 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:25:41,617 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 8b728096-aeb5-4f52-beba-de36bd9c287c
2025-04-10 06:25:41,618 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0037s)
2025-04-10 06:25:41,618 - app.main - INFO - 请求完成: GET /flows/30a17510-07bf-4371-aa18-6583ad908aa4/last_chat - 200 (耗时: 0.0035s)
2025-04-10 06:25:41,626 - app.main - INFO - 收到请求: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:41,626 - app.main - INFO - 收到请求: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:41,630 - app.main - INFO - 请求完成: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0045s)
2025-04-10 06:25:41,631 - app.main - INFO - 请求完成: GET /chats/flow/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0043s)
2025-04-10 06:25:41,676 - app.main - INFO - 收到请求: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c (来自: 172.19.0.1)
2025-04-10 06:25:41,679 - app.main - INFO - 请求完成: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c - 200 (耗时: 0.0030s)
2025-04-10 06:25:41,694 - app.main - INFO - 收到请求: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c (来自: 172.19.0.1)
2025-04-10 06:25:41,697 - app.main - INFO - 收到请求: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c (来自: 172.19.0.1)
2025-04-10 06:25:41,698 - app.main - INFO - 请求完成: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c - 200 (耗时: 0.0033s)
2025-04-10 06:25:41,700 - app.main - INFO - 请求完成: GET /chats/8b728096-aeb5-4f52-beba-de36bd9c287c - 200 (耗时: 0.0027s)
2025-04-10 06:25:42,472 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:42,479 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0075s)
2025-04-10 06:25:42,850 - app.main - INFO - 收到请求: GET /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b (来自: 172.19.0.1)
2025-04-10 06:25:42,854 - app.main - INFO - 请求完成: GET /chats/6cadcfb6-4f0a-4b1f-bad0-b0a01b46141b - 200 (耗时: 0.0039s)
2025-04-10 06:25:44,713 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 06:25:44,713 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-10 06:25:44,716 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 06:25:44,719 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0027s)
2025-04-10 06:25:49,910 - app.main - INFO - 收到请求: POST /flows/61751c36-5c34-4dcb-90ac-73480ce54638/set-as-last-selected (来自: 172.19.0.1)
2025-04-10 06:25:49,923 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 06:25:49,923 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 06:25:49,926 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 06:25:49,927 - app.main - INFO - 收到请求: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 (来自: 172.19.0.1)
2025-04-10 06:25:49,927 - app.main - INFO - 请求完成: POST /flows/61751c36-5c34-4dcb-90ac-73480ce54638/set-as-last-selected - 200 (耗时: 0.0170s)
2025-04-10 06:25:49,928 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0044s)
2025-04-10 06:25:49,930 - app.main - INFO - 请求完成: PUT /flows/30a17510-07bf-4371-aa18-6583ad908aa4 - 200 (耗时: 0.0037s)
2025-04-10 06:25:49,950 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 06:25:49,951 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 06:25:49,952 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-10 06:25:49,952 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 06:25:49,953 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 06:25:49,953 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-10 06:25:49,965 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 06:25:49,966 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 06:25:49,968 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 06:25:49,970 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 06:25:49,971 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 06:25:49,972 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0065s)
2025-04-10 06:25:49,972 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0064s)
2025-04-10 06:25:49,973 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:25:49,974 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 06:25:49,975 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 06:25:49,976 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0047s)
2025-04-10 06:25:49,977 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:25:49,978 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 06:25:49,978 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0032s)
2025-04-10 06:25:50,063 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 06:25:50,078 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0141s)
2025-04-10 06:25:52,026 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 06:25:52,038 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0118s)
2025-04-10 06:25:54,448 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 06:25:54,448 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-10 06:25:54,451 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 06:25:54,454 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0030s)
2025-04-10 06:25:57,117 - app.main - INFO - 收到请求: POST /flows/61751c36-5c34-4dcb-90ac-73480ce54638/set-as-last-selected (来自: 172.19.0.1)
2025-04-10 06:25:57,119 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 06:25:57,120 - app.main - INFO - 请求完成: POST /flows/61751c36-5c34-4dcb-90ac-73480ce54638/set-as-last-selected - 200 (耗时: 0.0027s)
2025-04-10 06:25:59,444 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 06:25:59,444 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-10 06:25:59,453 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 06:25:59,456 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0027s)
2025-04-10 06:26:00,553 - app.main - INFO - 收到请求: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected (来自: 172.19.0.1)
2025-04-10 06:26:00,557 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:26:00,557 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:00,558 - app.main - INFO - 请求完成: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected - 200 (耗时: 0.0043s)
2025-04-10 06:26:00,559 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:26:00,560 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 06:26:00,561 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0036s)
2025-04-10 06:26:00,563 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0027s)
2025-04-10 06:26:00,581 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 06:26:00,582 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 06:26:00,583 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0016s)
2025-04-10 06:26:00,583 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 06:26:00,584 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 06:26:00,584 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0008s)
2025-04-10 06:26:00,594 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:00,594 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:00,597 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:26:00,597 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-10 06:26:00,598 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-10 06:26:00,600 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:26:00,602 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:26:00,602 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:26:00,603 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:26:00,603 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:26:00,603 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0093s)
2025-04-10 06:26:00,603 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0091s)
2025-04-10 06:26:00,604 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0063s)
2025-04-10 06:26:00,604 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0066s)
2025-04-10 06:26:00,651 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:00,656 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0043s)
2025-04-10 06:26:02,539 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-10 06:26:02,540 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-10 06:26:02,541 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:26:02,541 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:26:02,542 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:26:02,542 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:26:02,543 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0033s)
2025-04-10 06:26:02,543 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0038s)
2025-04-10 06:26:02,549 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:02,550 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:02,556 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0058s)
2025-04-10 06:26:02,556 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0070s)
2025-04-10 06:26:02,599 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:26:02,602 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0026s)
2025-04-10 06:26:02,627 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:26:02,629 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:26:02,630 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0031s)
2025-04-10 06:26:02,632 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0022s)
2025-04-10 06:26:02,653 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:02,657 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0042s)
2025-04-10 06:26:03,727 - app.main - INFO - 收到请求: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 (来自: 172.19.0.1)
2025-04-10 06:26:03,730 - app.main - INFO - 请求完成: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 - 200 (耗时: 0.0021s)
2025-04-10 06:26:04,196 - app.main - INFO - 收到请求: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 (来自: 172.19.0.1)
2025-04-10 06:26:04,199 - app.main - INFO - 请求完成: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 - 200 (耗时: 0.0021s)
2025-04-10 06:26:04,850 - app.main - INFO - 收到请求: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 (来自: 172.19.0.1)
2025-04-10 06:26:04,852 - app.main - INFO - 请求完成: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 - 200 (耗时: 0.0020s)
2025-04-10 06:26:05,371 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:26:05,374 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0027s)
2025-04-10 06:26:24,239 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 06:26:24,239 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-10 06:26:24,241 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 06:26:24,244 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0030s)
2025-04-10 06:26:33,178 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:33,184 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0056s)
2025-04-10 06:26:33,247 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:33,253 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0055s)
2025-04-10 06:26:34,160 - app.main - INFO - 收到请求: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected (来自: 172.19.0.1)
2025-04-10 06:26:34,163 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-10 06:26:34,164 - app.main - INFO - 请求完成: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected - 200 (耗时: 0.0041s)
2025-04-10 06:26:35,250 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:35,267 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0164s)
2025-04-10 06:26:35,287 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:35,290 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0027s)
2025-04-10 06:26:37,096 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-10 06:26:37,097 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:26:37,098 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:26:37,098 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-10 06:26:37,099 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:26:37,100 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-10 06:26:37,100 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0039s)
2025-04-10 06:26:37,100 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0022s)
2025-04-10 06:26:37,104 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:37,105 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:37,108 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0033s)
2025-04-10 06:26:37,108 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0040s)
2025-04-10 06:26:37,152 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:26:37,153 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:26:37,159 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0060s)
2025-04-10 06:26:37,159 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0072s)
2025-04-10 06:26:37,177 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:26:37,180 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0025s)
2025-04-10 06:26:37,294 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:37,299 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0048s)
2025-04-10 06:26:38,420 - app.main - INFO - 收到请求: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 (来自: 172.19.0.1)
2025-04-10 06:26:38,423 - app.main - INFO - 请求完成: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 - 200 (耗时: 0.0031s)
2025-04-10 06:26:38,717 - app.main - INFO - 收到请求: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 (来自: 172.19.0.1)
2025-04-10 06:26:38,721 - app.main - INFO - 请求完成: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 - 200 (耗时: 0.0037s)
2025-04-10 06:26:39,097 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:26:39,100 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0028s)
2025-04-10 06:26:39,626 - app.main - INFO - 收到请求: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 (来自: 172.19.0.1)
2025-04-10 06:26:39,629 - app.main - INFO - 请求完成: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 - 200 (耗时: 0.0029s)
2025-04-10 06:26:39,990 - app.main - INFO - 收到请求: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 (来自: 172.19.0.1)
2025-04-10 06:26:39,992 - app.main - INFO - 请求完成: GET /chats/c418816a-fcc6-4c6a-b252-b546b78ab6e1 - 200 (耗时: 0.0023s)
2025-04-10 06:26:40,951 - app.main - INFO - 收到请求: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 (来自: 172.19.0.1)
2025-04-10 06:26:40,954 - app.main - INFO - 请求完成: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 - 200 (耗时: 0.0031s)
2025-04-10 06:26:41,314 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-10 06:26:41,319 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0052s)
2025-04-10 06:26:42,939 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:42,942 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0026s)
2025-04-10 06:26:44,968 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:26:44,984 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0160s)
2025-04-10 06:31:45,638 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 06:31:45,638 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-10 06:31:45,650 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 06:31:45,653 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0030s)
2025-04-10 06:31:46,659 - app.main - INFO - 收到请求: POST /flows/61751c36-5c34-4dcb-90ac-73480ce54638/set-as-last-selected (来自: 172.19.0.1)
2025-04-10 06:31:46,659 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 06:31:46,671 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 06:31:46,674 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 06:31:46,675 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-10 06:31:46,676 - app.main - INFO - 请求完成: POST /flows/61751c36-5c34-4dcb-90ac-73480ce54638/set-as-last-selected - 200 (耗时: 0.0168s)
2025-04-10 06:31:46,676 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0168s)
2025-04-10 06:31:46,680 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0046s)
2025-04-10 06:31:46,697 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 06:31:46,698 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 06:31:46,698 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0013s)
2025-04-10 06:31:46,700 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 06:31:46,701 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 06:31:46,701 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-10 06:31:46,708 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 06:31:46,709 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 06:31:46,712 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 06:31:46,712 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 06:31:46,712 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 06:31:46,713 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:31:46,713 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 06:31:46,716 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 06:31:46,717 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:31:46,718 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 06:31:46,718 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0096s)
2025-04-10 06:31:46,718 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0093s)
2025-04-10 06:31:46,719 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0069s)
2025-04-10 06:31:46,720 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0072s)
2025-04-10 06:31:46,755 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 06:31:46,758 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0027s)
2025-04-10 06:31:48,571 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 06:31:48,572 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 06:31:48,573 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:31:48,574 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 06:31:48,574 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 06:31:48,575 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 06:31:48,575 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0032s)
2025-04-10 06:31:48,575 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0040s)
2025-04-10 06:31:48,583 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 06:31:48,583 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 06:31:48,587 - app.main - INFO - 请求完成: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0042s)
2025-04-10 06:31:48,587 - app.main - INFO - 请求完成: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0042s)
2025-04-10 06:31:48,757 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 06:31:48,763 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0065s)
2025-04-10 06:31:49,604 - app.main - INFO - 收到请求: GET /chats/b6208e81-685c-470b-b167-b43b9ecdeac8 (来自: 172.19.0.1)
2025-04-10 06:31:49,606 - app.main - INFO - 请求完成: GET /chats/b6208e81-685c-470b-b167-b43b9ecdeac8 - 200 (耗时: 0.0024s)
2025-04-10 06:31:50,026 - app.main - INFO - 收到请求: GET /chats/675dee98-4c26-4c79-8ebd-4a8cd2f3d9b9 (来自: 172.19.0.1)
2025-04-10 06:31:50,028 - app.main - INFO - 请求完成: GET /chats/675dee98-4c26-4c79-8ebd-4a8cd2f3d9b9 - 200 (耗时: 0.0024s)
2025-04-10 06:31:50,538 - app.main - INFO - 收到请求: GET /chats/ac884264-5bf5-4f43-8533-171ea86e92b2 (来自: 172.19.0.1)
2025-04-10 06:31:50,541 - app.main - INFO - 请求完成: GET /chats/ac884264-5bf5-4f43-8533-171ea86e92b2 - 200 (耗时: 0.0024s)
2025-04-10 06:31:50,855 - app.main - INFO - 收到请求: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de (来自: 172.19.0.1)
2025-04-10 06:31:50,859 - app.main - INFO - 请求完成: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de - 200 (耗时: 0.0040s)
2025-04-10 06:31:51,541 - app.main - INFO - 收到请求: GET /chats/ac884264-5bf5-4f43-8533-171ea86e92b2 (来自: 172.19.0.1)
2025-04-10 06:31:51,543 - app.main - INFO - 请求完成: GET /chats/ac884264-5bf5-4f43-8533-171ea86e92b2 - 200 (耗时: 0.0022s)
2025-04-10 06:31:51,862 - app.main - INFO - 收到请求: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de (来自: 172.19.0.1)
2025-04-10 06:31:51,865 - app.main - INFO - 请求完成: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de - 200 (耗时: 0.0027s)
2025-04-10 07:30:36,943 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 07:30:36,944 - app.main - INFO - 开始导入模块...
2025-04-10 07:30:36,944 - app.main - INFO - 导入database成功
2025-04-10 07:30:36,944 - app.main - INFO - 导入models成功
2025-04-10 07:30:36,944 - app.main - INFO - 导入config成功
2025-04-10 07:30:37,024 - app.main - INFO - 导入基本路由成功
2025-04-10 07:30:37,025 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.deepseek_client_service'
2025-04-10 07:30:37,025 - app.main - INFO - 导入utils成功
2025-04-10 07:30:37,025 - app.main - INFO - 导入dependencies成功
2025-04-10 07:30:37,025 - app.main - INFO - 创建数据库表...
2025-04-10 07:30:37,026 - app.main - INFO - 数据库表创建成功
2025-04-10 07:30:37,026 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 07:30:37,032 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 07:30:37,033 - app.main - INFO - 注册路由...
2025-04-10 07:30:37,038 - app.main - INFO - 注册user路由成功
2025-04-10 07:30:37,043 - app.main - INFO - 注册flow路由成功
2025-04-10 07:30:37,043 - app.main - INFO - 注册email路由成功
2025-04-10 07:30:37,044 - app.main - INFO - 注册auth路由成功
2025-04-10 07:30:37,044 - app.main - INFO - 注册node_templates路由成功
2025-04-10 07:30:37,044 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 07:30:37,053 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 07:30:37,053 - app.main - INFO - 注册chat路由成功
2025-04-10 07:30:37,053 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 07:30:37,054 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 07:30:37,054 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 07:30:37,054 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 07:30:37,054 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 07:30:37,054 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 07:30:37,054 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 07:30:37,054 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 07:30:37,055 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 07:30:37,055 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 07:30:37,055 - backend.app.startup - INFO - API前缀: /api
2025-04-10 07:30:37,055 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 07:31:33,280 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 07:31:33,280 - app.main - INFO - 开始导入模块...
2025-04-10 07:31:33,280 - app.main - INFO - 导入database成功
2025-04-10 07:31:33,280 - app.main - INFO - 导入models成功
2025-04-10 07:31:33,280 - app.main - INFO - 导入config成功
2025-04-10 07:31:33,363 - app.main - INFO - 导入基本路由成功
2025-04-10 07:31:33,363 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.prompt_service'
2025-04-10 07:31:33,363 - app.main - INFO - 导入utils成功
2025-04-10 07:31:33,363 - app.main - INFO - 导入dependencies成功
2025-04-10 07:31:33,363 - app.main - INFO - 创建数据库表...
2025-04-10 07:31:33,364 - app.main - INFO - 数据库表创建成功
2025-04-10 07:31:33,364 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 07:31:33,370 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 07:31:33,370 - app.main - INFO - 注册路由...
2025-04-10 07:31:33,376 - app.main - INFO - 注册user路由成功
2025-04-10 07:31:33,381 - app.main - INFO - 注册flow路由成功
2025-04-10 07:31:33,382 - app.main - INFO - 注册email路由成功
2025-04-10 07:31:33,382 - app.main - INFO - 注册auth路由成功
2025-04-10 07:31:33,382 - app.main - INFO - 注册node_templates路由成功
2025-04-10 07:31:33,382 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 07:31:33,391 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 07:31:33,391 - app.main - INFO - 注册chat路由成功
2025-04-10 07:31:33,391 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 07:31:33,393 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 07:31:33,393 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 07:31:33,393 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 07:31:33,393 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 07:31:33,393 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 07:31:33,393 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 07:31:33,393 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 07:31:33,393 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 07:31:33,393 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 07:31:33,393 - backend.app.startup - INFO - API前缀: /api
2025-04-10 07:31:33,393 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 07:31:45,196 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 07:31:45,196 - app.main - INFO - 开始导入模块...
2025-04-10 07:31:45,197 - app.main - INFO - 导入database成功
2025-04-10 07:31:45,197 - app.main - INFO - 导入models成功
2025-04-10 07:31:45,197 - app.main - INFO - 导入config成功
2025-04-10 07:31:45,275 - app.main - INFO - 导入基本路由成功
2025-04-10 07:31:45,275 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.prompt_service'
2025-04-10 07:31:45,275 - app.main - INFO - 导入utils成功
2025-04-10 07:31:45,275 - app.main - INFO - 导入dependencies成功
2025-04-10 07:31:45,275 - app.main - INFO - 创建数据库表...
2025-04-10 07:31:45,276 - app.main - INFO - 数据库表创建成功
2025-04-10 07:31:45,276 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 07:31:45,282 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 07:31:45,282 - app.main - INFO - 注册路由...
2025-04-10 07:31:45,288 - app.main - INFO - 注册user路由成功
2025-04-10 07:31:45,293 - app.main - INFO - 注册flow路由成功
2025-04-10 07:31:45,293 - app.main - INFO - 注册email路由成功
2025-04-10 07:31:45,294 - app.main - INFO - 注册auth路由成功
2025-04-10 07:31:45,294 - app.main - INFO - 注册node_templates路由成功
2025-04-10 07:31:45,294 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 07:31:45,302 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 07:31:45,303 - app.main - INFO - 注册chat路由成功
2025-04-10 07:31:45,303 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 07:31:45,304 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 07:31:45,304 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 07:31:45,304 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 07:31:45,304 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 07:31:45,304 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 07:31:45,304 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 07:31:45,304 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 07:31:45,304 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 07:31:45,304 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 07:31:45,304 - backend.app.startup - INFO - API前缀: /api
2025-04-10 07:31:45,304 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 07:32:14,567 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 07:32:14,567 - app.main - INFO - 开始导入模块...
2025-04-10 07:32:14,567 - app.main - INFO - 导入database成功
2025-04-10 07:32:14,567 - app.main - INFO - 导入models成功
2025-04-10 07:32:14,567 - app.main - INFO - 导入config成功
2025-04-10 07:32:14,650 - app.main - INFO - 导入基本路由成功
2025-04-10 07:32:14,650 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.prompt_service'
2025-04-10 07:32:14,650 - app.main - INFO - 导入utils成功
2025-04-10 07:32:14,650 - app.main - INFO - 导入dependencies成功
2025-04-10 07:32:14,650 - app.main - INFO - 创建数据库表...
2025-04-10 07:32:14,651 - app.main - INFO - 数据库表创建成功
2025-04-10 07:32:14,651 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 07:32:14,657 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 07:32:14,657 - app.main - INFO - 注册路由...
2025-04-10 07:32:14,663 - app.main - INFO - 注册user路由成功
2025-04-10 07:32:14,668 - app.main - INFO - 注册flow路由成功
2025-04-10 07:32:14,669 - app.main - INFO - 注册email路由成功
2025-04-10 07:32:14,669 - app.main - INFO - 注册auth路由成功
2025-04-10 07:32:14,670 - app.main - INFO - 注册node_templates路由成功
2025-04-10 07:32:14,670 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 07:32:14,679 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 07:32:14,679 - app.main - INFO - 注册chat路由成功
2025-04-10 07:32:14,679 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 07:32:14,680 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 07:32:14,680 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 07:32:14,680 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 07:32:14,680 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 07:32:14,680 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 07:32:14,680 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 07:32:14,680 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 07:32:14,680 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 07:32:14,680 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 07:32:14,680 - backend.app.startup - INFO - API前缀: /api
2025-04-10 07:32:14,680 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 07:32:37,012 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 07:32:37,013 - app.main - INFO - 开始导入模块...
2025-04-10 07:32:37,013 - app.main - INFO - 导入database成功
2025-04-10 07:32:37,013 - app.main - INFO - 导入models成功
2025-04-10 07:32:37,013 - app.main - INFO - 导入config成功
2025-04-10 07:32:37,094 - app.main - INFO - 导入基本路由成功
2025-04-10 07:32:37,095 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.prompt_service'
2025-04-10 07:32:37,095 - app.main - INFO - 导入utils成功
2025-04-10 07:32:37,095 - app.main - INFO - 导入dependencies成功
2025-04-10 07:32:37,095 - app.main - INFO - 创建数据库表...
2025-04-10 07:32:37,095 - app.main - INFO - 数据库表创建成功
2025-04-10 07:32:37,095 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 07:32:37,102 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 07:32:37,102 - app.main - INFO - 注册路由...
2025-04-10 07:32:37,107 - app.main - INFO - 注册user路由成功
2025-04-10 07:32:37,112 - app.main - INFO - 注册flow路由成功
2025-04-10 07:32:37,112 - app.main - INFO - 注册email路由成功
2025-04-10 07:32:37,113 - app.main - INFO - 注册auth路由成功
2025-04-10 07:32:37,113 - app.main - INFO - 注册node_templates路由成功
2025-04-10 07:32:37,113 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 07:32:37,122 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 07:32:37,122 - app.main - INFO - 注册chat路由成功
2025-04-10 07:32:37,122 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 07:32:37,123 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 07:32:37,123 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 07:32:37,123 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 07:32:37,123 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 07:32:37,123 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 07:32:37,123 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 07:32:37,123 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 07:32:37,123 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 07:32:37,123 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 07:32:37,123 - backend.app.startup - INFO - API前缀: /api
2025-04-10 07:32:37,123 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 07:33:13,418 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 07:33:13,418 - app.main - INFO - 开始导入模块...
2025-04-10 07:33:13,418 - app.main - INFO - 导入database成功
2025-04-10 07:33:13,418 - app.main - INFO - 导入models成功
2025-04-10 07:33:13,418 - app.main - INFO - 导入config成功
2025-04-10 07:33:13,500 - app.main - INFO - 导入基本路由成功
2025-04-10 07:33:13,501 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.prompt_service'
2025-04-10 07:33:13,501 - app.main - INFO - 导入utils成功
2025-04-10 07:33:13,501 - app.main - INFO - 导入dependencies成功
2025-04-10 07:33:13,501 - app.main - INFO - 创建数据库表...
2025-04-10 07:33:13,501 - app.main - INFO - 数据库表创建成功
2025-04-10 07:33:13,501 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 07:33:13,508 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 07:33:13,508 - app.main - INFO - 注册路由...
2025-04-10 07:33:13,513 - app.main - INFO - 注册user路由成功
2025-04-10 07:33:13,518 - app.main - INFO - 注册flow路由成功
2025-04-10 07:33:13,518 - app.main - INFO - 注册email路由成功
2025-04-10 07:33:13,519 - app.main - INFO - 注册auth路由成功
2025-04-10 07:33:13,519 - app.main - INFO - 注册node_templates路由成功
2025-04-10 07:33:13,519 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 07:33:13,530 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 07:33:13,531 - app.main - INFO - 注册chat路由成功
2025-04-10 07:33:13,531 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 07:33:13,532 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 07:33:13,532 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 07:33:13,532 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 07:33:13,532 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 07:33:13,532 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 07:33:13,532 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 07:33:13,532 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 07:33:13,532 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 07:33:13,532 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 07:33:13,532 - backend.app.startup - INFO - API前缀: /api
2025-04-10 07:33:13,532 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 07:33:31,142 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 07:33:31,143 - app.main - INFO - 开始导入模块...
2025-04-10 07:33:31,143 - app.main - INFO - 导入database成功
2025-04-10 07:33:31,143 - app.main - INFO - 导入models成功
2025-04-10 07:33:31,143 - app.main - INFO - 导入config成功
2025-04-10 07:33:31,223 - app.main - INFO - 导入基本路由成功
2025-04-10 07:33:31,224 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.prompt_service'
2025-04-10 07:33:31,224 - app.main - INFO - 导入utils成功
2025-04-10 07:33:31,224 - app.main - INFO - 导入dependencies成功
2025-04-10 07:33:31,224 - app.main - INFO - 创建数据库表...
2025-04-10 07:33:31,224 - app.main - INFO - 数据库表创建成功
2025-04-10 07:33:31,224 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 07:33:31,231 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 07:33:31,231 - app.main - INFO - 注册路由...
2025-04-10 07:33:31,236 - app.main - INFO - 注册user路由成功
2025-04-10 07:33:31,241 - app.main - INFO - 注册flow路由成功
2025-04-10 07:33:31,242 - app.main - INFO - 注册email路由成功
2025-04-10 07:33:31,242 - app.main - INFO - 注册auth路由成功
2025-04-10 07:33:31,242 - app.main - INFO - 注册node_templates路由成功
2025-04-10 07:33:31,242 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 07:33:31,251 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 07:33:31,251 - app.main - INFO - 注册chat路由成功
2025-04-10 07:33:31,251 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 07:33:31,252 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 07:33:31,252 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 07:33:31,252 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 07:33:31,252 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 07:33:31,252 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 07:33:31,252 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 07:33:31,252 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 07:33:31,253 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 07:33:31,253 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 07:33:31,253 - backend.app.startup - INFO - API前缀: /api
2025-04-10 07:33:31,253 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 07:34:07,529 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 07:34:07,529 - app.main - INFO - 开始导入模块...
2025-04-10 07:34:07,529 - app.main - INFO - 导入database成功
2025-04-10 07:34:07,529 - app.main - INFO - 导入models成功
2025-04-10 07:34:07,529 - app.main - INFO - 导入config成功
2025-04-10 07:34:07,606 - app.main - INFO - 导入基本路由成功
2025-04-10 07:34:07,606 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.prompt_service'
2025-04-10 07:34:07,606 - app.main - INFO - 导入utils成功
2025-04-10 07:34:07,606 - app.main - INFO - 导入dependencies成功
2025-04-10 07:34:07,606 - app.main - INFO - 创建数据库表...
2025-04-10 07:34:07,607 - app.main - INFO - 数据库表创建成功
2025-04-10 07:34:07,607 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 07:34:07,613 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 07:34:07,613 - app.main - INFO - 注册路由...
2025-04-10 07:34:07,618 - app.main - INFO - 注册user路由成功
2025-04-10 07:34:07,623 - app.main - INFO - 注册flow路由成功
2025-04-10 07:34:07,624 - app.main - INFO - 注册email路由成功
2025-04-10 07:34:07,624 - app.main - INFO - 注册auth路由成功
2025-04-10 07:34:07,625 - app.main - INFO - 注册node_templates路由成功
2025-04-10 07:34:07,625 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 07:34:07,633 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 07:34:07,633 - app.main - INFO - 注册chat路由成功
2025-04-10 07:34:07,633 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 07:34:07,634 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 07:34:07,634 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 07:34:07,634 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 07:34:07,634 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 07:34:07,634 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 07:34:07,634 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 07:34:07,634 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 07:34:07,635 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 07:34:07,635 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 07:34:07,635 - backend.app.startup - INFO - API前缀: /api
2025-04-10 07:34:07,635 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 07:34:49,978 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 07:34:49,978 - app.main - INFO - 开始导入模块...
2025-04-10 07:34:49,978 - app.main - INFO - 导入database成功
2025-04-10 07:34:49,978 - app.main - INFO - 导入models成功
2025-04-10 07:34:49,978 - app.main - INFO - 导入config成功
2025-04-10 07:34:50,074 - app.main - ERROR - 导入模块时出错: f-string: unmatched '(' (workflow_chain.py, line 131)
2025-04-10 08:08:00,608 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:08:00,608 - app.main - INFO - 开始导入模块...
2025-04-10 08:08:00,608 - app.main - INFO - 导入database成功
2025-04-10 08:08:00,608 - app.main - INFO - 导入models成功
2025-04-10 08:08:00,608 - app.main - INFO - 导入config成功
2025-04-10 08:08:00,671 - app.main - ERROR - 导入模块时出错: f-string: unmatched '(' (workflow_chain.py, line 131)
2025-04-10 08:08:38,781 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:08:38,781 - app.main - INFO - 开始导入模块...
2025-04-10 08:08:38,781 - app.main - INFO - 导入database成功
2025-04-10 08:08:38,781 - app.main - INFO - 导入models成功
2025-04-10 08:08:38,781 - app.main - INFO - 导入config成功
2025-04-10 08:08:39,364 - langchainchat.prompts - ERROR - 获取节点类型提示文本失败: No module named 'backend.app.services.node_type_prompt_service'
2025-04-10 08:08:39,365 - app.main - ERROR - 导入模块时出错: No module named 'backend.langchainchat.prompts.expansion_service'
2025-04-10 08:10:27,640 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:10:27,640 - app.main - INFO - 开始导入模块...
2025-04-10 08:10:27,640 - app.main - INFO - 导入database成功
2025-04-10 08:10:27,640 - app.main - INFO - 导入models成功
2025-04-10 08:10:27,641 - app.main - INFO - 导入config成功
2025-04-10 08:10:28,213 - app.main - ERROR - 导入模块时出错: No module named 'langchainchat.config'
2025-04-10 08:12:07,956 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:12:07,956 - app.main - INFO - 开始导入模块...
2025-04-10 08:12:07,956 - app.main - INFO - 导入database成功
2025-04-10 08:12:07,956 - app.main - INFO - 导入models成功
2025-04-10 08:12:07,957 - app.main - INFO - 导入config成功
2025-04-10 08:12:08,572 - app.main - ERROR - 导入模块时出错: cannot import name 'settings' from 'backend.config' (/workspace/backend/config/__init__.py)
2025-04-10 08:13:11,614 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:13:11,615 - app.main - INFO - 开始导入模块...
2025-04-10 08:13:11,615 - app.main - INFO - 导入database成功
2025-04-10 08:13:11,615 - app.main - INFO - 导入models成功
2025-04-10 08:13:11,615 - app.main - INFO - 导入config成功
2025-04-10 08:13:12,206 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:13:12,206 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:13:12,206 - app.main - ERROR - 导入模块时出错: name 'DeepSeekLLM' is not defined
2025-04-10 08:13:53,651 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:13:53,651 - app.main - INFO - 开始导入模块...
2025-04-10 08:13:53,651 - app.main - INFO - 导入database成功
2025-04-10 08:13:53,651 - app.main - INFO - 导入models成功
2025-04-10 08:13:53,651 - app.main - INFO - 导入config成功
2025-04-10 08:13:54,256 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:13:54,256 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:13:54,264 - app.main - ERROR - 导入模块时出错: cannot import name 'StructuredPropertySchema' from 'langchainchat.tools.definitions' (/workspace/backend/langchainchat/tools/definitions.py)
2025-04-10 08:14:41,586 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:14:41,586 - app.main - INFO - 开始导入模块...
2025-04-10 08:14:41,586 - app.main - INFO - 导入database成功
2025-04-10 08:14:41,586 - app.main - INFO - 导入models成功
2025-04-10 08:14:41,586 - app.main - INFO - 导入config成功
2025-04-10 08:14:42,167 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:14:42,168 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:14:42,174 - app.main - ERROR - 导入模块时出错: cannot import name 'StructuredPropertySchema' from 'langchainchat.tools.definitions' (/workspace/backend/langchainchat/tools/definitions.py)
2025-04-10 08:14:50,384 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:14:50,384 - app.main - INFO - 开始导入模块...
2025-04-10 08:14:50,384 - app.main - INFO - 导入database成功
2025-04-10 08:14:50,384 - app.main - INFO - 导入models成功
2025-04-10 08:14:50,384 - app.main - INFO - 导入config成功
2025-04-10 08:14:50,976 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:14:50,976 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:14:50,986 - app.main - ERROR - 导入模块时出错: Unable to generate pydantic-core schema for <class 'backend.langchainchat.llms.deepseek_client.DeepSeekLLM'>. Set `arbitrary_types_allowed=True` in the model_config to ignore this error or implement `__get_pydantic_core_schema__` on your type to fully support it.

If you got this error by calling handler(<some type>) within `__get_pydantic_core_schema__` then you likely need to call `handler.generate_schema(<some type>)` since we do not call `__get_pydantic_core_schema__` on `<some type>` otherwise to avoid infinite recursion.

For further information visit https://errors.pydantic.dev/2.7/u/schema-for-unknown-type
2025-04-10 08:16:15,276 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:16:15,276 - app.main - INFO - 开始导入模块...
2025-04-10 08:16:15,276 - app.main - INFO - 导入database成功
2025-04-10 08:16:15,276 - app.main - INFO - 导入models成功
2025-04-10 08:16:15,276 - app.main - INFO - 导入config成功
2025-04-10 08:16:15,875 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:16:15,875 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:16:15,884 - app.main - ERROR - 导入模块时出错: Unable to generate pydantic-core schema for <class 'backend.langchainchat.llms.deepseek_client.DeepSeekLLM'>. Set `arbitrary_types_allowed=True` in the model_config to ignore this error or implement `__get_pydantic_core_schema__` on your type to fully support it.

If you got this error by calling handler(<some type>) within `__get_pydantic_core_schema__` then you likely need to call `handler.generate_schema(<some type>)` since we do not call `__get_pydantic_core_schema__` on `<some type>` otherwise to avoid infinite recursion.

For further information visit https://errors.pydantic.dev/2.7/u/schema-for-unknown-type
2025-04-10 08:17:08,757 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:17:08,757 - app.main - INFO - 开始导入模块...
2025-04-10 08:17:08,757 - app.main - INFO - 导入database成功
2025-04-10 08:17:08,758 - app.main - INFO - 导入models成功
2025-04-10 08:17:08,758 - app.main - INFO - 导入config成功
2025-04-10 08:17:09,345 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:17:09,345 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:17:09,355 - app.main - ERROR - 导入模块时出错: Unable to generate pydantic-core schema for <class 'backend.langchainchat.llms.deepseek_client.DeepSeekLLM'>. Set `arbitrary_types_allowed=True` in the model_config to ignore this error or implement `__get_pydantic_core_schema__` on your type to fully support it.

If you got this error by calling handler(<some type>) within `__get_pydantic_core_schema__` then you likely need to call `handler.generate_schema(<some type>)` since we do not call `__get_pydantic_core_schema__` on `<some type>` otherwise to avoid infinite recursion.

For further information visit https://errors.pydantic.dev/2.7/u/schema-for-unknown-type
2025-04-10 08:17:22,826 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:17:22,826 - app.main - INFO - 开始导入模块...
2025-04-10 08:17:22,826 - app.main - INFO - 导入database成功
2025-04-10 08:17:22,826 - app.main - INFO - 导入models成功
2025-04-10 08:17:22,826 - app.main - INFO - 导入config成功
2025-04-10 08:17:23,421 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:17:23,421 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:17:23,433 - app.main - ERROR - 导入模块时出错: No module named 'backend.app.services.prompt_service'
2025-04-10 08:18:02,266 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:18:02,266 - app.main - INFO - 开始导入模块...
2025-04-10 08:18:02,266 - app.main - INFO - 导入database成功
2025-04-10 08:18:02,266 - app.main - INFO - 导入models成功
2025-04-10 08:18:02,266 - app.main - INFO - 导入config成功
2025-04-10 08:18:02,852 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:18:02,852 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:18:02,859 - app.main - ERROR - 导入模块时出错: No module named 'backend.app.services.prompt_service'
2025-04-10 08:20:34,788 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:20:34,788 - app.main - INFO - 开始导入模块...
2025-04-10 08:20:34,788 - app.main - INFO - 导入database成功
2025-04-10 08:20:34,788 - app.main - INFO - 导入models成功
2025-04-10 08:20:34,788 - app.main - INFO - 导入config成功
2025-04-10 08:20:35,382 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:20:35,383 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:20:35,390 - app.main - ERROR - 导入模块时出错: name 'TypeVar' is not defined
2025-04-10 08:21:17,569 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:21:17,569 - app.main - INFO - 开始导入模块...
2025-04-10 08:21:17,569 - app.main - INFO - 导入database成功
2025-04-10 08:21:17,569 - app.main - INFO - 导入models成功
2025-04-10 08:21:17,570 - app.main - INFO - 导入config成功
2025-04-10 08:21:18,158 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:21:18,158 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:21:18,175 - langchainchat.prompts - ERROR - 获取节点类型提示文本失败: No module named 'backend.app.services.node_type_prompt_service'
2025-04-10 08:21:18,175 - langchainchat.prompts - ERROR - 获取节点类型提示文本失败: No module named 'backend.app.services.node_type_prompt_service'
2025-04-10 08:21:18,176 - app.main - ERROR - 导入模块时出错: name 'BaseModel' is not defined
2025-04-10 08:22:38,947 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:22:38,947 - app.main - INFO - 开始导入模块...
2025-04-10 08:22:38,947 - app.main - INFO - 导入database成功
2025-04-10 08:22:38,947 - app.main - INFO - 导入models成功
2025-04-10 08:22:38,947 - app.main - INFO - 导入config成功
2025-04-10 08:22:39,311 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:22:39,311 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:22:39,538 - langchainchat.prompts - ERROR - 获取节点类型提示文本失败: No module named 'backend.app.services.node_type_prompt_service'
2025-04-10 08:22:39,539 - langchainchat.prompts - ERROR - 获取节点类型提示文本失败: No module named 'backend.app.services.node_type_prompt_service'
2025-04-10 08:22:39,539 - app.main - ERROR - 导入模块时出错: Unable to generate pydantic-core schema for <class 'sqlalchemy.orm.session.Session'>. Set `arbitrary_types_allowed=True` in the model_config to ignore this error or implement `__get_pydantic_core_schema__` on your type to fully support it.

If you got this error by calling handler(<some type>) within `__get_pydantic_core_schema__` then you likely need to call `handler.generate_schema(<some type>)` since we do not call `__get_pydantic_core_schema__` on `<some type>` otherwise to avoid infinite recursion.

For further information visit https://errors.pydantic.dev/2.7/u/schema-for-unknown-type
2025-04-10 08:23:29,111 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:23:29,111 - app.main - INFO - 开始导入模块...
2025-04-10 08:23:29,111 - app.main - INFO - 导入database成功
2025-04-10 08:23:29,111 - app.main - INFO - 导入models成功
2025-04-10 08:23:29,111 - app.main - INFO - 导入config成功
2025-04-10 08:23:29,494 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:23:29,494 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:23:29,724 - app.main - ERROR - 导入模块时出错: Unable to generate pydantic-core schema for <class 'sqlalchemy.orm.session.Session'>. Set `arbitrary_types_allowed=True` in the model_config to ignore this error or implement `__get_pydantic_core_schema__` on your type to fully support it.

If you got this error by calling handler(<some type>) within `__get_pydantic_core_schema__` then you likely need to call `handler.generate_schema(<some type>)` since we do not call `__get_pydantic_core_schema__` on `<some type>` otherwise to avoid infinite recursion.

For further information visit https://errors.pydantic.dev/2.7/u/schema-for-unknown-type
2025-04-10 08:25:36,335 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:25:36,335 - app.main - INFO - 开始导入模块...
2025-04-10 08:25:36,335 - app.main - INFO - 导入database成功
2025-04-10 08:25:36,335 - app.main - INFO - 导入models成功
2025-04-10 08:25:36,335 - app.main - INFO - 导入config成功
2025-04-10 08:25:36,702 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:25:36,702 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:25:36,973 - app.main - ERROR - 导入模块时出错: No module named 'langchainchat.config'
2025-04-10 08:26:17,804 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:26:17,805 - app.main - INFO - 开始导入模块...
2025-04-10 08:26:17,805 - app.main - INFO - 导入database成功
2025-04-10 08:26:17,805 - app.main - INFO - 导入models成功
2025-04-10 08:26:17,805 - app.main - INFO - 导入config成功
2025-04-10 08:26:18,169 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:26:18,169 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:26:18,440 - app.main - ERROR - 导入模块时出错: cannot import name 'settings' from 'backend.config' (/workspace/backend/config/__init__.py)
2025-04-10 08:27:35,822 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:27:35,823 - app.main - INFO - 开始导入模块...
2025-04-10 08:27:35,823 - app.main - INFO - 导入database成功
2025-04-10 08:27:35,823 - app.main - INFO - 导入models成功
2025-04-10 08:27:35,823 - app.main - INFO - 导入config成功
2025-04-10 08:27:36,191 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:27:36,192 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:27:36,468 - app.main - ERROR - 导入模块时出错: cannot import name 'ChatService' from partially initialized module 'backend.app.services.chat_service' (most likely due to a circular import) (/workspace/backend/app/services/chat_service.py)
2025-04-10 08:29:01,732 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:29:01,733 - app.main - INFO - 开始导入模块...
2025-04-10 08:29:01,733 - app.main - INFO - 导入database成功
2025-04-10 08:29:01,733 - app.main - INFO - 导入models成功
2025-04-10 08:29:01,733 - app.main - INFO - 导入config成功
2025-04-10 08:29:02,104 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:29:02,104 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:29:02,375 - app.main - ERROR - 导入模块时出错: name 'ChatService' is not defined
2025-04-10 08:30:16,564 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:30:16,564 - app.main - INFO - 开始导入模块...
2025-04-10 08:30:16,565 - app.main - INFO - 导入database成功
2025-04-10 08:30:16,565 - app.main - INFO - 导入models成功
2025-04-10 08:30:16,565 - app.main - INFO - 导入config成功
2025-04-10 08:30:16,942 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:30:16,942 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:30:17,220 - app.main - ERROR - 导入模块时出错: Fields must not use names with leading underscores; e.g., use 'messages' instead of '_messages'.
2025-04-10 08:31:42,335 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:31:42,335 - app.main - INFO - 开始导入模块...
2025-04-10 08:31:42,335 - app.main - INFO - 导入database成功
2025-04-10 08:31:42,335 - app.main - INFO - 导入models成功
2025-04-10 08:31:42,335 - app.main - INFO - 导入config成功
2025-04-10 08:31:42,700 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:31:42,700 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:31:42,970 - app.main - ERROR - 导入模块时出错: Unable to generate pydantic-core schema for <class 'sqlalchemy.orm.session.Session'>. Set `arbitrary_types_allowed=True` in the model_config to ignore this error or implement `__get_pydantic_core_schema__` on your type to fully support it.

If you got this error by calling handler(<some type>) within `__get_pydantic_core_schema__` then you likely need to call `handler.generate_schema(<some type>)` since we do not call `__get_pydantic_core_schema__` on `<some type>` otherwise to avoid infinite recursion.

For further information visit https://errors.pydantic.dev/2.7/u/schema-for-unknown-type
2025-04-10 08:32:14,486 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:32:14,486 - app.main - INFO - 开始导入模块...
2025-04-10 08:32:14,486 - app.main - INFO - 导入database成功
2025-04-10 08:32:14,487 - app.main - INFO - 导入models成功
2025-04-10 08:32:14,487 - app.main - INFO - 导入config成功
2025-04-10 08:32:14,860 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:32:14,860 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:32:15,148 - app.main - ERROR - 导入模块时出错: Unable to generate pydantic-core schema for <class 'sqlalchemy.orm.session.Session'>. Set `arbitrary_types_allowed=True` in the model_config to ignore this error or implement `__get_pydantic_core_schema__` on your type to fully support it.

If you got this error by calling handler(<some type>) within `__get_pydantic_core_schema__` then you likely need to call `handler.generate_schema(<some type>)` since we do not call `__get_pydantic_core_schema__` on `<some type>` otherwise to avoid infinite recursion.

For further information visit https://errors.pydantic.dev/2.7/u/schema-for-unknown-type
2025-04-10 08:34:26,990 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:34:26,990 - app.main - INFO - 开始导入模块...
2025-04-10 08:34:26,990 - app.main - INFO - 导入database成功
2025-04-10 08:34:26,990 - app.main - INFO - 导入models成功
2025-04-10 08:34:26,990 - app.main - INFO - 导入config成功
2025-04-10 08:34:27,359 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:34:27,359 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:34:27,647 - app.main - INFO - 导入基本路由成功
2025-04-10 08:34:27,647 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.workflow_prompt_service'
2025-04-10 08:34:27,648 - app.main - INFO - 导入utils成功
2025-04-10 08:34:27,648 - app.main - INFO - 导入dependencies成功
2025-04-10 08:34:27,648 - app.main - INFO - 创建数据库表...
2025-04-10 08:34:27,648 - app.main - INFO - 数据库表创建成功
2025-04-10 08:34:27,648 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 08:34:27,655 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:34:27,655 - app.main - INFO - 注册路由...
2025-04-10 08:34:27,661 - app.main - INFO - 注册user路由成功
2025-04-10 08:34:27,670 - app.main - INFO - 注册flow路由成功
2025-04-10 08:34:27,671 - app.main - INFO - 注册email路由成功
2025-04-10 08:34:27,672 - app.main - INFO - 注册auth路由成功
2025-04-10 08:34:27,672 - app.main - INFO - 注册node_templates路由成功
2025-04-10 08:34:27,672 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 08:34:27,684 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 08:34:27,685 - app.main - INFO - 注册chat路由成功
2025-04-10 08:34:27,685 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 08:34:27,686 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 08:34:27,686 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 08:34:27,686 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 08:34:27,686 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 08:34:27,686 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 08:34:27,686 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 08:34:27,686 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 08:34:27,686 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 08:34:27,686 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 08:34:27,686 - backend.app.startup - INFO - API前缀: /api
2025-04-10 08:34:27,686 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 08:35:23,529 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 08:35:23,531 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 08:35:23,534 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0047s)
2025-04-10 08:35:23,536 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0053s)
2025-04-10 08:35:23,590 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 08:35:23,591 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-10 08:35:23,595 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:35:23,599 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:35:23,600 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0052s)
2025-04-10 08:35:23,635 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 08:35:23,639 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0040s)
2025-04-10 08:35:23,646 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 08:35:23,647 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:35:23,647 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0014s)
2025-04-10 08:35:23,648 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 08:35:23,649 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:35:23,649 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0006s)
2025-04-10 08:35:23,661 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:35:23,662 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:35:23,665 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:35:23,667 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:35:23,669 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0073s)
2025-04-10 08:35:23,669 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0070s)
2025-04-10 08:35:23,670 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:35:23,671 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:35:23,671 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 08:35:23,672 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0019s)
2025-04-10 08:35:23,704 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:35:23,705 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:35:23,706 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 08:35:23,706 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0022s)
2025-04-10 08:35:23,746 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:35:23,750 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0043s)
2025-04-10 08:35:25,747 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:35:25,760 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0126s)
2025-04-10 08:35:25,826 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:35:25,826 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:35:25,828 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:35:25,828 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 08:35:25,829 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:35:25,829 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 08:35:25,829 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0030s)
2025-04-10 08:35:25,830 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0038s)
2025-04-10 08:35:25,836 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:35:25,837 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:35:25,838 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:35:25,872 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:35:25,872 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:35:25,872 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:35:25,872 - database.embedding.service - INFO - 创建EmbeddingService单例实例
2025-04-10 08:35:25,872 - database.embedding.service - INFO - 初始化EmbeddingService，使用LMStudio API: http://localhost:1234/v1
2025-04-10 08:35:25,872 - database.embedding.lmstudio_client - INFO - 初始化LMStudio客户端，API基础URL: http://localhost:1234/v1
2025-04-10 08:35:25,873 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:35:25,874 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:35:25,909 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:35:25,909 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:35:25,909 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:35:25,909 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:35:25,910 - app.main - ERROR - 请求处理出错: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - 'DatabaseEmbeddingService' object has no attribute 'embedding_model' (耗时: 0.0730s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/chat.py", line 122, in get_flow_chats
    chat_service = ChatService(db)
  File "/workspace/backend/app/services/chat_service.py", line 40, in __init__
    self.rag_chain = self._initialize_rag_chain() # RAGChain 返回的是 Runnable
  File "/workspace/backend/app/services/chat_service.py", line 67, in _initialize_rag_chain
    if not embedding_service.embedding_model:
AttributeError: 'DatabaseEmbeddingService' object has no attribute 'embedding_model'
2025-04-10 08:35:25,911 - app.main - ERROR - 请求处理出错: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - 'DatabaseEmbeddingService' object has no attribute 'embedding_model' (耗时: 0.0747s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/chat.py", line 122, in get_flow_chats
    chat_service = ChatService(db)
  File "/workspace/backend/app/services/chat_service.py", line 40, in __init__
    self.rag_chain = self._initialize_rag_chain() # RAGChain 返回的是 Runnable
  File "/workspace/backend/app/services/chat_service.py", line 67, in _initialize_rag_chain
    if not embedding_service.embedding_model:
AttributeError: 'DatabaseEmbeddingService' object has no attribute 'embedding_model'
2025-04-10 08:36:19,950 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:36:19,950 - app.main - INFO - 开始导入模块...
2025-04-10 08:36:19,950 - app.main - INFO - 导入database成功
2025-04-10 08:36:19,950 - app.main - INFO - 导入models成功
2025-04-10 08:36:19,950 - app.main - INFO - 导入config成功
2025-04-10 08:36:20,314 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:36:20,314 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:36:20,585 - app.main - INFO - 导入基本路由成功
2025-04-10 08:36:20,585 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.workflow_prompt_service'
2025-04-10 08:36:20,585 - app.main - INFO - 导入utils成功
2025-04-10 08:36:20,585 - app.main - INFO - 导入dependencies成功
2025-04-10 08:36:20,585 - app.main - INFO - 创建数据库表...
2025-04-10 08:36:20,586 - app.main - INFO - 数据库表创建成功
2025-04-10 08:36:20,586 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 08:36:20,592 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:36:20,592 - app.main - INFO - 注册路由...
2025-04-10 08:36:20,597 - app.main - INFO - 注册user路由成功
2025-04-10 08:36:20,602 - app.main - INFO - 注册flow路由成功
2025-04-10 08:36:20,603 - app.main - INFO - 注册email路由成功
2025-04-10 08:36:20,603 - app.main - INFO - 注册auth路由成功
2025-04-10 08:36:20,603 - app.main - INFO - 注册node_templates路由成功
2025-04-10 08:36:20,603 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 08:36:20,612 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 08:36:20,612 - app.main - INFO - 注册chat路由成功
2025-04-10 08:36:20,612 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 08:36:20,613 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 08:36:20,613 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 08:36:20,613 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 08:36:20,613 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 08:36:20,613 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 08:36:20,613 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 08:36:20,613 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 08:36:20,613 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 08:36:20,613 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 08:36:20,613 - backend.app.startup - INFO - API前缀: /api
2025-04-10 08:36:20,613 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 08:36:41,326 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:36:41,326 - app.main - INFO - 开始导入模块...
2025-04-10 08:36:41,326 - app.main - INFO - 导入database成功
2025-04-10 08:36:41,326 - app.main - INFO - 导入models成功
2025-04-10 08:36:41,326 - app.main - INFO - 导入config成功
2025-04-10 08:36:41,686 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:36:41,686 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:36:41,958 - app.main - INFO - 导入基本路由成功
2025-04-10 08:36:41,958 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.workflow_prompt_service'
2025-04-10 08:36:41,958 - app.main - INFO - 导入utils成功
2025-04-10 08:36:41,959 - app.main - INFO - 导入dependencies成功
2025-04-10 08:36:41,959 - app.main - INFO - 创建数据库表...
2025-04-10 08:36:41,959 - app.main - INFO - 数据库表创建成功
2025-04-10 08:36:41,959 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 08:36:41,966 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:36:41,966 - app.main - INFO - 注册路由...
2025-04-10 08:36:41,970 - app.main - INFO - 注册user路由成功
2025-04-10 08:36:41,976 - app.main - INFO - 注册flow路由成功
2025-04-10 08:36:41,976 - app.main - INFO - 注册email路由成功
2025-04-10 08:36:41,977 - app.main - INFO - 注册auth路由成功
2025-04-10 08:36:41,977 - app.main - INFO - 注册node_templates路由成功
2025-04-10 08:36:41,977 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 08:36:41,986 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 08:36:41,986 - app.main - INFO - 注册chat路由成功
2025-04-10 08:36:41,986 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 08:36:41,987 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 08:36:41,987 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 08:36:41,987 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 08:36:41,987 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 08:36:41,987 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 08:36:41,987 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 08:36:41,987 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 08:36:41,987 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 08:36:41,987 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 08:36:41,987 - backend.app.startup - INFO - API前缀: /api
2025-04-10 08:36:41,987 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 08:37:08,830 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:37:08,831 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:37:08,834 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:37:08,835 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 08:37:08,836 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:37:08,836 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 08:37:08,837 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0054s)
2025-04-10 08:37:08,837 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0064s)
2025-04-10 08:37:08,841 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:37:08,842 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:37:08,844 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:37:08,876 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:37:08,877 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:37:08,877 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:37:08,877 - database.embedding.service - INFO - 创建EmbeddingService单例实例
2025-04-10 08:37:08,877 - database.embedding.service - INFO - 初始化EmbeddingService，使用LMStudio API: http://localhost:1234/v1
2025-04-10 08:37:08,877 - database.embedding.lmstudio_client - INFO - 初始化LMStudio客户端，API基础URL: http://localhost:1234/v1
2025-04-10 08:37:08,877 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:37:08,879 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:37:08,911 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:37:08,911 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:37:08,911 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:37:08,911 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:37:08,912 - app.main - ERROR - 请求处理出错: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - Expected a Runnable, callable or dict.Instead got an unsupported type: <class 'backend.langchainchat.llms.deepseek_client.DeepSeekLLM'> (耗时: 0.0701s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/chat.py", line 122, in get_flow_chats
    chat_service = ChatService(db)
  File "/workspace/backend/app/services/chat_service.py", line 40, in __init__
    self.rag_chain = self._initialize_rag_chain() # RAGChain 返回的是 Runnable
  File "/workspace/backend/app/services/chat_service.py", line 70, in _initialize_rag_chain
    rag_chain = create_rag_chain(llm=self.llm, retriever=retriever)
  File "/workspace/backend/langchainchat/chains/rag_chain.py", line 110, in create_rag_chain
    RunnablePassthrough.assign(
  File "/home/vscode/.local/lib/python3.10/site-packages/langchain_core/runnables/base.py", line 2969, in __or__
    coerce_to_runnable(other),
  File "/home/vscode/.local/lib/python3.10/site-packages/langchain_core/runnables/base.py", line 5853, in coerce_to_runnable
    raise TypeError(msg)
TypeError: Expected a Runnable, callable or dict.Instead got an unsupported type: <class 'backend.langchainchat.llms.deepseek_client.DeepSeekLLM'>
2025-04-10 08:37:08,913 - app.main - ERROR - 请求处理出错: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - Expected a Runnable, callable or dict.Instead got an unsupported type: <class 'backend.langchainchat.llms.deepseek_client.DeepSeekLLM'> (耗时: 0.0720s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/chat.py", line 122, in get_flow_chats
    chat_service = ChatService(db)
  File "/workspace/backend/app/services/chat_service.py", line 40, in __init__
    self.rag_chain = self._initialize_rag_chain() # RAGChain 返回的是 Runnable
  File "/workspace/backend/app/services/chat_service.py", line 70, in _initialize_rag_chain
    rag_chain = create_rag_chain(llm=self.llm, retriever=retriever)
  File "/workspace/backend/langchainchat/chains/rag_chain.py", line 110, in create_rag_chain
    RunnablePassthrough.assign(
  File "/home/vscode/.local/lib/python3.10/site-packages/langchain_core/runnables/base.py", line 2969, in __or__
    coerce_to_runnable(other),
  File "/home/vscode/.local/lib/python3.10/site-packages/langchain_core/runnables/base.py", line 5853, in coerce_to_runnable
    raise TypeError(msg)
TypeError: Expected a Runnable, callable or dict.Instead got an unsupported type: <class 'backend.langchainchat.llms.deepseek_client.DeepSeekLLM'>
2025-04-10 08:38:27,577 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:38:27,578 - app.main - INFO - 开始导入模块...
2025-04-10 08:38:27,578 - app.main - INFO - 导入database成功
2025-04-10 08:38:27,578 - app.main - INFO - 导入models成功
2025-04-10 08:38:27,578 - app.main - INFO - 导入config成功
2025-04-10 08:38:27,939 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:38:27,939 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:38:28,212 - app.main - INFO - 导入基本路由成功
2025-04-10 08:38:28,213 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.workflow_prompt_service'
2025-04-10 08:38:28,213 - app.main - INFO - 导入utils成功
2025-04-10 08:38:28,213 - app.main - INFO - 导入dependencies成功
2025-04-10 08:38:28,213 - app.main - INFO - 创建数据库表...
2025-04-10 08:38:28,213 - app.main - INFO - 数据库表创建成功
2025-04-10 08:38:28,213 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 08:38:28,220 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:38:28,220 - app.main - INFO - 注册路由...
2025-04-10 08:38:28,225 - app.main - INFO - 注册user路由成功
2025-04-10 08:38:28,230 - app.main - INFO - 注册flow路由成功
2025-04-10 08:38:28,231 - app.main - INFO - 注册email路由成功
2025-04-10 08:38:28,232 - app.main - INFO - 注册auth路由成功
2025-04-10 08:38:28,232 - app.main - INFO - 注册node_templates路由成功
2025-04-10 08:38:28,232 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 08:38:28,240 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 08:38:28,240 - app.main - INFO - 注册chat路由成功
2025-04-10 08:38:28,241 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 08:38:28,242 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 08:38:28,242 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 08:38:28,242 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 08:38:28,242 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 08:38:28,242 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 08:38:28,242 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 08:38:28,242 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 08:38:28,242 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 08:38:28,242 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 08:38:28,242 - backend.app.startup - INFO - API前缀: /api
2025-04-10 08:38:28,242 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 08:38:47,980 - app.main - INFO - 收到请求: GET /favicon.ico (来自: 172.19.0.1)
2025-04-10 08:38:47,981 - app.main - INFO - 请求完成: GET /favicon.ico - 404 (耗时: 0.0003s)
2025-04-10 08:38:48,005 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 08:38:48,006 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 08:38:48,010 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0047s)
2025-04-10 08:38:48,010 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0040s)
2025-04-10 08:38:48,042 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 08:38:48,043 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:38:48,043 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0006s)
2025-04-10 08:38:48,046 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:38:48,049 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0063s)
2025-04-10 08:38:48,094 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 08:38:48,095 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:38:48,095 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-10 08:38:48,096 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 08:38:48,097 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:38:48,097 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0008s)
2025-04-10 08:38:48,112 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:38:48,115 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:38:48,117 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:38:48,118 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:38:48,118 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:38:48,119 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0069s)
2025-04-10 08:38:48,121 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:38:48,123 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:38:48,124 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 08:38:48,125 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:38:48,125 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 08:38:48,125 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0084s)
2025-04-10 08:38:48,126 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0076s)
2025-04-10 08:38:48,126 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0076s)
2025-04-10 08:38:48,127 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 08:38:48,130 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0031s)
2025-04-10 08:38:48,180 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:38:48,184 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0042s)
2025-04-10 08:38:49,849 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:38:49,850 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:38:49,852 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:38:49,852 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 08:38:49,853 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:38:49,853 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: None
2025-04-10 08:38:49,854 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0044s)
2025-04-10 08:38:49,854 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0041s)
2025-04-10 08:38:49,859 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:38:49,859 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:38:49,861 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:38:49,894 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:38:49,895 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:38:49,895 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:38:49,895 - database.embedding.service - INFO - 创建EmbeddingService单例实例
2025-04-10 08:38:49,895 - database.embedding.service - INFO - 初始化EmbeddingService，使用LMStudio API: http://localhost:1234/v1
2025-04-10 08:38:49,895 - database.embedding.lmstudio_client - INFO - 初始化LMStudio客户端，API基础URL: http://localhost:1234/v1
2025-04-10 08:38:49,895 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:38:49,905 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:38:49,908 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:38:49,941 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:38:49,941 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:38:49,941 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:38:49,941 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:38:49,941 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:38:49,943 - app.main - INFO - 请求完成: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0833s)
2025-04-10 08:38:49,943 - app.main - INFO - 请求完成: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0842s)
2025-04-10 08:38:50,183 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:38:50,188 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0049s)
2025-04-10 08:38:53,891 - app.main - INFO - 收到请求: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de (来自: 172.19.0.1)
2025-04-10 08:38:53,893 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:38:53,929 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:38:53,929 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:38:53,929 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:38:53,929 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:38:53,929 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:38:53,932 - app.main - INFO - 请求完成: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de - 200 (耗时: 0.0409s)
2025-04-10 08:38:56,783 - app.main - INFO - 收到请求: POST /chats/e817dca0-c24a-4f93-a07d-0aafa93143de/messages (来自: 172.19.0.1)
2025-04-10 08:38:56,785 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:38:56,816 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:38:56,816 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:38:56,816 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:38:56,816 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:38:56,817 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:38:56,818 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 linked to chat: e817dca0-c24a-4f93-a07d-0aafa93143de
2025-04-10 08:38:56,831 - backend.app.services.chat_service - INFO - 已向聊天 e817dca0-c24a-4f93-a07d-0aafa93143de 添加一条 user 消息
2025-04-10 08:38:56,836 - backend.app.routers.chat - INFO - 更新 Flow 61751c36-5c34-4dcb-90ac-73480ce54638 的 last_interacted_chat_id 为 e817dca0-c24a-4f93-a07d-0aafa93143de
2025-04-10 08:38:56,837 - app.main - INFO - 请求完成: POST /chats/e817dca0-c24a-4f93-a07d-0aafa93143de/messages - 200 (耗时: 0.0533s)
2025-04-10 08:39:51,500 - app.main - INFO - 收到请求: POST /chats/ (来自: 172.19.0.1)
2025-04-10 08:39:51,502 - backend.app.routers.chat - INFO - 成功进入 create_chat 函数: POST /chats/
2025-04-10 08:39:51,502 - backend.app.routers.chat - INFO - 验证 flow ownership: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:39:51,503 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:39:51,503 - backend.app.routers.chat - INFO - 调用 chat_service.create_chat
2025-04-10 08:39:51,503 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:39:51,534 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:39:51,534 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:39:51,534 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:39:51,534 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:39:51,534 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:39:51,538 - backend.app.services.chat_service - INFO - 已为流程图 61751c36-5c34-4dcb-90ac-73480ce54638 创建聊天 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:39:51,538 - backend.app.routers.chat - INFO - chat_service.create_chat 返回: <Chat(id=00119e05-f36b-4d0f-a42d-cf8f873f358f, name='新聊天', flow_id=61751c36-5c34-4dcb-90ac-73480ce54638)>
2025-04-10 08:39:51,541 - backend.app.routers.chat - INFO - 更新 Flow 61751c36-5c34-4dcb-90ac-73480ce54638 的 last_interacted_chat_id 为 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:39:51,541 - backend.app.routers.chat - INFO - 成功创建聊天，返回 chat 对象 ID: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:39:51,541 - app.main - INFO - 请求完成: POST /chats/ - 200 (耗时: 0.0410s)
2025-04-10 08:39:51,544 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:39:51,545 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:39:51,579 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:39:51,580 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:39:51,580 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:39:51,580 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:39:51,580 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:39:51,581 - app.main - INFO - 请求完成: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0372s)
2025-04-10 08:39:51,682 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:39:51,684 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:39:51,715 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:39:51,715 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:39:51,715 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:39:51,715 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:39:51,715 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:39:51,717 - app.main - INFO - 请求完成: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - 200 (耗时: 0.0341s)
2025-04-10 08:39:54,164 - app.main - INFO - 收到请求: POST /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f/messages (来自: 172.19.0.1)
2025-04-10 08:39:54,166 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:39:54,197 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:39:54,198 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:39:54,198 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:39:54,198 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:39:54,198 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:39:54,199 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 linked to chat: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:39:54,209 - backend.app.services.chat_service - INFO - 已向聊天 00119e05-f36b-4d0f-a42d-cf8f873f358f 添加一条 user 消息
2025-04-10 08:39:54,212 - backend.app.routers.chat - INFO - 更新 Flow 61751c36-5c34-4dcb-90ac-73480ce54638 的 last_interacted_chat_id 为 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:39:54,213 - app.main - INFO - 请求完成: POST /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f/messages - 200 (耗时: 0.0480s)
2025-04-10 08:43:20,693 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:43:20,693 - app.main - INFO - 开始导入模块...
2025-04-10 08:43:20,693 - app.main - INFO - 导入database成功
2025-04-10 08:43:20,693 - app.main - INFO - 导入models成功
2025-04-10 08:43:20,693 - app.main - INFO - 导入config成功
2025-04-10 08:43:21,069 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:43:21,070 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:43:21,349 - app.main - ERROR - 导入模块时出错: module 'backend.app.schemas' has no attribute 'ChatMessageResponse'
2025-04-10 08:44:14,242 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:44:14,242 - app.main - INFO - 开始导入模块...
2025-04-10 08:44:14,242 - app.main - INFO - 导入database成功
2025-04-10 08:44:14,242 - app.main - INFO - 导入models成功
2025-04-10 08:44:14,242 - app.main - INFO - 导入config成功
2025-04-10 08:44:14,609 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:44:14,609 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:44:14,885 - app.main - INFO - 导入基本路由成功
2025-04-10 08:44:14,885 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.workflow_prompt_service'
2025-04-10 08:44:14,885 - app.main - INFO - 导入utils成功
2025-04-10 08:44:14,885 - app.main - INFO - 导入dependencies成功
2025-04-10 08:44:14,885 - app.main - INFO - 创建数据库表...
2025-04-10 08:44:14,886 - app.main - INFO - 数据库表创建成功
2025-04-10 08:44:14,886 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 08:44:14,892 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:44:14,893 - app.main - INFO - 注册路由...
2025-04-10 08:44:14,898 - app.main - INFO - 注册user路由成功
2025-04-10 08:44:14,903 - app.main - INFO - 注册flow路由成功
2025-04-10 08:44:14,903 - app.main - INFO - 注册email路由成功
2025-04-10 08:44:14,904 - app.main - INFO - 注册auth路由成功
2025-04-10 08:44:14,904 - app.main - INFO - 注册node_templates路由成功
2025-04-10 08:44:14,904 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 08:44:14,913 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 08:44:14,913 - app.main - INFO - 注册chat路由成功
2025-04-10 08:44:14,913 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 08:44:14,914 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 08:44:14,914 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 08:44:14,914 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 08:44:14,914 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 08:44:14,914 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 08:44:14,914 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 08:44:14,914 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 08:44:14,914 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 08:44:14,914 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 08:44:14,914 - backend.app.startup - INFO - API前缀: /api
2025-04-10 08:44:14,914 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 08:47:32,336 - app.main - INFO - 收到请求: POST /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f/messages (来自: 172.19.0.1)
2025-04-10 08:47:32,339 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:47:32,371 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:47:32,371 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:47:32,371 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:47:32,371 - database.embedding.service - INFO - 创建EmbeddingService单例实例
2025-04-10 08:47:32,371 - database.embedding.service - INFO - 初始化EmbeddingService，使用LMStudio API: http://localhost:1234/v1
2025-04-10 08:47:32,371 - database.embedding.lmstudio_client - INFO - 初始化LMStudio客户端，API基础URL: http://localhost:1234/v1
2025-04-10 08:47:32,371 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:47:32,373 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:47:32,375 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 linked to chat: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:47:32,375 - backend.app.services.chat_service - INFO - Processing message for chat 00119e05-f36b-4d0f-a42d-cf8f873f358f: 好好...
2025-04-10 08:47:32,379 - backend.app.services.chat_service - INFO - 已向聊天 00119e05-f36b-4d0f-a42d-cf8f873f358f 添加一条 user 消息
2025-04-10 08:47:32,380 - backend.app.services.chat_service - ERROR - Error processing chat message with WorkflowChain: 'coroutine' object is not iterable
2025-04-10 08:47:32,380 - backend.app.services.chat_service - ERROR - Traceback (most recent call last):
  File "/workspace/backend/app/services/chat_service.py", line 277, in process_chat_message
    chain_result_dict = await self.workflow_chain.acall(chain_input)
  File "/home/vscode/.local/lib/python3.10/site-packages/langchain_core/_api/deprecation.py", line 189, in awarning_emitting_wrapper
    return await wrapped(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/langchain/chains/base.py", line 439, in acall
    return await self.ainvoke(
  File "/home/vscode/.local/lib/python3.10/site-packages/langchain/chains/base.py", line 221, in ainvoke
    raise e
  File "/home/vscode/.local/lib/python3.10/site-packages/langchain/chains/base.py", line 216, in ainvoke
    final_outputs: Dict[str, Any] = await self.aprep_outputs(
  File "/home/vscode/.local/lib/python3.10/site-packages/langchain/chains/base.py", line 490, in aprep_outputs
    self._validate_outputs(outputs)
  File "/home/vscode/.local/lib/python3.10/site-packages/langchain/chains/base.py", line 293, in _validate_outputs
    missing_keys = set(self.output_keys).difference(outputs)
TypeError: 'coroutine' object is not iterable

2025-04-10 08:47:32,382 - backend.app.services.chat_service - INFO - 已向聊天 00119e05-f36b-4d0f-a42d-cf8f873f358f 添加一条 assistant 消息
2025-04-10 08:47:32,383 - backend.app.routers.chat - ERROR - ChatService process_chat_message 返回错误: 'coroutine' object is not iterable
2025-04-10 08:47:32,384 - app.main - INFO - 请求完成: POST /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f/messages - 200 (耗时: 0.0478s)
2025-04-10 08:49:32,809 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:49:32,809 - app.main - INFO - 开始导入模块...
2025-04-10 08:49:32,809 - app.main - INFO - 导入database成功
2025-04-10 08:49:32,809 - app.main - INFO - 导入models成功
2025-04-10 08:49:32,809 - app.main - INFO - 导入config成功
2025-04-10 08:49:33,174 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:49:33,174 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:49:33,406 - app.main - ERROR - 导入模块时出错: name 'CallbackManagerForChainRun' is not defined
2025-04-10 08:49:49,621 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:49:49,621 - app.main - INFO - 开始导入模块...
2025-04-10 08:49:49,621 - app.main - INFO - 导入database成功
2025-04-10 08:49:49,622 - app.main - INFO - 导入models成功
2025-04-10 08:49:49,622 - app.main - INFO - 导入config成功
2025-04-10 08:49:49,989 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:49:49,989 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:49:50,220 - app.main - ERROR - 导入模块时出错: name 'CallbackManagerForChainRun' is not defined
2025-04-10 08:50:36,719 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:50:36,719 - app.main - INFO - 开始导入模块...
2025-04-10 08:50:36,719 - app.main - INFO - 导入database成功
2025-04-10 08:50:36,719 - app.main - INFO - 导入models成功
2025-04-10 08:50:36,719 - app.main - INFO - 导入config成功
2025-04-10 08:50:37,094 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:50:37,094 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:50:37,381 - app.main - INFO - 导入基本路由成功
2025-04-10 08:50:37,381 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.workflow_prompt_service'
2025-04-10 08:50:37,381 - app.main - INFO - 导入utils成功
2025-04-10 08:50:37,381 - app.main - INFO - 导入dependencies成功
2025-04-10 08:50:37,381 - app.main - INFO - 创建数据库表...
2025-04-10 08:50:37,382 - app.main - INFO - 数据库表创建成功
2025-04-10 08:50:37,382 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 08:50:37,388 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:50:37,389 - app.main - INFO - 注册路由...
2025-04-10 08:50:37,394 - app.main - INFO - 注册user路由成功
2025-04-10 08:50:37,399 - app.main - INFO - 注册flow路由成功
2025-04-10 08:50:37,399 - app.main - INFO - 注册email路由成功
2025-04-10 08:50:37,400 - app.main - INFO - 注册auth路由成功
2025-04-10 08:50:37,400 - app.main - INFO - 注册node_templates路由成功
2025-04-10 08:50:37,400 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 08:50:37,409 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 08:50:37,409 - app.main - INFO - 注册chat路由成功
2025-04-10 08:50:37,409 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 08:50:37,410 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 08:50:37,410 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 08:50:37,410 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 08:50:37,410 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 08:50:37,410 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 08:50:37,410 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 08:50:37,410 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 08:50:37,410 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 08:50:37,410 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 08:50:37,410 - backend.app.startup - INFO - API前缀: /api
2025-04-10 08:50:37,410 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 08:51:10,080 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 08:51:10,083 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0031s)
2025-04-10 08:51:10,122 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 08:51:10,124 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0016s)
2025-04-10 08:51:10,127 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:10,131 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:51:10,133 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0053s)
2025-04-10 08:51:10,163 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 08:51:10,163 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-10 08:51:10,181 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 08:51:10,182 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:51:10,182 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-10 08:51:10,184 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 08:51:10,185 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:51:10,185 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0008s)
2025-04-10 08:51:10,198 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:10,201 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:51:10,202 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:10,203 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0046s)
2025-04-10 08:51:10,205 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:51:10,207 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0042s)
2025-04-10 08:51:10,207 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:51:10,208 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:51:10,209 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:51:10,209 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0020s)
2025-04-10 08:51:10,244 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:51:10,246 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:51:10,246 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:51:10,246 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0023s)
2025-04-10 08:51:10,286 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:10,286 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 08:51:10,294 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0073s)
2025-04-10 08:51:10,294 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0082s)
2025-04-10 08:51:12,115 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:51:12,115 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:51:12,116 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:51:12,117 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:51:12,118 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:51:12,118 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:51:12,119 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0033s)
2025-04-10 08:51:12,119 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0041s)
2025-04-10 08:51:12,125 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:12,126 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:12,128 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:51:12,160 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:51:12,161 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:51:12,193 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:51:12,194 - app.main - ERROR - 请求处理出错: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - Can't instantiate abstract class WorkflowChain with abstract method _call (耗时: 0.0677s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/chat.py", line 122, in get_flow_chats
    chat_service = ChatService(db)
  File "/workspace/backend/app/services/chat_service.py", line 38, in __init__
    self.workflow_chain: WorkflowChain = self._initialize_workflow_chain()
  File "/workspace/backend/app/services/chat_service.py", line 53, in _initialize_workflow_chain
    chain = WorkflowChain(
TypeError: Can't instantiate abstract class WorkflowChain with abstract method _call
2025-04-10 08:51:12,195 - app.main - ERROR - 请求处理出错: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - Can't instantiate abstract class WorkflowChain with abstract method _call (耗时: 0.0694s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/chat.py", line 122, in get_flow_chats
    chat_service = ChatService(db)
  File "/workspace/backend/app/services/chat_service.py", line 38, in __init__
    self.workflow_chain: WorkflowChain = self._initialize_workflow_chain()
  File "/workspace/backend/app/services/chat_service.py", line 53, in _initialize_workflow_chain
    chain = WorkflowChain(
TypeError: Can't instantiate abstract class WorkflowChain with abstract method _call
2025-04-10 08:51:12,198 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:51:12,199 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:51:12,232 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:51:12,233 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:51:12,233 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:51:12,233 - app.main - ERROR - 请求处理出错: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - Can't instantiate abstract class WorkflowChain with abstract method _call (耗时: 0.0345s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/chat.py", line 92, in get_chat
    chat_service = ChatService(db)
  File "/workspace/backend/app/services/chat_service.py", line 38, in __init__
    self.workflow_chain: WorkflowChain = self._initialize_workflow_chain()
  File "/workspace/backend/app/services/chat_service.py", line 53, in _initialize_workflow_chain
    chain = WorkflowChain(
TypeError: Can't instantiate abstract class WorkflowChain with abstract method _call
2025-04-10 08:51:12,235 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:51:12,266 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:51:12,268 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:51:12,299 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:51:12,300 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:12,301 - app.main - ERROR - 请求处理出错: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - Can't instantiate abstract class WorkflowChain with abstract method _call (耗时: 0.0679s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/chat.py", line 92, in get_chat
    chat_service = ChatService(db)
  File "/workspace/backend/app/services/chat_service.py", line 38, in __init__
    self.workflow_chain: WorkflowChain = self._initialize_workflow_chain()
  File "/workspace/backend/app/services/chat_service.py", line 53, in _initialize_workflow_chain
    chain = WorkflowChain(
TypeError: Can't instantiate abstract class WorkflowChain with abstract method _call
2025-04-10 08:51:12,301 - app.main - ERROR - 请求处理出错: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - Can't instantiate abstract class WorkflowChain with abstract method _call (耗时: 0.0684s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/chat.py", line 92, in get_chat
    chat_service = ChatService(db)
  File "/workspace/backend/app/services/chat_service.py", line 38, in __init__
    self.workflow_chain: WorkflowChain = self._initialize_workflow_chain()
  File "/workspace/backend/app/services/chat_service.py", line 53, in _initialize_workflow_chain
    chain = WorkflowChain(
TypeError: Can't instantiate abstract class WorkflowChain with abstract method _call
2025-04-10 08:51:12,307 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0063s)
2025-04-10 08:51:34,576 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 08:51:34,576 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 08:51:34,578 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0022s)
2025-04-10 08:51:34,579 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0031s)
2025-04-10 08:51:34,615 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 08:51:34,616 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:34,616 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0008s)
2025-04-10 08:51:34,619 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:51:34,620 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0044s)
2025-04-10 08:51:34,674 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 08:51:34,675 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:51:34,675 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-10 08:51:34,676 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 08:51:34,676 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:51:34,676 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0006s)
2025-04-10 08:51:34,694 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:34,694 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:51:34,704 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:51:34,705 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:34,706 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:51:34,706 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:51:34,707 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:51:34,711 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:51:34,713 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:51:34,713 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:51:34,713 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0195s)
2025-04-10 08:51:34,714 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0191s)
2025-04-10 08:51:34,715 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0092s)
2025-04-10 08:51:34,715 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0092s)
2025-04-10 08:51:34,715 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 08:51:34,718 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0026s)
2025-04-10 08:51:34,759 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:34,774 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0146s)
2025-04-10 08:51:34,776 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:34,780 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0042s)
2025-04-10 08:51:36,776 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:36,779 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0032s)
2025-04-10 08:51:44,854 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:51:44,856 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:51:44,856 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:51:44,857 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:51:44,858 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:51:44,859 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:51:44,859 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0048s)
2025-04-10 08:51:44,859 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0024s)
2025-04-10 08:51:44,865 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:44,866 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:51:44,868 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:51:44,905 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:51:44,906 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:51:44,938 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:51:44,939 - app.main - ERROR - 请求处理出错: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - Can't instantiate abstract class WorkflowChain with abstract method _call (耗时: 0.0738s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/chat.py", line 122, in get_flow_chats
    chat_service = ChatService(db)
  File "/workspace/backend/app/services/chat_service.py", line 38, in __init__
    self.workflow_chain: WorkflowChain = self._initialize_workflow_chain()
  File "/workspace/backend/app/services/chat_service.py", line 53, in _initialize_workflow_chain
    chain = WorkflowChain(
TypeError: Can't instantiate abstract class WorkflowChain with abstract method _call
2025-04-10 08:51:44,940 - app.main - ERROR - 请求处理出错: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - Can't instantiate abstract class WorkflowChain with abstract method _call (耗时: 0.0742s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/chat.py", line 122, in get_flow_chats
    chat_service = ChatService(db)
  File "/workspace/backend/app/services/chat_service.py", line 38, in __init__
    self.workflow_chain: WorkflowChain = self._initialize_workflow_chain()
  File "/workspace/backend/app/services/chat_service.py", line 53, in _initialize_workflow_chain
    chain = WorkflowChain(
TypeError: Can't instantiate abstract class WorkflowChain with abstract method _call
2025-04-10 08:51:44,946 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:51:44,947 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:51:44,948 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:51:44,984 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:51:44,985 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:51:45,019 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:51:45,019 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:51:45,020 - app.main - ERROR - 请求处理出错: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - Can't instantiate abstract class WorkflowChain with abstract method _call (耗时: 0.0738s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/chat.py", line 92, in get_chat
    chat_service = ChatService(db)
  File "/workspace/backend/app/services/chat_service.py", line 38, in __init__
    self.workflow_chain: WorkflowChain = self._initialize_workflow_chain()
  File "/workspace/backend/app/services/chat_service.py", line 53, in _initialize_workflow_chain
    chain = WorkflowChain(
TypeError: Can't instantiate abstract class WorkflowChain with abstract method _call
2025-04-10 08:51:45,022 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:51:45,056 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:51:45,057 - app.main - ERROR - 请求处理出错: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - Can't instantiate abstract class WorkflowChain with abstract method _call (耗时: 0.1097s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/chat.py", line 92, in get_chat
    chat_service = ChatService(db)
  File "/workspace/backend/app/services/chat_service.py", line 38, in __init__
    self.workflow_chain: WorkflowChain = self._initialize_workflow_chain()
  File "/workspace/backend/app/services/chat_service.py", line 53, in _initialize_workflow_chain
    chain = WorkflowChain(
TypeError: Can't instantiate abstract class WorkflowChain with abstract method _call
2025-04-10 08:51:45,058 - app.main - ERROR - 请求处理出错: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - Can't instantiate abstract class WorkflowChain with abstract method _call (耗时: 0.0385s)
Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 157, in call_next
    message = await recv_stream.receive()
  File "/home/vscode/.local/lib/python3.10/site-packages/anyio/streams/memory.py", line 126, in receive
    raise EndOfStream from None
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/workspace/backend/app/main.py", line 135, in log_requests_detailed
    response = await call_next(request) # 调用后续处理或路由
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 163, in call_next
    raise app_exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/home/vscode/.local/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
  File "/home/vscode/.local/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
  File "/workspace/backend/app/routers/chat.py", line 92, in get_chat
    chat_service = ChatService(db)
  File "/workspace/backend/app/services/chat_service.py", line 38, in __init__
    self.workflow_chain: WorkflowChain = self._initialize_workflow_chain()
  File "/workspace/backend/app/services/chat_service.py", line 53, in _initialize_workflow_chain
    chain = WorkflowChain(
TypeError: Can't instantiate abstract class WorkflowChain with abstract method _call
2025-04-10 08:53:22,469 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:53:22,470 - app.main - INFO - 开始导入模块...
2025-04-10 08:53:22,470 - app.main - INFO - 导入database成功
2025-04-10 08:53:22,470 - app.main - INFO - 导入models成功
2025-04-10 08:53:22,470 - app.main - INFO - 导入config成功
2025-04-10 08:53:22,842 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:53:22,842 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:53:23,128 - app.main - INFO - 导入基本路由成功
2025-04-10 08:53:23,128 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.workflow_prompt_service'
2025-04-10 08:53:23,128 - app.main - INFO - 导入utils成功
2025-04-10 08:53:23,128 - app.main - INFO - 导入dependencies成功
2025-04-10 08:53:23,128 - app.main - INFO - 创建数据库表...
2025-04-10 08:53:23,129 - app.main - INFO - 数据库表创建成功
2025-04-10 08:53:23,129 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 08:53:23,137 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:53:23,137 - app.main - INFO - 注册路由...
2025-04-10 08:53:23,143 - app.main - INFO - 注册user路由成功
2025-04-10 08:53:23,148 - app.main - INFO - 注册flow路由成功
2025-04-10 08:53:23,149 - app.main - INFO - 注册email路由成功
2025-04-10 08:53:23,150 - app.main - INFO - 注册auth路由成功
2025-04-10 08:53:23,150 - app.main - INFO - 注册node_templates路由成功
2025-04-10 08:53:23,150 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 08:53:23,159 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 08:53:23,159 - app.main - INFO - 注册chat路由成功
2025-04-10 08:53:23,159 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 08:53:23,160 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 08:53:23,160 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 08:53:23,160 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 08:53:23,160 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 08:53:23,160 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 08:53:23,160 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 08:53:23,160 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 08:53:23,160 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 08:53:23,160 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 08:53:23,160 - backend.app.startup - INFO - API前缀: /api
2025-04-10 08:53:23,160 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 08:53:49,299 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 08:53:49,300 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 08:53:49,303 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0040s)
2025-04-10 08:53:49,304 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0034s)
2025-04-10 08:53:49,337 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 08:53:49,337 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:53:49,338 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0006s)
2025-04-10 08:53:49,342 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:53:49,343 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0059s)
2025-04-10 08:53:49,387 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 08:53:49,388 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:53:49,388 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-10 08:53:49,389 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 08:53:49,390 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:53:49,390 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0006s)
2025-04-10 08:53:49,403 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:53:49,406 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:53:49,407 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:53:49,408 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:53:49,408 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:53:49,408 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0046s)
2025-04-10 08:53:49,410 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:53:49,412 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:53:49,413 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:53:49,415 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:53:49,415 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:53:49,416 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0088s)
2025-04-10 08:53:49,417 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0086s)
2025-04-10 08:53:49,417 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0090s)
2025-04-10 08:53:49,419 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 08:53:49,422 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0033s)
2025-04-10 08:53:49,479 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:53:49,483 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0043s)
2025-04-10 08:53:51,482 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:53:51,496 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0130s)
2025-04-10 08:53:51,676 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:53:51,677 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:53:51,679 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:53:51,679 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:53:51,680 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:53:51,680 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:53:51,680 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0039s)
2025-04-10 08:53:51,681 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0035s)
2025-04-10 08:53:51,685 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:53:51,686 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:53:51,687 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:53:51,719 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:53:51,720 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:53:51,720 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:53:51,720 - database.embedding.service - INFO - 创建EmbeddingService单例实例
2025-04-10 08:53:51,720 - database.embedding.service - INFO - 初始化EmbeddingService，使用LMStudio API: http://localhost:1234/v1
2025-04-10 08:53:51,720 - database.embedding.lmstudio_client - INFO - 初始化LMStudio客户端，API基础URL: http://localhost:1234/v1
2025-04-10 08:53:51,720 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:53:51,722 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:53:51,724 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:53:51,756 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:53:51,756 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:53:51,756 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:53:51,756 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:53:51,757 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:53:51,758 - app.main - INFO - 请求完成: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0726s)
2025-04-10 08:53:51,758 - app.main - INFO - 请求完成: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0725s)
2025-04-10 08:53:51,805 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:53:51,806 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:53:51,808 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:53:51,841 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:53:51,841 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:53:51,842 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:53:51,842 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:53:51,842 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:53:51,844 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:53:51,875 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:53:51,875 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:53:51,875 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:53:51,875 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:53:51,876 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:53:51,877 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:53:51,878 - app.main - INFO - 请求完成: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - 200 (耗时: 0.0717s)
2025-04-10 08:53:51,878 - app.main - INFO - 请求完成: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - 200 (耗时: 0.0727s)
2025-04-10 08:53:51,879 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:53:51,913 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:53:51,914 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:53:51,914 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:53:51,914 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:53:51,915 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:53:51,917 - app.main - INFO - 请求完成: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - 200 (耗时: 0.0390s)
2025-04-10 08:54:04,955 - app.main - INFO - 收到请求: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de (来自: 172.19.0.1)
2025-04-10 08:54:04,957 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:54:04,988 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:54:04,988 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:54:04,988 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:54:04,988 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:54:04,989 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:54:04,990 - app.main - INFO - 请求完成: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de - 200 (耗时: 0.0348s)
2025-04-10 08:54:09,039 - app.main - INFO - 收到请求: POST /chats/e817dca0-c24a-4f93-a07d-0aafa93143de/messages (来自: 172.19.0.1)
2025-04-10 08:54:09,042 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:54:09,074 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:54:09,075 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:54:09,075 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:54:09,075 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:54:09,075 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:54:09,076 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 linked to chat: e817dca0-c24a-4f93-a07d-0aafa93143de
2025-04-10 08:54:09,076 - backend.app.services.chat_service - INFO - Processing message for chat e817dca0-c24a-4f93-a07d-0aafa93143de: niaho1...
2025-04-10 08:54:09,089 - backend.app.services.chat_service - INFO - 已向聊天 e817dca0-c24a-4f93-a07d-0aafa93143de 添加一条 user 消息
2025-04-10 08:54:09,090 - backend.langchainchat.chains.workflow_chain - INFO - WorkflowChain processing input: niaho1...
2025-04-10 08:54:09,090 - backend.langchainchat.chains.workflow_chain - ERROR - Error in WorkflowChain execution: cannot import name 'deepseek_tool_definitions' from 'backend.langchainchat.tools.definitions' (/workspace/backend/langchainchat/tools/definitions.py)
Traceback (most recent call last):
  File "/workspace/backend/langchainchat/chains/workflow_chain.py", line 137, in _acall
    from backend.langchainchat.tools.definitions import deepseek_tool_definitions
ImportError: cannot import name 'deepseek_tool_definitions' from 'backend.langchainchat.tools.definitions' (/workspace/backend/langchainchat/tools/definitions.py)
2025-04-10 08:54:09,090 - backend.app.services.chat_service - ERROR - WorkflowChain returned an error: cannot import name 'deepseek_tool_definitions' from 'backend.langchainchat.tools.definitions' (/workspace/backend/langchainchat/tools/definitions.py)
2025-04-10 08:54:09,093 - backend.app.services.chat_service - INFO - 已向聊天 e817dca0-c24a-4f93-a07d-0aafa93143de 添加一条 assistant 消息
2025-04-10 08:54:09,093 - backend.app.routers.chat - ERROR - ChatService process_chat_message 返回错误: cannot import name 'deepseek_tool_definitions' from 'backend.langchainchat.tools.definitions' (/workspace/backend/langchainchat/tools/definitions.py)
2025-04-10 08:54:09,093 - app.main - INFO - 请求完成: POST /chats/e817dca0-c24a-4f93-a07d-0aafa93143de/messages - 200 (耗时: 0.0538s)
2025-04-10 08:54:46,987 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:54:46,987 - app.main - INFO - 开始导入模块...
2025-04-10 08:54:46,987 - app.main - INFO - 导入database成功
2025-04-10 08:54:46,987 - app.main - INFO - 导入models成功
2025-04-10 08:54:46,987 - app.main - INFO - 导入config成功
2025-04-10 08:54:47,344 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:54:47,344 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:54:47,617 - app.main - INFO - 导入基本路由成功
2025-04-10 08:54:47,618 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.workflow_prompt_service'
2025-04-10 08:54:47,618 - app.main - INFO - 导入utils成功
2025-04-10 08:54:47,618 - app.main - INFO - 导入dependencies成功
2025-04-10 08:54:47,618 - app.main - INFO - 创建数据库表...
2025-04-10 08:54:47,618 - app.main - INFO - 数据库表创建成功
2025-04-10 08:54:47,618 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 08:54:47,625 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:54:47,625 - app.main - INFO - 注册路由...
2025-04-10 08:54:47,630 - app.main - INFO - 注册user路由成功
2025-04-10 08:54:47,635 - app.main - INFO - 注册flow路由成功
2025-04-10 08:54:47,636 - app.main - INFO - 注册email路由成功
2025-04-10 08:54:47,636 - app.main - INFO - 注册auth路由成功
2025-04-10 08:54:47,637 - app.main - INFO - 注册node_templates路由成功
2025-04-10 08:54:47,637 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 08:54:47,645 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 08:54:47,645 - app.main - INFO - 注册chat路由成功
2025-04-10 08:54:47,645 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 08:54:47,646 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 08:54:47,646 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 08:54:47,646 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 08:54:47,646 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 08:54:47,646 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 08:54:47,646 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 08:54:47,646 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 08:54:47,646 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 08:54:47,647 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 08:54:47,647 - backend.app.startup - INFO - API前缀: /api
2025-04-10 08:54:47,647 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 08:55:00,191 - app.main - INFO - 收到请求: GET /favicon.ico (来自: 172.19.0.1)
2025-04-10 08:55:00,192 - app.main - INFO - 请求完成: GET /favicon.ico - 404 (耗时: 0.0004s)
2025-04-10 08:55:00,222 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 08:55:00,225 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 08:55:00,231 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0086s)
2025-04-10 08:55:00,232 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0066s)
2025-04-10 08:55:00,264 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 08:55:00,264 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:55:00,265 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0009s)
2025-04-10 08:55:00,269 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:55:00,271 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0066s)
2025-04-10 08:55:00,314 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 08:55:00,315 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:55:00,315 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-10 08:55:00,316 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 08:55:00,317 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:55:00,317 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0007s)
2025-04-10 08:55:00,332 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:55:00,332 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:55:00,333 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:55:00,334 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:55:00,336 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:55:00,338 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:55:00,340 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:55:00,341 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:55:00,341 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:55:00,342 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:55:00,342 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0096s)
2025-04-10 08:55:00,343 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0107s)
2025-04-10 08:55:00,343 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0094s)
2025-04-10 08:55:00,343 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0094s)
2025-04-10 08:55:00,350 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 08:55:00,353 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0036s)
2025-04-10 08:55:00,404 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:55:00,410 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0056s)
2025-04-10 08:55:02,405 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:55:02,409 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0036s)
2025-04-10 08:55:07,852 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:55:07,853 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:55:07,854 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:55:07,855 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:55:07,855 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:55:07,856 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:55:07,856 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0028s)
2025-04-10 08:55:07,856 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0037s)
2025-04-10 08:55:07,861 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:55:07,862 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:55:07,863 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:55:07,897 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:55:07,897 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:55:07,897 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:55:07,897 - database.embedding.service - INFO - 创建EmbeddingService单例实例
2025-04-10 08:55:07,897 - database.embedding.service - INFO - 初始化EmbeddingService，使用LMStudio API: http://localhost:1234/v1
2025-04-10 08:55:07,897 - database.embedding.lmstudio_client - INFO - 初始化LMStudio客户端，API基础URL: http://localhost:1234/v1
2025-04-10 08:55:07,897 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:55:07,899 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:55:07,902 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:55:07,933 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:55:07,933 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:55:07,933 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:55:07,933 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:55:07,934 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:55:07,936 - app.main - INFO - 请求完成: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0737s)
2025-04-10 08:55:07,936 - app.main - INFO - 请求完成: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0745s)
2025-04-10 08:55:07,980 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:55:07,981 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:55:08,017 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:55:08,017 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:55:08,017 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:55:08,017 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:55:08,018 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:55:08,020 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:55:08,020 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:55:08,021 - app.main - INFO - 请求完成: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - 200 (耗时: 0.0408s)
2025-04-10 08:55:08,022 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:55:08,053 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:55:08,053 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:55:08,053 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:55:08,053 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:55:08,054 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:55:08,058 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:55:08,090 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:55:08,090 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:55:08,090 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:55:08,090 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:55:08,090 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:55:08,092 - app.main - INFO - 请求完成: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - 200 (耗时: 0.0718s)
2025-04-10 08:55:08,092 - app.main - INFO - 请求完成: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - 200 (耗时: 0.0717s)
2025-04-10 08:55:14,747 - app.main - INFO - 收到请求: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de (来自: 172.19.0.1)
2025-04-10 08:55:14,749 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:55:14,784 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:55:14,785 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:55:14,785 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:55:14,785 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:55:14,785 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:55:14,787 - app.main - INFO - 请求完成: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de - 200 (耗时: 0.0390s)
2025-04-10 08:55:15,384 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:55:15,386 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:55:15,421 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:55:15,421 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:55:15,421 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:55:15,421 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:55:15,421 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:55:15,423 - app.main - INFO - 请求完成: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - 200 (耗时: 0.0380s)
2025-04-10 08:55:15,999 - app.main - INFO - 收到请求: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de (来自: 172.19.0.1)
2025-04-10 08:55:16,001 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:55:16,034 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:55:16,034 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:55:16,034 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:55:16,034 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:55:16,034 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:55:16,036 - app.main - INFO - 请求完成: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de - 200 (耗时: 0.0365s)
2025-04-10 08:55:22,033 - app.main - INFO - 收到请求: POST /chats/e817dca0-c24a-4f93-a07d-0aafa93143de/messages (来自: 172.19.0.1)
2025-04-10 08:55:22,035 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:55:22,068 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:55:22,068 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:55:22,068 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:55:22,068 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:55:22,068 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:55:22,069 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 linked to chat: e817dca0-c24a-4f93-a07d-0aafa93143de
2025-04-10 08:55:22,069 - backend.app.services.chat_service - INFO - Processing message for chat e817dca0-c24a-4f93-a07d-0aafa93143de: 你好...
2025-04-10 08:55:22,074 - backend.app.services.chat_service - INFO - 已向聊天 e817dca0-c24a-4f93-a07d-0aafa93143de 添加一条 user 消息
2025-04-10 08:55:22,074 - backend.langchainchat.chains.workflow_chain - INFO - WorkflowChain processing input: 你好...
2025-04-10 08:55:22,074 - backend.langchainchat.chains.workflow_chain - INFO - Calling LLM with prompt and tools...
2025-04-10 08:55:22,074 - backend.deepseek - INFO - 准备DeepSeek API调用: 2条消息
2025-04-10 08:55:22,074 - backend.deepseek - INFO - ===== DEEPSEEK API 请求详情 =====
2025-04-10 08:55:22,074 - backend.deepseek - INFO - 消息 1 (system) 完整内容:
2025-04-10 08:55:22,074 - backend.deepseek - INFO -   You are an AI assistant for creating flowcharts. You can use tools to create nodes, connect them, set properties, or ask for more information. Respond in Chinese.
2025-04-10 08:55:22,074 - backend.deepseek - INFO - 消息 2 (user) 完整内容:
2025-04-10 08:55:22,075 - backend.deepseek - INFO -   你好
2025-04-10 08:55:22,075 - backend.deepseek - INFO - 工具定义: [{"type": "function", "function": {"name": "create_node", "description": "创建一个流程图节点", "parameters": {"description": "节点创建参数", "properties": {"node_type": {"title": "Node Type", "type": "string"}, "node_label": {"title": "Node Label", "type": "string"}, "position": {"anyOf": [{"additionalProperties": {"type": "number"}, "type": "object"}, {"type": "null"}], "default": null, "title": "Position"}, "properties": {"anyOf": [{"type": "object"}, {"type": "null"}], "default": null, "title": "Properties"}}, "required": ["node_type", "node_label"], "title": "NodeParams", "type": "object"}}}, {"type": "function", "function": {"name": "connect_nodes", "description": "连接两个流程图节点", "parameters": {"description": "节点连接参数", "properties": {"source_id": {"title": "Source Id", "type": "string"}, "target_id": {"title": "Target Id", "type": "string"}, "label": {"anyOf": [{"type": "string"}, {"type": "null"}], "default": null, "title": "Label"}}, "required": ["source_id", "target_id"], "title": "ConnectionParams", "type": "object"}}}, {"type": "function", "function": {"name": "set_properties", "description": "设置节点或连接的属性", "parameters": {"description": "属性设置参数", "properties": {"element_id": {"title": "Element Id", "type": "string"}, "properties": {"type": "object", "title": "Properties"}}, "required": ["element_id", "properties"], "title": "PropertyParams", "type": "object"}}}, {"type": "function", "function": {"name": "ask_more_info", "description": "当信息不足时，向用户询问更多问题", "parameters": {"description": "追加问题参数", "properties": {"questions": {"items": {"type": "string"}, "title": "Questions", "type": "array"}, "context": {"anyOf": [{"type": "string"}, {"type": "null"}], "default": null, "title": "Context"}}, "required": ["questions"], "title": "QuestionsParams", "type": "object"}}}, {"type": "function", "function": {"name": "generate_text", "description": "根据提示生成文本内容", "parameters": {"description": "文本生成参数", "properties": {"prompt": {"title": "Prompt", "type": "string"}, "max_length": {"default": 500, "title": "Max Length", "type": "integer"}}, "required": ["prompt"], "title": "TextGenerationParams", "type": "object"}}}]
2025-04-10 08:55:22,075 - backend.deepseek - INFO - 模型: deepseek-chat
2025-04-10 08:55:22,075 - backend.deepseek - INFO - 温度: 0.3
2025-04-10 08:55:22,075 - backend.deepseek - INFO - 最大令牌数: 1000
2025-04-10 08:55:22,075 - backend.deepseek - INFO - JSON模式: False
2025-04-10 08:55:22,075 - backend.deepseek - INFO - 流式响应: False
2025-04-10 08:55:22,075 - backend.deepseek - INFO - ==================================
2025-04-10 08:55:22,075 - backend.deepseek - DEBUG - 调用DeepSeek API: 模型=deepseek-chat, 温度=0.3, JSON模式=False
2025-04-10 08:55:22,075 - backend.deepseek - INFO - 开始非流式API调用
2025-04-10 08:55:22,533 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-04-10 08:55:27,947 - backend.deepseek - INFO - 非流式API调用完成，接收到69字符
2025-04-10 08:55:27,947 - backend.deepseek - INFO - ===== DEEPSEEK API 响应详情 =====
2025-04-10 08:55:27,947 - backend.deepseek - INFO - 响应完整内容:
2025-04-10 08:55:27,947 - backend.deepseek - INFO -   你好！我是你的AI流程图助手，可以帮助你创建、连接和设置流程图的节点。如果你有任何需求，比如设计一个流程图或者需要调整某个部分，请告诉我！
2025-04-10 08:55:27,947 - backend.deepseek - INFO - ==================================
2025-04-10 08:55:27,947 - backend.deepseek - INFO - DeepSeek API调用成功
2025-04-10 08:55:27,947 - backend.langchainchat.chains.workflow_chain - INFO - LLM direct response/summary: 你好！我是你的AI流程图助手，可以帮助你创建、连接和设置流程图的节点。如果你有任何需求，比如设计一个流程图或者需要调整某个部分，请告诉我！...
2025-04-10 08:55:27,947 - backend.langchainchat.chains.workflow_chain - INFO - No tool calls detected in LLM response.
2025-04-10 08:55:27,947 - backend.langchainchat.chains.workflow_chain - ERROR - Error in WorkflowChain execution: 2 validation errors for WorkflowChainOutput
nodes
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
connections
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
Traceback (most recent call last):
  File "/workspace/backend/langchainchat/chains/workflow_chain.py", line 282, in _acall
    final_output = WorkflowChainOutput(
  File "/home/vscode/.local/lib/python3.10/site-packages/pydantic/main.py", line 176, in __init__
    self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for WorkflowChainOutput
nodes
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
connections
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
2025-04-10 08:55:27,948 - backend.app.services.chat_service - ERROR - WorkflowChain returned an error: 2 validation errors for WorkflowChainOutput
nodes
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
connections
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
2025-04-10 08:55:27,961 - backend.app.services.chat_service - INFO - 已向聊天 e817dca0-c24a-4f93-a07d-0aafa93143de 添加一条 assistant 消息
2025-04-10 08:55:27,961 - backend.app.routers.chat - ERROR - ChatService process_chat_message 返回错误: 2 validation errors for WorkflowChainOutput
nodes
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
connections
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
2025-04-10 08:55:27,962 - app.main - INFO - 请求完成: POST /chats/e817dca0-c24a-4f93-a07d-0aafa93143de/messages - 200 (耗时: 5.9288s)
2025-04-10 08:55:51,547 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-10 08:55:51,547 - app.main - INFO - 开始导入模块...
2025-04-10 08:55:51,547 - app.main - INFO - 导入database成功
2025-04-10 08:55:51,547 - app.main - INFO - 导入models成功
2025-04-10 08:55:51,547 - app.main - INFO - 导入config成功
2025-04-10 08:55:51,925 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-10 08:55:51,925 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-10 08:55:52,204 - app.main - INFO - 导入基本路由成功
2025-04-10 08:55:52,204 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.workflow_prompt_service'
2025-04-10 08:55:52,204 - app.main - INFO - 导入utils成功
2025-04-10 08:55:52,204 - app.main - INFO - 导入dependencies成功
2025-04-10 08:55:52,204 - app.main - INFO - 创建数据库表...
2025-04-10 08:55:52,205 - app.main - INFO - 数据库表创建成功
2025-04-10 08:55:52,205 - app.main - INFO - 初始化FastAPI应用...
2025-04-10 08:55:52,211 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:55:52,212 - app.main - INFO - 注册路由...
2025-04-10 08:55:52,217 - app.main - INFO - 注册user路由成功
2025-04-10 08:55:52,222 - app.main - INFO - 注册flow路由成功
2025-04-10 08:55:52,222 - app.main - INFO - 注册email路由成功
2025-04-10 08:55:52,223 - app.main - INFO - 注册auth路由成功
2025-04-10 08:55:52,223 - app.main - INFO - 注册node_templates路由成功
2025-04-10 08:55:52,223 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-10 08:55:52,232 - app.main - INFO - 注册flow_variables路由成功
2025-04-10 08:55:52,232 - app.main - INFO - 注册chat路由成功
2025-04-10 08:55:52,232 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-10 08:55:52,233 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-10 08:55:52,233 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-10 08:55:52,233 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-10 08:55:52,233 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-10 08:55:52,233 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-10 08:55:52,233 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-10 08:55:52,233 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-10 08:55:52,233 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-10 08:55:52,233 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-10 08:55:52,233 - backend.app.startup - INFO - API前缀: /api
2025-04-10 08:55:52,233 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-10 08:57:33,745 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 08:57:33,746 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-10 08:57:33,749 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0041s)
2025-04-10 08:57:33,750 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0036s)
2025-04-10 08:57:33,782 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-10 08:57:33,783 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:57:33,783 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0006s)
2025-04-10 08:57:33,787 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:57:33,788 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0054s)
2025-04-10 08:57:33,830 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 08:57:33,831 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:57:33,831 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0009s)
2025-04-10 08:57:33,832 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-10 08:57:33,833 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-10 08:57:33,833 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0006s)
2025-04-10 08:57:33,846 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:57:33,847 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:57:33,849 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:57:33,852 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61751c36-5c34-4dcb-90ac-73480ce54638
2025-04-10 08:57:33,853 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:57:33,853 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:57:33,854 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0072s)
2025-04-10 08:57:33,855 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:57:33,856 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:57:33,857 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:57:33,857 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:57:33,857 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0100s)
2025-04-10 08:57:33,858 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0049s)
2025-04-10 08:57:33,859 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0054s)
2025-04-10 08:57:33,869 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-10 08:57:33,873 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0034s)
2025-04-10 08:57:33,922 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:57:33,928 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0061s)
2025-04-10 08:57:35,770 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:57:35,771 - app.main - INFO - 收到请求: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat (来自: 172.19.0.1)
2025-04-10 08:57:35,772 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:57:35,773 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:57:35,773 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-10 08:57:35,773 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 00119e05-f36b-4d0f-a42d-cf8f873f358f
2025-04-10 08:57:35,774 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0031s)
2025-04-10 08:57:35,774 - app.main - INFO - 请求完成: GET /flows/61751c36-5c34-4dcb-90ac-73480ce54638/last_chat - 200 (耗时: 0.0039s)
2025-04-10 08:57:35,779 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:57:35,780 - app.main - INFO - 收到请求: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:57:35,781 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:57:35,814 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:57:35,815 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:57:35,815 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:57:35,815 - database.embedding.service - INFO - 创建EmbeddingService单例实例
2025-04-10 08:57:35,815 - database.embedding.service - INFO - 初始化EmbeddingService，使用LMStudio API: http://localhost:1234/v1
2025-04-10 08:57:35,815 - database.embedding.lmstudio_client - INFO - 初始化LMStudio客户端，API基础URL: http://localhost:1234/v1
2025-04-10 08:57:35,815 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:57:35,817 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:57:35,819 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:57:35,851 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:57:35,851 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:57:35,851 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:57:35,852 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:57:35,852 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:57:35,853 - app.main - INFO - 请求完成: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0735s)
2025-04-10 08:57:35,854 - app.main - INFO - 请求完成: GET /chats/flow/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0743s)
2025-04-10 08:57:35,900 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:57:35,901 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:57:35,903 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:57:35,943 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:57:35,944 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:57:35,944 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:57:35,944 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:57:35,944 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:57:35,946 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-10 08:57:35,947 - app.main - INFO - 收到请求: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 (来自: 172.19.0.1)
2025-04-10 08:57:35,948 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:57:35,981 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:57:35,982 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:57:35,982 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:57:35,982 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:57:35,983 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:57:35,985 - app.main - INFO - 请求完成: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - 200 (耗时: 0.0849s)
2025-04-10 08:57:35,986 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:57:36,017 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:57:36,017 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:57:36,017 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:57:36,017 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:57:36,019 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:57:36,020 - app.main - INFO - 请求完成: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - 200 (耗时: 0.1190s)
2025-04-10 08:57:36,023 - app.main - INFO - 请求完成: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - 200 (耗时: 0.0762s)
2025-04-10 08:57:36,023 - app.main - INFO - 请求完成: PUT /flows/61751c36-5c34-4dcb-90ac-73480ce54638 - 200 (耗时: 0.0765s)
2025-04-10 08:57:37,689 - app.main - INFO - 收到请求: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de (来自: 172.19.0.1)
2025-04-10 08:57:37,691 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:57:37,722 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:57:37,722 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:57:37,722 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:57:37,722 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:57:37,724 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:57:37,725 - app.main - INFO - 请求完成: GET /chats/e817dca0-c24a-4f93-a07d-0aafa93143de - 200 (耗时: 0.0357s)
2025-04-10 08:57:39,850 - app.main - INFO - 收到请求: POST /chats/e817dca0-c24a-4f93-a07d-0aafa93143de/messages (来自: 172.19.0.1)
2025-04-10 08:57:39,857 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-10 08:57:39,890 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-10 08:57:39,890 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-10 08:57:39,890 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-10 08:57:39,890 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-10 08:57:39,892 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-10 08:57:39,893 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61751c36-5c34-4dcb-90ac-73480ce54638 linked to chat: e817dca0-c24a-4f93-a07d-0aafa93143de
2025-04-10 08:57:39,893 - backend.app.services.chat_service - INFO - Processing message for chat e817dca0-c24a-4f93-a07d-0aafa93143de: 你号...
2025-04-10 08:57:39,896 - backend.app.services.chat_service - INFO - 已向聊天 e817dca0-c24a-4f93-a07d-0aafa93143de 添加一条 user 消息
2025-04-10 08:57:39,897 - backend.langchainchat.chains.workflow_chain - INFO - WorkflowChain processing input: 你号...
2025-04-10 08:57:39,897 - backend.langchainchat.chains.workflow_chain - INFO - Calling LLM with prompt and tools...
2025-04-10 08:57:39,897 - backend.deepseek - INFO - 准备DeepSeek API调用: 2条消息
2025-04-10 08:57:39,897 - backend.deepseek - INFO - ===== DEEPSEEK API 请求详情 =====
2025-04-10 08:57:39,897 - backend.deepseek - INFO - 消息 1 (system) 完整内容:
2025-04-10 08:57:39,897 - backend.deepseek - INFO -   You are an AI assistant for creating flowcharts. You can use tools to create nodes, connect them, set properties, or ask for more information. Respond in Chinese.
2025-04-10 08:57:39,897 - backend.deepseek - INFO - 消息 2 (user) 完整内容:
2025-04-10 08:57:39,897 - backend.deepseek - INFO -   你号
2025-04-10 08:57:39,897 - backend.deepseek - INFO - 工具定义: [{"type": "function", "function": {"name": "create_node", "description": "创建一个流程图节点", "parameters": {"description": "节点创建参数", "properties": {"node_type": {"title": "Node Type", "type": "string"}, "node_label": {"title": "Node Label", "type": "string"}, "position": {"anyOf": [{"additionalProperties": {"type": "number"}, "type": "object"}, {"type": "null"}], "default": null, "title": "Position"}, "properties": {"anyOf": [{"type": "object"}, {"type": "null"}], "default": null, "title": "Properties"}}, "required": ["node_type", "node_label"], "title": "NodeParams", "type": "object"}}}, {"type": "function", "function": {"name": "connect_nodes", "description": "连接两个流程图节点", "parameters": {"description": "节点连接参数", "properties": {"source_id": {"title": "Source Id", "type": "string"}, "target_id": {"title": "Target Id", "type": "string"}, "label": {"anyOf": [{"type": "string"}, {"type": "null"}], "default": null, "title": "Label"}}, "required": ["source_id", "target_id"], "title": "ConnectionParams", "type": "object"}}}, {"type": "function", "function": {"name": "set_properties", "description": "设置节点或连接的属性", "parameters": {"description": "属性设置参数", "properties": {"element_id": {"title": "Element Id", "type": "string"}, "properties": {"type": "object", "title": "Properties"}}, "required": ["element_id", "properties"], "title": "PropertyParams", "type": "object"}}}, {"type": "function", "function": {"name": "ask_more_info", "description": "当信息不足时，向用户询问更多问题", "parameters": {"description": "追加问题参数", "properties": {"questions": {"items": {"type": "string"}, "title": "Questions", "type": "array"}, "context": {"anyOf": [{"type": "string"}, {"type": "null"}], "default": null, "title": "Context"}}, "required": ["questions"], "title": "QuestionsParams", "type": "object"}}}, {"type": "function", "function": {"name": "generate_text", "description": "根据提示生成文本内容", "parameters": {"description": "文本生成参数", "properties": {"prompt": {"title": "Prompt", "type": "string"}, "max_length": {"default": 500, "title": "Max Length", "type": "integer"}}, "required": ["prompt"], "title": "TextGenerationParams", "type": "object"}}}]
2025-04-10 08:57:39,897 - backend.deepseek - INFO - 模型: deepseek-chat
2025-04-10 08:57:39,897 - backend.deepseek - INFO - 温度: 0.3
2025-04-10 08:57:39,897 - backend.deepseek - INFO - 最大令牌数: 1000
2025-04-10 08:57:39,897 - backend.deepseek - INFO - JSON模式: False
2025-04-10 08:57:39,897 - backend.deepseek - INFO - 流式响应: False
2025-04-10 08:57:39,897 - backend.deepseek - INFO - ==================================
2025-04-10 08:57:39,897 - backend.deepseek - DEBUG - 调用DeepSeek API: 模型=deepseek-chat, 温度=0.3, JSON模式=False
2025-04-10 08:57:39,898 - backend.deepseek - INFO - 开始非流式API调用
2025-04-10 08:57:40,296 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-04-10 08:57:45,518 - backend.deepseek - INFO - 非流式API调用完成，接收到69字符
2025-04-10 08:57:45,519 - backend.deepseek - INFO - ===== DEEPSEEK API 响应详情 =====
2025-04-10 08:57:45,519 - backend.deepseek - INFO - 响应完整内容:
2025-04-10 08:57:45,519 - backend.deepseek - INFO -   你好！我是你的AI助手，专门用来帮助你创建流程图。如果你需要设计流程图、添加节点、连接节点或设置属性，请随时告诉我！有什么我可以帮你的吗？
2025-04-10 08:57:45,519 - backend.deepseek - INFO - ==================================
2025-04-10 08:57:45,519 - backend.deepseek - INFO - DeepSeek API调用成功
2025-04-10 08:57:45,519 - backend.langchainchat.chains.workflow_chain - INFO - LLM direct response/summary: 你好！我是你的AI助手，专门用来帮助你创建流程图。如果你需要设计流程图、添加节点、连接节点或设置属性，请随时告诉我！有什么我可以帮你的吗？...
2025-04-10 08:57:45,520 - backend.langchainchat.chains.workflow_chain - INFO - No tool calls detected in LLM response.
2025-04-10 08:57:45,520 - backend.langchainchat.chains.workflow_chain - ERROR - Error in WorkflowChain execution: 2 validation errors for WorkflowChainOutput
nodes
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
connections
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
Traceback (most recent call last):
  File "/workspace/backend/langchainchat/chains/workflow_chain.py", line 282, in _acall
    final_output = WorkflowChainOutput(
  File "/home/vscode/.local/lib/python3.10/site-packages/pydantic/main.py", line 176, in __init__
    self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for WorkflowChainOutput
nodes
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
connections
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
2025-04-10 08:57:45,521 - backend.app.services.chat_service - ERROR - WorkflowChain returned an error: 2 validation errors for WorkflowChainOutput
nodes
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
connections
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
2025-04-10 08:57:45,536 - backend.app.services.chat_service - INFO - 已向聊天 e817dca0-c24a-4f93-a07d-0aafa93143de 添加一条 assistant 消息
2025-04-10 08:57:45,537 - backend.app.routers.chat - ERROR - ChatService process_chat_message 返回错误: 2 validation errors for WorkflowChainOutput
nodes
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
connections
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
2025-04-10 08:57:45,539 - app.main - INFO - 请求完成: POST /chats/e817dca0-c24a-4f93-a07d-0aafa93143de/messages - 200 (耗时: 5.6844s)
2025-04-11 00:14:05,729 - app.main - INFO - 收到请求: GET /docs/ (来自: 172.19.0.1)
2025-04-11 00:14:05,730 - app.main - INFO - 请求完成: GET /docs/ - 307 (耗时: 0.0008s)
2025-04-11 00:14:05,748 - app.main - INFO - 收到请求: GET /docs (来自: 172.19.0.1)
2025-04-11 00:14:05,749 - app.main - INFO - 请求完成: GET /docs - 200 (耗时: 0.0003s)
2025-04-11 00:14:05,919 - app.main - INFO - 收到请求: GET /openapi.json (来自: 172.19.0.1)
2025-04-11 00:14:05,934 - app.main - INFO - 请求完成: GET /openapi.json - 200 (耗时: 0.0155s)
2025-04-11 01:00:54,385 - app.main - INFO - 收到请求: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f (来自: 172.19.0.1)
2025-04-11 01:00:54,386 - app.main - INFO - 请求完成: GET /chats/00119e05-f36b-4d0f-a42d-cf8f873f358f - 401 (耗时: 0.0009s)
2025-04-11 01:00:55,360 - app.main - INFO - 收到请求: POST /users/login (来自: 172.19.0.1)
2025-04-11 01:00:55,557 - app.main - INFO - 请求完成: POST /users/login - 200 (耗时: 0.1965s)
2025-04-11 01:00:55,566 - app.main - INFO - 收到请求: GET /auth/verify-token (来自: 172.19.0.1)
2025-04-11 01:00:55,568 - app.main - INFO - 请求完成: GET /auth/verify-token - 200 (耗时: 0.0017s)
2025-04-11 01:00:55,633 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-11 01:00:55,633 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-11 01:00:55,636 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-11 01:00:55,637 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-11 01:00:55,637 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0014s)
2025-04-11 01:00:55,639 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-11 01:00:55,640 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-11 01:00:55,640 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-11 01:00:55,654 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-11 01:00:55,655 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0003s)
2025-04-11 01:00:55,665 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-11 01:00:55,666 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-11 01:00:55,670 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-11 01:00:55,675 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0052s)
2025-04-11 01:00:55,694 - app.main - INFO - 收到请求: GET /flows (来自: 172.19.0.1)
2025-04-11 01:00:55,695 - app.main - INFO - 请求完成: GET /flows - 307 (耗时: 0.0002s)
2025-04-11 01:00:55,709 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-11 01:00:55,713 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-11 01:00:55,713 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0036s)
2025-04-11 01:00:55,716 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0029s)
2025-04-11 01:00:55,745 - app.main - INFO - 收到请求: GET /flows/ (来自: 172.19.0.1)
2025-04-11 01:00:55,747 - app.main - INFO - 请求完成: GET /flows/ - 200 (耗时: 0.0028s)
2025-04-11 01:01:12,015 - app.main - INFO - 收到请求: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected (来自: 172.19.0.1)
2025-04-11 01:01:12,020 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-11 01:01:12,020 - app.main - INFO - 请求完成: POST /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/set-as-last-selected - 200 (耗时: 0.0045s)
2025-04-11 01:01:12,056 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-11 01:01:12,059 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-11 01:01:12,060 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0042s)
2025-04-11 01:01:12,079 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-11 01:01:12,080 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-11 01:01:12,080 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0010s)
2025-04-11 01:01:12,082 - app.main - INFO - 收到请求: GET /api/version (来自: 172.19.0.1)
2025-04-11 01:01:12,083 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-11 01:01:12,083 - app.main - INFO - 请求完成: GET /api/version - 200 (耗时: 0.0007s)
2025-04-11 01:01:12,091 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-11 01:01:12,094 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-11 01:01:12,095 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-11 01:01:12,098 - backend.app.services.user_flow_service - INFO - 设置用户 27c83191-caae-4df4-a217-b6398a62061b 最后选择的流程图ID: 61aa7e47-7611-41e8-b7bb-a438f0c09adb
2025-04-11 01:01:12,099 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0074s)
2025-04-11 01:01:12,099 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-11 01:01:12,100 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0048s)
2025-04-11 01:01:12,101 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-11 01:01:12,101 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-11 01:01:12,102 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0025s)
2025-04-11 01:01:12,137 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-11 01:01:12,139 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-11 01:01:12,139 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-11 01:01:12,139 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0021s)
2025-04-11 01:01:12,188 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-11 01:01:12,192 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0041s)
2025-04-11 01:01:14,149 - app.main - INFO - 收到请求: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-11 01:01:14,157 - app.main - INFO - 请求完成: PUT /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0076s)
2025-04-11 01:01:14,376 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-11 01:01:14,377 - app.main - INFO - 收到请求: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat (来自: 172.19.0.1)
2025-04-11 01:01:14,378 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-11 01:01:14,379 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-11 01:01:14,379 - backend.app.routers.flow - INFO - Attempting to get last chat ID for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb for user: 27c83191-caae-4df4-a217-b6398a62061b
2025-04-11 01:01:14,379 - backend.app.routers.flow - INFO - Found flow, returning last_interacted_chat_id: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-11 01:01:14,380 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0028s)
2025-04-11 01:01:14,380 - app.main - INFO - 请求完成: GET /flows/61aa7e47-7611-41e8-b7bb-a438f0c09adb/last_chat - 200 (耗时: 0.0037s)
2025-04-11 01:01:14,385 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-11 01:01:14,386 - app.main - INFO - 收到请求: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb (来自: 172.19.0.1)
2025-04-11 01:01:14,387 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-11 01:01:14,419 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-11 01:01:14,420 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-11 01:01:14,420 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-11 01:01:14,420 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-11 01:01:14,421 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-11 01:01:14,423 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-11 01:01:14,456 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-11 01:01:14,457 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-11 01:01:14,457 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-11 01:01:14,457 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-11 01:01:14,458 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-11 01:01:14,459 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0738s)
2025-04-11 01:01:14,460 - app.main - INFO - 请求完成: GET /chats/flow/61aa7e47-7611-41e8-b7bb-a438f0c09adb - 200 (耗时: 0.0746s)
2025-04-11 01:01:14,507 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-11 01:01:14,508 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-11 01:01:14,509 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-11 01:01:14,544 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-11 01:01:14,544 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-11 01:01:14,544 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-11 01:01:14,544 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-11 01:01:14,546 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-11 01:01:14,547 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-11 01:01:14,580 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-11 01:01:14,580 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-11 01:01:14,580 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-11 01:01:14,580 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-11 01:01:14,582 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-11 01:01:14,583 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-11 01:01:14,584 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0770s)
2025-04-11 01:01:14,584 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0767s)
2025-04-11 01:01:14,585 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-11 01:01:14,618 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-11 01:01:14,618 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-11 01:01:14,618 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-11 01:01:14,618 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-11 01:01:14,619 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-11 01:01:14,621 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0369s)
2025-04-11 01:01:39,042 - app.main - INFO - 收到请求: POST /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c/messages (来自: 172.19.0.1)
2025-04-11 01:01:39,043 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-11 01:01:39,076 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-11 01:01:39,077 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-11 01:01:39,077 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-11 01:01:39,077 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-11 01:01:39,078 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-11 01:01:39,079 - backend.app.routers.chat - INFO - Flow ownership 验证通过 for flow: 61aa7e47-7611-41e8-b7bb-a438f0c09adb linked to chat: 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c
2025-04-11 01:01:39,079 - backend.app.services.chat_service - INFO - Processing message for chat 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c: 123...
2025-04-11 01:01:39,091 - backend.app.services.chat_service - INFO - 已向聊天 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c 添加一条 user 消息
2025-04-11 01:01:39,091 - backend.langchainchat.chains.workflow_chain - INFO - WorkflowChain processing input: 123...
2025-04-11 01:01:39,091 - backend.langchainchat.chains.workflow_chain - INFO - Calling LLM with prompt and tools...
2025-04-11 01:01:39,091 - backend.deepseek - INFO - 准备DeepSeek API调用: 2条消息
2025-04-11 01:01:39,092 - backend.deepseek - INFO - ===== DEEPSEEK API 请求详情 =====
2025-04-11 01:01:39,092 - backend.deepseek - INFO - 消息 1 (system) 完整内容:
2025-04-11 01:01:39,092 - backend.deepseek - INFO -   You are an AI assistant for creating flowcharts. You can use tools to create nodes, connect them, set properties, or ask for more information. Respond in Chinese.
2025-04-11 01:01:39,092 - backend.deepseek - INFO - 消息 2 (user) 完整内容:
2025-04-11 01:01:39,092 - backend.deepseek - INFO -   123
2025-04-11 01:01:39,092 - backend.deepseek - INFO - 工具定义: [{"type": "function", "function": {"name": "create_node", "description": "创建一个流程图节点", "parameters": {"description": "节点创建参数", "properties": {"node_type": {"title": "Node Type", "type": "string"}, "node_label": {"title": "Node Label", "type": "string"}, "position": {"anyOf": [{"additionalProperties": {"type": "number"}, "type": "object"}, {"type": "null"}], "default": null, "title": "Position"}, "properties": {"anyOf": [{"type": "object"}, {"type": "null"}], "default": null, "title": "Properties"}}, "required": ["node_type", "node_label"], "title": "NodeParams", "type": "object"}}}, {"type": "function", "function": {"name": "connect_nodes", "description": "连接两个流程图节点", "parameters": {"description": "节点连接参数", "properties": {"source_id": {"title": "Source Id", "type": "string"}, "target_id": {"title": "Target Id", "type": "string"}, "label": {"anyOf": [{"type": "string"}, {"type": "null"}], "default": null, "title": "Label"}}, "required": ["source_id", "target_id"], "title": "ConnectionParams", "type": "object"}}}, {"type": "function", "function": {"name": "set_properties", "description": "设置节点或连接的属性", "parameters": {"description": "属性设置参数", "properties": {"element_id": {"title": "Element Id", "type": "string"}, "properties": {"type": "object", "title": "Properties"}}, "required": ["element_id", "properties"], "title": "PropertyParams", "type": "object"}}}, {"type": "function", "function": {"name": "ask_more_info", "description": "当信息不足时，向用户询问更多问题", "parameters": {"description": "追加问题参数", "properties": {"questions": {"items": {"type": "string"}, "title": "Questions", "type": "array"}, "context": {"anyOf": [{"type": "string"}, {"type": "null"}], "default": null, "title": "Context"}}, "required": ["questions"], "title": "QuestionsParams", "type": "object"}}}, {"type": "function", "function": {"name": "generate_text", "description": "根据提示生成文本内容", "parameters": {"description": "文本生成参数", "properties": {"prompt": {"title": "Prompt", "type": "string"}, "max_length": {"default": 500, "title": "Max Length", "type": "integer"}}, "required": ["prompt"], "title": "TextGenerationParams", "type": "object"}}}]
2025-04-11 01:01:39,092 - backend.deepseek - INFO - 模型: deepseek-chat
2025-04-11 01:01:39,092 - backend.deepseek - INFO - 温度: 0.3
2025-04-11 01:01:39,092 - backend.deepseek - INFO - 最大令牌数: 1000
2025-04-11 01:01:39,092 - backend.deepseek - INFO - JSON模式: False
2025-04-11 01:01:39,092 - backend.deepseek - INFO - 流式响应: False
2025-04-11 01:01:39,092 - backend.deepseek - INFO - ==================================
2025-04-11 01:01:39,092 - backend.deepseek - DEBUG - 调用DeepSeek API: 模型=deepseek-chat, 温度=0.3, JSON模式=False
2025-04-11 01:01:39,092 - backend.deepseek - INFO - 开始非流式API调用
2025-04-11 01:01:39,350 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-04-11 01:01:44,790 - backend.deepseek - INFO - 非流式API调用完成，接收到45字符
2025-04-11 01:01:44,791 - backend.deepseek - INFO - ===== DEEPSEEK API 响应详情 =====
2025-04-11 01:01:44,791 - backend.deepseek - INFO - 响应完整内容:
2025-04-11 01:01:44,791 - backend.deepseek - INFO -   你好！请问你是想创建一个流程图，还是需要其他帮助？可以告诉我你的具体需求，我会尽力协助你！
2025-04-11 01:01:44,792 - backend.deepseek - INFO - ==================================
2025-04-11 01:01:44,792 - backend.deepseek - INFO - DeepSeek API调用成功
2025-04-11 01:01:44,792 - backend.langchainchat.chains.workflow_chain - INFO - LLM direct response/summary: 你好！请问你是想创建一个流程图，还是需要其他帮助？可以告诉我你的具体需求，我会尽力协助你！...
2025-04-11 01:01:44,792 - backend.langchainchat.chains.workflow_chain - INFO - No tool calls detected in LLM response.
2025-04-11 01:01:44,792 - backend.langchainchat.chains.workflow_chain - ERROR - Error in WorkflowChain execution: 2 validation errors for WorkflowChainOutput
nodes
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
connections
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
Traceback (most recent call last):
  File "/workspace/backend/langchainchat/chains/workflow_chain.py", line 282, in _acall
    final_output = WorkflowChainOutput(
  File "/home/vscode/.local/lib/python3.10/site-packages/pydantic/main.py", line 176, in __init__
    self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 2 validation errors for WorkflowChainOutput
nodes
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
connections
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
2025-04-11 01:01:44,794 - backend.app.services.chat_service - ERROR - WorkflowChain returned an error: 2 validation errors for WorkflowChainOutput
nodes
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
connections
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
2025-04-11 01:01:44,810 - backend.app.services.chat_service - INFO - 已向聊天 53e43ec9-ce1e-4f77-8c3d-c559f90ff84c 添加一条 assistant 消息
2025-04-11 01:01:44,810 - backend.app.routers.chat - ERROR - ChatService process_chat_message 返回错误: 2 validation errors for WorkflowChainOutput
nodes
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
connections
  Input should be a valid list [type=list_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.7/v/list_type
2025-04-11 01:01:44,812 - app.main - INFO - 请求完成: POST /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c/messages - 200 (耗时: 5.7696s)
2025-04-11 01:02:51,536 - app.main - INFO - 收到请求: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 (来自: 172.19.0.1)
2025-04-11 01:02:51,537 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-11 01:02:51,570 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-11 01:02:51,570 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-11 01:02:51,570 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-11 01:02:51,570 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-11 01:02:51,571 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-11 01:02:51,572 - app.main - INFO - 请求完成: GET /chats/f00bcb73-6551-4d7e-a760-9d94d92e26d0 - 200 (耗时: 0.0358s)
2025-04-11 01:02:51,973 - app.main - INFO - 收到请求: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c (来自: 172.19.0.1)
2025-04-11 01:02:51,975 - backend.deepseek - INFO - 初始化DeepSeek客户端，使用模型: deepseek-chat
2025-04-11 01:02:52,011 - backend.app.services.chat_service - INFO - Initializing WorkflowChain in ChatService (example setup)
2025-04-11 01:02:52,011 - backend.app.services.chat_service - INFO - Initializing RAGChain in ChatService (example setup)
2025-04-11 01:02:52,011 - database.embedding.service - INFO - Initializing DatabaseEmbeddingService...
2025-04-11 01:02:52,011 - database.embedding.service - INFO - DatabaseEmbeddingService initialized.
2025-04-11 01:02:52,012 - backend.langchainchat.chains.rag_chain - INFO - RAG chain created successfully using LCEL.
2025-04-11 01:02:52,013 - app.main - INFO - 请求完成: GET /chats/53e43ec9-ce1e-4f77-8c3d-c559f90ff84c - 200 (耗时: 0.0397s)
2025-04-11 01:09:48,193 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-11 01:09:48,193 - app.main - INFO - 开始导入模块...
2025-04-11 01:09:48,193 - app.main - INFO - 导入database成功
2025-04-11 01:09:48,193 - app.main - INFO - 导入models成功
2025-04-11 01:09:48,193 - app.main - INFO - 导入config成功
2025-04-11 01:09:48,545 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-11 01:09:48,545 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-11 01:09:48,810 - app.main - INFO - 导入基本路由成功
2025-04-11 01:09:48,810 - app.main - ERROR - 导入workflow_router失败: No module named 'app.services.workflow_prompt_service'
2025-04-11 01:09:48,810 - app.main - INFO - 导入utils成功
2025-04-11 01:09:48,810 - app.main - INFO - 导入dependencies成功
2025-04-11 01:09:48,811 - app.main - INFO - 创建数据库表...
2025-04-11 01:09:48,811 - app.main - INFO - 数据库表创建成功
2025-04-11 01:09:48,811 - app.main - INFO - 初始化FastAPI应用...
2025-04-11 01:09:48,818 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-11 01:09:48,818 - app.main - INFO - 注册路由...
2025-04-11 01:09:48,823 - app.main - INFO - 注册user路由成功
2025-04-11 01:09:48,828 - app.main - INFO - 注册flow路由成功
2025-04-11 01:09:48,828 - app.main - INFO - 注册email路由成功
2025-04-11 01:09:48,829 - app.main - INFO - 注册auth路由成功
2025-04-11 01:09:48,829 - app.main - INFO - 注册node_templates路由成功
2025-04-11 01:09:48,829 - app.main - ERROR - 注册workflow路由失败: name 'workflow_router' is not defined
2025-04-11 01:09:48,838 - app.main - INFO - 注册flow_variables路由成功
2025-04-11 01:09:48,838 - app.main - INFO - 注册chat路由成功
2025-04-11 01:09:48,838 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-11 01:09:48,839 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-11 01:09:48,839 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-11 01:09:48,839 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-11 01:09:48,839 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-11 01:09:48,839 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-11 01:09:48,839 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-11 01:09:48,839 - backend.app.startup - ERROR - ⚠️ DeepSeek客户端服务初始化失败: No module named 'backend.app.services.deepseek_client_service'
2025-04-11 01:09:48,839 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-11 01:09:48,839 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-11 01:09:48,839 - backend.app.startup - INFO - API前缀: /api
2025-04-11 01:09:48,839 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-11 01:12:46,965 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-11 01:12:46,965 - app.main - INFO - 开始导入模块...
2025-04-11 01:12:46,966 - app.main - INFO - 导入database成功
2025-04-11 01:12:46,966 - app.main - INFO - 导入models成功
2025-04-11 01:12:46,966 - app.main - INFO - 导入config成功
2025-04-11 01:12:47,332 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-11 01:12:47,333 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-11 01:12:47,609 - app.main - INFO - 导入基本路由成功
2025-04-11 01:12:47,609 - app.main - INFO - 导入workflow_router成功
2025-04-11 01:12:47,609 - app.main - INFO - 导入utils成功
2025-04-11 01:12:47,609 - app.main - INFO - 导入dependencies成功
2025-04-11 01:12:47,609 - app.main - INFO - 创建数据库表...
2025-04-11 01:12:47,609 - app.main - INFO - 数据库表创建成功
2025-04-11 01:12:47,609 - app.main - INFO - 初始化FastAPI应用...
2025-04-11 01:12:47,616 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-11 01:12:47,616 - app.main - INFO - 注册路由...
2025-04-11 01:12:47,621 - app.main - INFO - 注册user路由成功
2025-04-11 01:12:47,626 - app.main - INFO - 注册flow路由成功
2025-04-11 01:12:47,627 - app.main - INFO - 注册email路由成功
2025-04-11 01:12:47,627 - app.main - INFO - 注册auth路由成功
2025-04-11 01:12:47,627 - app.main - INFO - 注册node_templates路由成功
2025-04-11 01:12:47,627 - app.main - INFO - 注册workflow路由成功
2025-04-11 01:12:47,636 - app.main - INFO - 注册flow_variables路由成功
2025-04-11 01:12:47,636 - app.main - INFO - 注册chat路由成功
2025-04-11 01:12:47,636 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-11 01:12:47,637 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-11 01:12:47,637 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-11 01:12:47,637 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-11 01:12:47,637 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-11 01:12:47,637 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-11 01:12:47,637 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-11 01:12:47,637 - backend.app.startup - INFO - ✓ DeepSeek客户端服务初始化成功
2025-04-11 01:12:47,637 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-11 01:12:47,637 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-11 01:12:47,637 - backend.app.startup - INFO - API前缀: /api
2025-04-11 01:12:47,637 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-11 01:14:14,062 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-11 01:14:14,062 - app.main - INFO - 开始导入模块...
2025-04-11 01:14:14,062 - app.main - INFO - 导入database成功
2025-04-11 01:14:14,062 - app.main - INFO - 导入models成功
2025-04-11 01:14:14,062 - app.main - INFO - 导入config成功
2025-04-11 01:14:14,431 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-11 01:14:14,431 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-11 01:14:14,713 - app.main - INFO - 导入基本路由成功
2025-04-11 01:14:14,713 - app.main - INFO - 导入workflow_router成功
2025-04-11 01:14:14,714 - app.main - INFO - 导入utils成功
2025-04-11 01:14:14,714 - app.main - INFO - 导入dependencies成功
2025-04-11 01:14:14,714 - app.main - INFO - 创建数据库表...
2025-04-11 01:14:14,714 - app.main - INFO - 数据库表创建成功
2025-04-11 01:14:14,714 - app.main - INFO - 初始化FastAPI应用...
2025-04-11 01:14:14,721 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-11 01:14:14,721 - app.main - INFO - 注册路由...
2025-04-11 01:14:14,726 - app.main - INFO - 注册user路由成功
2025-04-11 01:14:14,731 - app.main - INFO - 注册flow路由成功
2025-04-11 01:14:14,731 - app.main - INFO - 注册email路由成功
2025-04-11 01:14:14,732 - app.main - INFO - 注册auth路由成功
2025-04-11 01:14:14,732 - app.main - INFO - 注册node_templates路由成功
2025-04-11 01:14:14,732 - app.main - INFO - 注册workflow路由成功
2025-04-11 01:14:14,741 - app.main - INFO - 注册flow_variables路由成功
2025-04-11 01:14:14,741 - app.main - INFO - 注册chat路由成功
2025-04-11 01:14:14,741 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-11 01:14:14,742 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-11 01:14:14,742 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-11 01:14:14,742 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com/v1
2025-04-11 01:14:14,742 - backend.app.startup - WARNING - ⚠️ 检测到基础URL中包含/v1路径: https://api.deepseek.com/v1
2025-04-11 01:14:14,742 - backend.app.startup - WARNING - ⚠️ 这可能会导致API路径重复，因为代码中会自动添加/v1/chat/completions
2025-04-11 01:14:14,742 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-11 01:14:14,742 - backend.app.startup - INFO - ✓ DeepSeek客户端模块 (DeepSeekLLM) 导入成功
2025-04-11 01:14:14,742 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-11 01:14:14,742 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-11 01:14:14,742 - backend.app.startup - INFO - API前缀: /api
2025-04-11 01:14:14,742 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
2025-04-11 08:32:38,170 - app.main - INFO - 日志系统已配置，将记录到 backend/app/logs
2025-04-11 08:32:38,170 - app.main - INFO - 开始导入模块...
2025-04-11 08:32:38,170 - app.main - INFO - 导入database成功
2025-04-11 08:32:38,170 - app.main - INFO - 导入models成功
2025-04-11 08:32:38,170 - app.main - INFO - 导入config成功
2025-04-11 08:32:38,520 - langchain_chat - INFO - 日志已配置: 级别=INFO, 文件=backend/app/logs/langchain.log
2025-04-11 08:32:38,520 - langchain_chat - INFO - Langchain debug logging enabled, writing to backend/app/logs/langchain_debug.log
2025-04-11 08:32:38,786 - app.main - INFO - 导入基本路由成功
2025-04-11 08:32:38,786 - app.main - INFO - 导入workflow_router成功
2025-04-11 08:32:38,786 - app.main - INFO - 导入utils成功
2025-04-11 08:32:38,786 - app.main - INFO - 导入dependencies成功
2025-04-11 08:32:38,786 - app.main - INFO - 创建数据库表...
2025-04-11 08:32:38,787 - app.main - INFO - 数据库表创建成功
2025-04-11 08:32:38,787 - app.main - INFO - 初始化FastAPI应用...
2025-04-11 08:32:38,793 - backend.app.utils - INFO - 从数据库获取版本信息: 0.3.4
2025-04-11 08:32:38,794 - app.main - INFO - 注册路由...
2025-04-11 08:32:38,798 - app.main - INFO - 注册user路由成功
2025-04-11 08:32:38,803 - app.main - INFO - 注册flow路由成功
2025-04-11 08:32:38,804 - app.main - INFO - 注册email路由成功
2025-04-11 08:32:38,804 - app.main - INFO - 注册auth路由成功
2025-04-11 08:32:38,805 - app.main - INFO - 注册node_templates路由成功
2025-04-11 08:32:38,805 - app.main - INFO - 注册workflow路由成功
2025-04-11 08:32:38,813 - app.main - INFO - 注册flow_variables路由成功
2025-04-11 08:32:38,813 - app.main - INFO - 注册chat路由成功
2025-04-11 08:32:38,813 - app.main - INFO - FastAPI应用初始化完成，准备开始处理请求...
2025-04-11 08:32:38,814 - backend.app.startup - INFO - 正在验证DeepSeek API配置
2025-04-11 08:32:38,814 - backend.app.startup - INFO - ✓ DeepSeek API密钥已设置 (前4位: sk-f***)
2025-04-11 08:32:38,814 - backend.app.startup - INFO - DeepSeek API基础URL: https://api.deepseek.com
2025-04-11 08:32:38,814 - backend.app.startup - INFO - DeepSeek模型: deepseek-chat
2025-04-11 08:32:38,814 - backend.app.startup - INFO - ✓ DeepSeek客户端模块 (DeepSeekLLM) 导入成功
2025-04-11 08:32:38,814 - backend.app.startup - INFO - 数据库URL: 未设置
2025-04-11 08:32:38,814 - backend.app.startup - INFO - ⚠️ 调试模式已启用
2025-04-11 08:32:38,814 - backend.app.startup - INFO - API前缀: /api
2025-04-11 08:32:38,814 - backend.app.startup - INFO - CORS允许的源: http://localhost:3000, http://127.0.0.1:3000, http://172.18.0.3:3000, http://workflow-editor-frontend:3000, *
