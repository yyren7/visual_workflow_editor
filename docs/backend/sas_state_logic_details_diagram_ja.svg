<?xml version="1.0" encoding="UTF-8"?>
<svg width="1400" height="2000" xmlns="http://www.w3.org/2000/svg">
    <!-- 背景 -->
    <rect width="1400" height="2000" fill="#f8f9fa" />

    <!-- 标题 -->
    <text x="700" y="30" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle"
        fill="#2c3e50">
        SAS 状態遷移と判断ロジック詳細解説
    </text>

    <!-- 概要セクション -->
    <rect x="50" y="60" width="1300" height="80" fill="#e8f4fd" stroke="#3498db" stroke-width="2" rx="8" />
    <text x="70" y="85" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
        概要
    </text>
    <text x="70" y="110" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" fill="#34495e">
        SAS LangGraphシステムの状態遷移メカニズムと判断ロジックの包括的解説
    </text>
    <text x="70" y="125" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" fill="#34495e">
        具体的なコード例とシナリオを用いた詳細分析
    </text>

    <!-- 主要な状態遷移フロー -->
    <text x="70" y="180" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="18" font-weight="bold" fill="#2c3e50">
        1. 状態遷移フローの詳細
    </text>

    <!-- 状態遷移マップ -->
    <rect x="100" y="200" width="1200" height="200" fill="#fff3cd" stroke="#f39c12" stroke-width="2" rx="8" />
    <text x="120" y="225" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="14" font-weight="bold" fill="#d68910">
        完全な状態遷移マップ
    </text>

    <!-- 状態ボックス -->
    <rect x="120" y="240" width="100" height="40" fill="#3498db" stroke="#2980b9" stroke-width="1" rx="4" />
    <text x="170" y="265" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">初期状態</text>

    <polygon points="230,255 250,260 230,265" fill="#2c3e50" />

    <rect x="260" y="240" width="120" height="40" fill="#27ae60" stroke="#229954" stroke-width="1" rx="4" />
    <text x="320" y="265" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">タスク生成</text>

    <polygon points="390,255 410,260 390,265" fill="#2c3e50" />

    <rect x="420" y="240" width="100" height="40" fill="#e74c3c" stroke="#c0392b" stroke-width="1" rx="4" />
    <text x="470" y="265" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">レビュー</text>

    <polygon points="530,255 550,260 530,265" fill="#2c3e50" />

    <rect x="560" y="240" width="120" height="40" fill="#9b59b6" stroke="#8e44ad" stroke-width="1" rx="4" />
    <text x="620" y="265" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" text-anchor="middle"
        fill="white">モジュール生成</text>

    <polygon points="690,255 710,260 690,265" fill="#2c3e50" />

    <rect x="720" y="240" width="100" height="40" fill="#f39c12" stroke="#e67e22" stroke-width="1" rx="4" />
    <text x="770" y="265" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">XML生成</text>

    <polygon points="830,255 850,260 830,265" fill="#2c3e50" />

    <rect x="860" y="240" width="80" height="40" fill="#1abc9c" stroke="#16a085" stroke-width="1" rx="4" />
    <text x="900" y="265" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" text-anchor="middle" fill="white">完了</text>

    <!-- 詳細状態説明 -->
    <text x="120" y="305" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" fill="#2c3e50">
        initial → sas_step1_tasks_generation → sas_step1_tasks_generated
    </text>
    <text x="120" y="325" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" fill="#2c3e50">
        → sas_step2_module_steps_generation → sas_step2_module_steps_generated_for_review
    </text>
    <text x="120" y="345" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" fill="#2c3e50">
        → sas_all_steps_accepted_proceed_to_xml → final_xml_generated_success
    </text>

    <!-- 各状態での判断処理 -->
    <text x="120" y="385" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">
        各状態での具体的な判断処理
    </text>

    <!-- 初期化ノード -->
    <rect x="100" y="410" width="380" height="120" fill="#ecf0f1" stroke="#95a5a6" stroke-width="1" rx="4" />
    <text x="115" y="430" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">
        A. 初期化ノード（Initialize State Node）
    </text>
    <text x="115" y="450" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        判定1: ディレクトリが存在し、かつディレクトリである
    </text>
    <text x="115" y="465" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        判定2: パスが存在するがディレクトリでない
    </text>
    <text x="115" y="480" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        判定3: パスが存在しない → 作成を試行
    </text>
    <text x="115" y="495" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        フォールバック: タイムスタンプ付きディレクトリ作成
    </text>
    <text x="115" y="515" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" font-weight="bold" fill="#e74c3c">
        クリティカル失敗時: run_output_directory = None
    </text>

    <!-- タスクリスト生成ノード -->
    <rect x="500" y="410" width="380" height="120" fill="#ecf0f1" stroke="#95a5a6" stroke-width="1" rx="4" />
    <text x="515" y="430" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">
        B. タスクリスト生成ノード
    </text>
    <text x="515" y="450" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        判定1: ユーザー入力の有効性チェック
    </text>
    <text x="515" y="465" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        判定2: 既存のタスクリストがある場合の処理
    </text>
    <text x="515" y="480" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        判定3: LLM結果の解析
    </text>
    <text x="515" y="495" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        判定4: 解析されたタスクの妥当性
    </text>
    <text x="515" y="515" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" font-weight="bold" fill="#27ae60">
        成功時: dialog_state = "sas_step1_tasks_generated"
    </text>

    <!-- ルーティング判断の詳細ロジック -->
    <text x="70" y="580" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="18" font-weight="bold" fill="#2c3e50">
        2. ルーティング判断の詳細ロジック
    </text>

    <!-- Review and Refine後のルーティング -->
    <rect x="100" y="600" width="550" height="180" fill="#fdf2e9" stroke="#e67e22" stroke-width="2" rx="8" />
    <text x="120" y="625" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="14" font-weight="bold" fill="#d68910">
        Review and Refine ノード後のルーティング
    </text>

    <!-- 判定フローチャート -->
    <rect x="120" y="645" width="80" height="30" fill="#e74c3c" stroke="#c0392b" stroke-width="1" rx="3" />
    <text x="160" y="665" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" text-anchor="middle" fill="white">エラー?</text>

    <polygon points="210,655 230,660 210,665" fill="#2c3e50" />
    <text x="240" y="665" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#e74c3c">YES → END</text>

    <rect x="120" y="690" width="120" height="30" fill="#3498db" stroke="#2980b9" stroke-width="1" rx="3" />
    <text x="180" y="710" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" text-anchor="middle" fill="white">タスク承認?</text>

    <polygon points="250,700 270,705 250,710" fill="#2c3e50" />
    <text x="280" y="710" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#27ae60">YES → Step 2</text>

    <rect x="350" y="690" width="140" height="30" fill="#9b59b6" stroke="#8e44ad" stroke-width="1" rx="3" />
    <text x="420" y="710" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" text-anchor="middle"
        fill="white">モジュール承認?</text>

    <polygon points="500,700 520,705 500,710" fill="#2c3e50" />
    <text x="530" y="710" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#27ae60">YES → Mapping</text>

    <rect x="120" y="735" width="100" height="30" fill="#f39c12" stroke="#e67e22" stroke-width="1" rx="3" />
    <text x="170" y="755" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" text-anchor="middle" fill="white">明確化必要?</text>

    <polygon points="230,745 250,750 230,755" fill="#2c3e50" />
    <text x="260" y="755" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#e67e22">YES → END</text>

    <!-- Step 2後のルーティング -->
    <rect x="670" y="600" width="550" height="120" fill="#eaf2f8" stroke="#3498db" stroke-width="2" rx="8" />
    <text x="690" y="625" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="14" font-weight="bold" fill="#2e86ab">
        Step 2（モジュールステップ生成）後のルーティング
    </text>

    <rect x="690" y="645" width="80" height="30" fill="#e74c3c" stroke="#c0392b" stroke-width="1" rx="3" />
    <text x="730" y="665" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" text-anchor="middle" fill="white">エラー?</text>

    <polygon points="780,655 800,660 780,665" fill="#2c3e50" />
    <text x="810" y="665" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#e74c3c">YES → END</text>

    <rect x="690" y="690" width="200" height="30" fill="#27ae60" stroke="#229954" stroke-width="1" rx="3" />
    <text x="790" y="710" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" text-anchor="middle" fill="white">正常完了?</text>

    <polygon points="900,700 920,705 900,710" fill="#2c3e50" />
    <text x="930" y="710" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#27ae60">YES → Review</text>

    <!-- エラー処理と回復の判断ロジック -->
    <text x="70" y="820" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="18" font-weight="bold" fill="#2c3e50">
        3. エラー処理と回復の判断ロジック
    </text>

    <!-- 自動回復の判定アルゴリズム -->
    <rect x="100" y="840" width="600" height="140" fill="#fdf0f0" stroke="#e74c3c" stroke-width="2" rx="8" />
    <text x="120" y="865" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="14" font-weight="bold" fill="#c0392b">
        自動回復の判定アルゴリズム
    </text>

    <text x="120" y="885" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">
        規則1: XML生成状態での停止判定
    </text>
    <text x="130" y="900" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • dialog_state in ['generating_xml_relation', 'generating_xml_final']
    </text>
    <text x="130" y="915" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • step_descriptionが空 → 回復必要
    </text>

    <text x="120" y="935" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">
        規則2: メッセージ状態の異常判定
    </text>
    <text x="130" y="950" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • messagesが空またはリストが空 → 回復必要
    </text>
    <text x="130" y="965" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • 初期メッセージのみで処理が進行していない → 回復必要
    </text>

    <!-- 回復戦略の選択ロジック -->
    <rect x="720" y="840" width="500" height="140" fill="#f0f8f0" stroke="#27ae60" stroke-width="2" rx="8" />
    <text x="740" y="865" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="14" font-weight="bold" fill="#229954">
        回復戦略の選択ロジック
    </text>

    <text x="740" y="885" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">
        戦略1: XML生成段階での停止
    </text>
    <text x="750" y="900" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        → 部分完了として処理、completed_successに設定
    </text>

    <text x="740" y="920" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">
        戦略2: 中間段階での停止
    </text>
    <text x="750" y="935" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        → 安全な前の状態に戻す
    </text>

    <text x="740" y="955" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">
        戦略3: 重大な状態異常
    </text>
    <text x="750" y="970" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        → 完全初期化
    </text>

    <!-- フロントエンド同期の判断ロジック -->
    <text x="70" y="1020" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="18" font-weight="bold" fill="#2c3e50">
        4. フロントエンド同期の判断ロジック
    </text>

    <!-- 重要な状態変更の検出 -->
    <rect x="100" y="1040" width="400" height="160" fill="#f8f3ff" stroke="#9b59b6" stroke-width="2" rx="8" />
    <text x="120" y="1065" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="14" font-weight="bold" fill="#8e44ad">
        重要な状態変更の検出
    </text>

    <text x="120" y="1085" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">
        重要度レベル1: ユーザーアクション必須
    </text>
    <text x="130" y="1100" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • clarification_question（ユーザー応答が必要）
    </text>
    <text x="130" y="1115" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • dialog_state（現在の処理段階）
    </text>
    <text x="130" y="1130" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • subgraph_completion_status（完了状態）
    </text>

    <text x="120" y="1150" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">
        重要度レベル2: プログレス表示用
    </text>
    <text x="130" y="1165" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • sas_step1_generated_tasks
    </text>
    <text x="130" y="1180" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • current_step_description
    </text>
    <text x="130" y="1195" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • sas_step2_module_steps
    </text>

    <!-- SSE イベント配信の優先度制御 -->
    <rect x="520" y="1040" width="700" height="160" fill="#fffdf0" stroke="#f39c12" stroke-width="2" rx="8" />
    <text x="540" y="1065" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="14" font-weight="bold" fill="#d68910">
        SSE イベント配信の優先度制御
    </text>

    <text x="540" y="1085" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">
        クリティカルイベント（priority: "critical"）
    </text>
    <text x="550" y="1100" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • 既存の非クリティカルイベントを削除して確実に配信
    </text>
    <text x="550" y="1115" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • キューサイズが80%超過時は古いイベントを削除
    </text>

    <text x="540" y="1135" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">
        プログレスイベント（priority: "progress"）
    </text>
    <text x="550" y="1150" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • 同じタイプのプログレスイベントがある場合は置換
    </text>
    <text x="550" y="1165" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • 重複チェックで効率的な配信
    </text>

    <text x="540" y="1185" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="11" font-weight="bold" fill="#2c3e50">
        通常イベント（priority: "normal"）
    </text>
    <text x="550" y="1195" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • 標準的なキュー処理
    </text>

    <!-- パフォーマンス監視の判断基準 -->
    <text x="70" y="1240" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="18" font-weight="bold" fill="#2c3e50">
        5. パフォーマンス監視の判断基準
    </text>

    <!-- 性能メトリクスの収集と評価 -->
    <rect x="100" y="1260" width="1200" height="200" fill="#f0f9ff" stroke="#1abc9c" stroke-width="2" rx="8" />
    <text x="120" y="1285" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="14" font-weight="bold" fill="#16a085">
        性能メトリクスの収集と評価
    </text>

    <!-- メトリクス項目 -->
    <rect x="120" y="1300" width="280" height="140" fill="#ecf0f1" stroke="#95a5a6" stroke-width="1" rx="4" />
    <text x="130" y="1320" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">
        監視メトリクス
    </text>
    <text x="140" y="1340" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        • checkpoint_sizes: チェックポイントサイズ追跡
    </text>
    <text x="140" y="1355" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        • processing_times: 処理時間追跡
    </text>
    <text x="140" y="1370" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        • error_rates: エラー率追跡
    </text>
    <text x="140" y="1385" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        • recovery_counts: 回復実行回数
    </text>
    <text x="140" y="1405" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" font-weight="bold" fill="#e74c3c">
        リアルタイム監視でシステム健康状態を追跡
    </text>
    <text x="140" y="1425" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" font-weight="bold" fill="#27ae60">
        しきい値超過時に自動アラート
    </text>

    <!-- しきい値設定 -->
    <rect x="420" y="1300" width="350" height="140" fill="#ecf0f1" stroke="#95a5a6" stroke-width="1" rx="4" />
    <text x="430" y="1320" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">
        しきい値設定
    </text>
    <text x="440" y="1340" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        • max_checkpoint_size: 10MB（チェックポイント）
    </text>
    <text x="440" y="1355" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        • max_processing_time: 5分（処理時間）
    </text>
    <text x="440" y="1370" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        • max_error_rate: 10%（エラー率）
    </text>
    <text x="440" y="1385" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        • max_recovery_per_hour: 3回（回復実行）
    </text>
    <text x="440" y="1405" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" font-weight="bold" fill="#f39c12">
        超過時に警告またはクリティカル状態
    </text>
    <text x="440" y="1425" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" font-weight="bold" fill="#3498db">
        推奨事項の自動生成
    </text>

    <!-- 評価と推奨事項 -->
    <rect x="790" y="1300" width="380" height="140" fill="#ecf0f1" stroke="#95a5a6" stroke-width="1" rx="4" />
    <text x="800" y="1320" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" font-weight="bold" fill="#2c3e50">
        評価と推奨事項
    </text>
    <text x="810" y="1340" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" fill="#34495e">
        状態評価: 'healthy', 'warning', 'critical'
    </text>
    <text x="810" y="1360" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" font-weight="bold" fill="#e74c3c">
        クリティカル問題の検出:
    </text>
    <text x="820" y="1375" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • チェックポイントサイズ異常
    </text>
    <text x="820" y="1390" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • エラー率が高い
    </text>
    <text x="810" y="1410" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" font-weight="bold" fill="#27ae60">
        自動推奨事項:
    </text>
    <text x="820" y="1425" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="9" fill="#34495e">
        • 状態オブジェクトの最適化検討
    </text>

    <!-- まとめセクション -->
    <rect x="100" y="1480" width="1200" height="120" fill="#f8f9fa" stroke="#6c757d" stroke-width="2" rx="8" />
    <text x="120" y="1505" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c3e50">
        システム設計の重要なポイント
    </text>

    <text x="120" y="1530" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" fill="#2c3e50">
        • <tspan font-weight="bold">階層的判断ロジック</tspan>: エラー状態 → ユーザー承認 → 自動進行の優先順位
    </text>
    <text x="120" y="1550" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" fill="#2c3e50">
        • <tspan font-weight="bold">堅牢なエラー処理</tspan>: 自動回復戦略と段階的フォールバック機構
    </text>
    <text x="120" y="1570" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" fill="#2c3e50">
        • <tspan font-weight="bold">効率的な同期</tspan>: 優先度ベースのイベント配信とリアルタイム状態更新
    </text>
    <text x="120" y="1590" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" fill="#2c3e50">
        • <tspan font-weight="bold">包括的監視</tspan>: 多次元メトリクスによる予防的問題検出とパフォーマンス最適化
    </text>

    <!-- フッター -->
    <text x="700" y="1950" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="12" text-anchor="middle" fill="#7f8c8d">
        SAS LangGraph システム - 状態遷移と判断ロジック詳細解説図
    </text>
    <text x="700" y="1970" font-family="Noto Sans CJK JP, TakaoPGothic, Arial, sans-serif" font-size="10" text-anchor="middle" fill="#7f8c8d">
        更新日: 2024年 | 包括的なコード例とシナリオベースの詳細分析
    </text>
</svg>